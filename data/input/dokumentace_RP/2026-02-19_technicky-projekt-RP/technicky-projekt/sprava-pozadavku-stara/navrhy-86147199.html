<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>Návrhy realizace požadavků</title>
</head>
<body>
<div class="wiki-content">
<p></p><p>V rámci dokumentu jsou uvedeny návrhy řešení implementace jednotlivých požadavků – jedná se pouze o rámcový popis pro potřeby schválení a případného odhadu pracnosti.</p><ul><li>implementováno,</li><li>v řešení,</li><li>zamítnuto,</li><li>řešeno v rámci jiného dokumentu.</li></ul><h1>Formulář objednávky</h1><p> Implementováno.</p><p>Ve formuláři Objednávky je nyní vyžadováno, aby byly jeho jednotlivé části postupně zpřístupňovány – v rámci jeho vyplňování. Dále jsou pak popsány 3 základní scénáře představující postup založení nové Objednávky. Zpřístupnění polí pak samozřejmě koresponduje i se situací, kdy je zobrazena rozpracovaná Objednávka – jsou vyhodnocena již vyplněná data.</p><h3>Výchozí stav</h3><p>Ve výchozím stavu jsou zpřístupněna pouze uvedená pole daných skupin:</p><ul><li>skupina Provozovna – celá skupina,</li><li>skupina Objednavatel – pouze výběr Zákazníka,</li><li>skupina Položky objednávky – pouze výběr rámcové smlouvy (pokud se jedná o Položku denního výkonu pod Rámcovou smlouvou).</li></ul><h3>Scénář – výběr objednavatele, položka typu rámcová smlouva</h3><p>Uživatel vyplní hodnoty ve skupině Provozovna – vybere požadovanou Provozovnu, pokud má k dispozici více než jednu, a doplní poznámku.</p><p>Dále pokračuje nastavením konkrétního Zákazníka (typ Objednavatele je nastaven na Podnikatel). To je umožněno 2 způsoby:</p><ul><li>výběr existujícího Zákazníka,</li><li>vytvoření nového Zákazníka.</li></ul><p>Systém reaguje vyplněním hodnot jednotlivých polí ve skupině Objednavatel, a to dle zvoleného Zákazníka. Dále je vyhodnoceno, zda má Zákazník přiřazenou alespoň jednu Rámcovou smlouvu:</p><ul><li>Zákazník nemá přiřazenou ani jednu Rámcovou smlouvu – dojde ke změně typu Položky objednávky na Jednorázová (pokračuje se dle <a href="navrhy-86147199.html">Scénář – výběr objednavatele, položka typu jednorázová</a>).</li><li>Zákazník má přiřazenou alespoň jednu Rámcovou smlouvu – dojde k aktualizaci dostupných Rámcových smluv v Položce objednávky – dostupné Rámcové smlouvy odpovídají těm přiřazeným k Zákazníkovi. Pokud má Zákazník přiřazenou právě jednu Rámcovou smlouvu, je automaticky předvyplněna.</li></ul><p>Pokud Rámcová smlouva nebyla předvybrána v předchozím kroku, uživatel vybere požadovanou Rámcovou smlouvu. Jakmile je nastavena Rámcová smlouva, dojde k aktualizaci dostupných Míst realizace – dostupná Místa realizace odpovídají těm v Rámcové smlouvě. Zároveň je zpřístupněno pole pro nastavení Místa realizace. Pokud je v Rámcové smlouvě obsaženo právě jedno Místo realizace, je předvybráno.</p><p>Pokud nebylo Místo realizace předvybráno v předchozím kroku, uživatel nastaví požadované Místo realizace. To je umožněno 2 způsoby:</p><ul><li>výběr existujícího Místa realizace,</li><li>vytvoření nového Místa realizace.</li></ul><p>Jakmile je nastaveno Místo realizace, dojde k zpřístupnění zbývajících části formuláře.</p><p>Následně Uživatel přejde k přidání Objednaných nádob. Vyplní parametry Objednané nádoby a pokračuje na přidání Druhů odpadu. K dispozici jsou pouze takové Druhy odpadu, které jsou zachyceny v Rámcové smlouvě. Po vyplnění Druhu odpadu se zpřístupní pole pro nastavení Likvidačního místa. Dostupná jsou taková Likvidační místa, která přijímají vybraný Druh odpadu. Zvýrazněna jsou pak taková Likvidační místa, která jsou zanesena v odpovídající Rámcové smlouvě pro uvedený Druh odpadu. Pokud je dostupné právě jedno Likvidační místo zanesené v Rámcové smlouvě, je předvyplněno. Následně uživatel doplní požadované Objednané úkony.</p><h3>Scénář – výběr objednavatele, položka typu jednorázová</h3><p>Uživatel vyplní hodnoty ve skupině Provozovna – vybere požadovanou Provozovnu, pokud má k dispozici více než jednu, a doplní poznámku.</p><p>Dále pokračuje nastavením konkrétního Zákazníka (typ Objednavatele je nastaven na Nepodnikatel). To je umožněno 2 způsoby:</p><ul><li>výběr existujícího Zákazníka,</li><li>vytvoření nového Zákazníka.</li></ul><p>Systém reaguje vyplněním hodnot jednotlivých polí ve skupině Objednavatel, a to dle zvoleného Zákazníka. Následně dojde k aktualizaci dostupných Míst realizace – dostupná Místa realizace odpovídají těm, která jsou obsažena ve všech Rámcových smlouvách Zákazníka.</p><p>Uživatel nastaví požadované Místo realizace. To je umožněno 2 způsoby:</p><ul><li>výběr existujícího Místa realizace,</li><li>vytvoření nového Místa realizace.</li></ul><p>Jakmile je nastaveno Místo realizace, dojde k zpřístupnění zbývajících části formuláře.</p><p>Následně Uživatel přejde k přidání Objednaných nádob. Vyplní parametry Objednané nádoby a pokračuje na přidání Druhů odpadu. K dispozici jsou všechny Druhy odpadu. Po vyplnění Druhu odpadu se zpřístupní pole pro nastavení Likvidačního místa. Dostupná jsou taková Likvidační místa, která přijímají vybraný Druh odpadu. Následně uživatel doplní požadované Objednané úkony.</p><p>Následní může uživatel doplnit hodnoty v části Výpočet ceny.</p><h3>Scénář – výběr rámcové smlouvy</h3><p>Uživatel vyplní hodnoty ve skupině Provozovna – vybere požadovanou Provozovnu, pokud má k dispozici více než jednu, a doplní poznámku.</p><p>Dále pokračuje nastavením konkrétní Rámcové smlouvy – výběrem existující Rámcové smlouvy, přičemž jsou dostupné všechny Rámcové smlouvy zvolené Provozovny.</p><p>Systém reaguje vyplněním hodnot jednotlivých polí ve skupině Objednavatel, a to dle Zákazníka zvolené Rámcové smlouvy. Dále pokračuje aktualizaci dostupných Míst realizace – dostupná Místa realizace odpovídají těm v Rámcové smlouvě. Zároveň je zpřístupněno pole pro nastavení Místa realizace. Pokud je v Rámcové smlouvě obsaženo právě jedno Místo realizace, je předvybráno. Dostupné jsou pak pouze Rámcové smlouvy načteného Zákazníka.</p><p>Pokud nebylo Místo realizace předvybráno v předchozím kroku, uživatel nastaví požadované Místo realizace. To je umožněno 2 způsoby:</p><ul><li>výběr existujícího Místa realizace,</li><li>vytvoření nového Místa realizace.</li></ul><p>Jakmile je nastaveno Místo realizace, dojde k zpřístupnění zbývajících části formuláře.</p><p>Následně Uživatel přejde k přidání Objednaných nádob. Vyplní parametry Objednané nádoby a pokračuje na přidání Druhů odpadu. K dispozici jsou pouze takové Druhy odpadu, které jsou zachyceny v Rámcové smlouvě. Po vyplnění Druhu odpadu se zpřístupní pole pro nastavení Likvidačního místa. Dostupná jsou taková Likvidační místa, která přijímají vybraný Druh odpadu. Zvýrazněna jsou pak taková Likvidační místa, která jsou zanesena v odpovídající Rámcové smlouvě pro uvedený Druh odpadu. Pokud je dostupné právě jedno Likvidační místo zanesené v Rámcové smlouvě, je předvyplněno. Následně uživatel doplní požadované Objednané úkony.</p><h3>Obecné chování</h3><p>Pokud dojde ke změně v rámci formuláře Objednávky, je někdy nutné provést další akce – ty základní jsou pak uvedeny dále:</p><ul><li>Skupina Provozovna:<br><ul><li>Změna vybrané Provozovny – vyčištění všech polí ve skupině Objednavatel a Položky objednávky.</li></ul></li><li>Skupina Objednavatel:<br><ul><li>Změna Zákazníka – aktualizace všech polí ve skupině Objednavatel, vyčištění všech polí ve skupině Položky objednávky (může být provedeno doplnění některých polí jako reakce na výběr Zákazníka, viz scénáře).</li><li>Odebrání Zákazníka – vyčištění všech polí ve skupině Objednavatel a Položky objednávky.</li></ul></li><li>Skupina Položky objednávky:<ul><li>Změna Rámcové smlouvy (ve chvíli, kdy je vybrán Zákazník) – vyčištění následujících polí v odpovídající skupině Položky objednávky (může být provedeno doplnění některých polí jako reakce na výběr Rámcové smlouvy, viz scénáře).</li><li>Odebrání Rámcové smlouvy – vyčištění následujících polí v odpovídající skupině Položky objednávky.</li><li>Změna či odebrání Místa realizace – vyčištění následujících polí v odpovídající skupině Položky objednávky.</li></ul></li></ul><h1>Zobrazení mapy v samostatném okně</h1><p>Aktuální návrh řešení je uveden v rámci <a href="navrhy-88015546.html">Zobrazení mapy v samostatném okně</a>.</p><p>V rámci obrazovek pro plánování Denních výkonů vznikl požadavek na možnost zobrazení mapy v samostatném okně – typicky na druhém monitoru. Obrazovka je pak rozdělena na dvě části, kdy obě zobrazují aktuální data. Změna provedená v jedné části obrazovky se tedy ihned projeví i v druhé části, která je zobrazena samostatně.</p><h3>Chování</h3><p>Zobrazení mapy v samostatném okně je vyvoláno stisknutím odpovídajícího tlačítka na obrazovce modulu. Po jeho stisknutí jsou provedeny následující akce:</p><ol><li>Dojde k aktualizaci rozložení na primární obrazovce – je skryta odpovídající mapa.</li><li>Dojde k zobrazení sekundární obrazovky na nově otevřené kartě (v nově otevřeném okně) prohlížeče, ve kterém je zobrazena odpovídající mapa.</li><li>Aplikace si nyní pamatuje, že je mapa zobrazena v samostatném okně (tomu odpovídají i dostupná tlačítka na primární obrazovce).</li></ol><p>Když je změna rozložení dokončena, systém sleduje změny provedené na uvedených místech a provádí jejich zobrazení na primární i sekundární obrazovce.</p><ul><li>Změna provedena na primární obrazovce.</li><li>Požadavek na obnovení dat na primární obrazovce.</li><li>Změna provedená na sekundární obrazovce.</li><li>Požadavek na obnovení dat na sekundární obrazovce.</li><li>Aktualizace zobrazených dat, která nebyla vyvolána uživatelem (např. pravidelné občerstvení zobrazených dat).</li></ul><p>Zrušení zobrazení mapy v samostatném okně je vyvoláno jedním z uvedených způsobů:</p><ul><li>Stisknutí odpovídajícího tlačítka na primární obrazovce.</li><li>Stisknutí odpovídajícího tlačítka na sekundární obrazovce.</li><li>Zavření karty/okna zobrazující sekundární obrazovku.</li></ul><p>Pokud dojde k jednomu z uvedených způsobů zrušení zobrazení mapy v sekundárním okně, jsou provedeny následující akce:</p><ol><li>Dojde k uzavření karty/okna prohlížeče zobrazující sekundární obrazovku.</li><li>Aplikace si nyní pamatuje, že mapa není zobrazena v samostatném okně (tomu odpovídají i dostupná tlačítka na primární obrazovce).</li><li>Dojde k aktualizaci rozložení na primární obrazovce – je zobrazena odpovídající mapa.</li></ol><p>Zrušení zobrazení mapy v samostatném okně může být ale vyvoláno i jinými způsoby – ty jsou však ošetřeny v rámci dále uvedených požadavků. Zde uvádíme některé z dalších možností, kdy dojde ke zrušení zobrazení mapy v samostatné obrazovce.</p><ul><li>Zavření karty/okna zobrazující primární obrazovku.</li><li>Zavření prohlížeče.</li><li>„Pád“ operačního systému a jiné náhlé ukončení prohlížeče bez možnosti provést potřebná opatření.</li></ul><p>Existují zde i obecné požadavky na chování modulu, který umožňuje zobrazení mapy v samostatném okně.</p><ul><li>Primární obrazovka ví o sekundární obrazovce – komunikují spolu.</li><li>Může být otevřena maximálně jedna primární obrazovka.</li><li>Může být otevřena maximálně jedna sekundární obrazovka.</li><li>Pokud je otevřena sekundární obrazovka, musí být otevřena i primární obrazovka, ze které vznikl požadavek na zobrazení mapy v samostatném okně.</li><li>Pokud dojde k zavření primární obrazovky (ať už k ní existuje sekundární obrazovka nebo ne), je při jejím opětovném zobrazení použito úplné rozložení, tedy i s mapou (vše na jedné obrazovce).</li></ul><h3>Možná omezení</h3><p>Možnost zobrazení mapy v samostatném okně může způsobit omezení, která jsou nastíněna dále.</p><ul><li>Interakce pomocí Drag&Drop režimu mezi mapou a zbytkem obrazovky.</li></ul><p>Poznámka: Uvedené chování v tuto chvíli není implementováno, to se ale do budoucna může změnit.</p><h1>Doplnění obrazovky pro editaci denního výkonu</h1><p>Aktuální návrh řešení je uveden v rámci <a href="navrhy-88019093.html">Naplánování objednané služby ve formuláři pro editaci denního výkonu</a>.</p><p>V rámci obrazovky pro editaci Denního výkonu se jeví jako vhodné doplnit následující funkce (viz obrázek):</p><ol><li>Možnost naplánovat další Objednanou službu na editovaný Denní výkon v rámci této obrazovky – viz <a href="navrhy-86147199.html">Přidat objednanou službu</a>.</li><li>Možnost naplánovat obsaženou Objednanou službu na jiný Denní výkon v rámci této obrazovky – viz <a href="navrhy-86147199.html">Naplánovat objednanou službu na jiný denní výkon</a>.</li></ol><p>Poznámka: Provedené změny se projeví až po uložení Denního výkonu – je tedy nutné provést kontrolu, zda je požadované akce možné provést i při uložení Denního výkonu.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/EditaceDennihoVykonu_doplneni.png" data-attachment="true"></p><h3>Přidat objednanou službu</h3><ol><li>Uživatel stiskne tlačítko pro přidání Objednanou službu do Denního výkonu.</li><li>Systém zobrazí modální okno se všemi Objednanými službami, které odpovídají editovanému Denního výkonu dle těchto parametrů: provozovna, datum realizace a typ dopravy.</li><li>Uživatel vybere požadovanou Objednanou službu a potvrdí ji.</li><li>Systém vloží Objednanou službu do Denního výkonu, a to jako v pořadí poslední Položku denního výkonu.</li></ol><h3>Naplánovat objednanou službu na jiný denní výkon</h3><ol><li>Uživatel vybere požadovanou Objednanou službu v tabulce.</li><li>Systém zpřístupní tlačítko pro přeplánování Objednané služby na jiný Denní výkon.</li><li>Uživatel stiskne tlačítko pro přeplánování Objednané služby na jiný Denní výkon.</li><li>Systém zobrazí modální okno se všemi Denními výkony, které odpovídají editovanému Denního výkonu dle těchto parametrů: provozovna, datum realizace a typ dopravy.</li><li>Uživatel vybere požadovaný Denní výkon a potvrdí ho.</li><li>Systém přesune Objednanou službu z editovaného Denního výkonu na ten, který uživatel zvolil, a to jako v pořadí poslední Položku denního výkonu.</li></ol><h1>Předvyplnění místa realizace u nepodnikatele</h1><p> Zamítnuto, nahrazeno <a href="navrhy-86147199.html">Předvyplnění místa realizace u zákazníka</a>.</p><p>V rámci formuláře pro vytvoření Zákazníka typu Nepodnikatel je požadováno, aby první vkládané Místo realizace převzalo svou adresu z adresy sídla Zákazníka. Adresa sídla však neobsahuje souřadnice a následné vyplnění adresy Místa realizace by tak nebylo úplné – takto vyplněná adresa Místa realizace by neprošla validací. Navrhujeme tedy následující řešení rozlišená dle toho, zda se jedná o založení či editaci zákazníka.</p><p>Poznámka:  Opravdu není požadováno uvedené chování doplnit i u Zákazníka typu Podnikatel?</p><h3>Založit zákazníka</h3><ol><li>Uživatel zadá požadavek na založení Zákazníka.</li><li>Systém zobrazí formulář ve výchozím stavu.</li><li>Uživatel nastaví typ Zákazníka na Nepodnikatel.</li><li>Systém aktualizuje formulář.</li><li>Uživatel vyplní jednotlivá pole formuláře.</li><li>Uživatel stiskne tlačítko pro vložení Místa realizace.</li><li>Systém zobrazí formulář pro zadání adresy Místa realizace.</li><li>Pokud již Uživatel zadal adresu Zákazníka, Systém předvyplní tuto adresu do zobrazeného formuláře.</li><li>Uživatel doplní souřadnice Místa realizace.</li><li>Uživatel uloží Místo realizace.</li><li>Uživatel uloží nového Zákazníka.</li></ol><p>Poznámka: Adresa Místa realizace je předvyplněna pouze v případě, kdy není již přidáno jiné Místo realizace.</p><h3>Upravit zákazníka typu podnikatel</h3><ol><li>Uživatel zadá požadavek na editaci Zákazníka typu Podnikatel.</li><li>Systém zobrazí formulář a předvyplní jej dle zvoleného Zákazníka.</li><li>Pokud Uživatel nastaví typ Zákazníka na Nepodnikatel, Systém aktualizuje formulář.</li><li><strong>Skok na tok událostí Založit zákazníka</strong>.</li></ol><h3>Upravit zákazníka typu nepodnikatel</h3><ol><li>Uživatel zadá požadavek na editaci Zákazníka typu nepodnikatel.</li><li>Systém zobrazí formulář a předvyplní jej dle zvoleného Zákazníka.</li><li>Pokud Uživatel nastaví typ Zákazníka na Nepodnikatel – <strong>konec toku událostí</strong>.</li><li>Uživatel změní hodnoty jednotlivých polí formuláře.</li><li>Uživatel stiskne tlačítko pro vložení Místa realizace.</li><li>Systém zobrazí formulář pro zadání adresy Místa realizace.</li><li>Pokud již Uživatel zadal adresu Zákazníka, Systém předvyplní tuto adresu do zobrazeného formuláře.</li><li>Uživatel doplní souřadnice Místa realizace.</li><li>Uživatel uloží Místo realizace.</li><li>Uživatel uloží provedené změny u Zákazníka.</li></ol><p>Poznámka: Adresa Místa realizace je předvyplněna pouze v případě, kdy není již přidáno jiné Místo realizace.</p><h1>Předvyplnění místa realizace u zákazníka</h1><p> Implementováno v rámci M9.</p><p>V rámci formuláře pro vytvoření Zákazníka je požadováno, aby první vkládané Místo realizace převzalo svou adresu z adresy sídla Zákazníka. To je však spojeno s několika problémy:</p><ul><li>Adresa sídla neobsahuje souřadnice, které jsou pro pro Místo realizace nezbytné.</li><li>Je nutné zadat název Místa realizace, to ale není v rámci nastavení adresy sídla možné.</li><li>Je možná zadat kontakt na Místo realizace a poznámku, to ale není v rámci nastavení adresy sídla možné.</li></ul><p>Navrhujeme tedy další řešení problému, u kterého je kladen důraz na rychlost vložení takového Místa realizace, které odpovídá adrese sídla zákazníka.</p><ol><li>V rámci formuláře pro zadání adresy sídla Zákazníka bude doplněno zaškrtávací tlačítko – pokud nebude zaškrtnuto, adresa sídla nebude použita pro vytvoření Místa realizace.</li><li>Pokud uživatel tlačítko zaškrtne, systém zobrazí pole pro zadání informací o Místu realizace.</li></ol><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-1 16-9-56.png" data-attachment="true"></p><p>Poznámka:</p><ul><li>Nahrazuje <a href="navrhy-86147199.html">Předvyplnění místa realizace u nepodnikatele</a>, s kterým nebyl zákazník spokojen.</li><li>Jak je patrné z názvu a úvodního popisu, bude funkčnost dostupná pro všechny typy Zákazníků, tedy pro Podnikatele i Nepodnikatele.</li></ul><h1>Založení částečně realizované objednávky</h1><p> Nebude řešeno, zvolena varianta, kterou pokrývá stávající chování.</p><p>V rámci provozu modulu RoadPlan může nastat situace, kdy je potřeba založit objednávku, která je již částečně realizována – viz uvedené situace:</p><ul><li>Nasazení modulu RoadPlan na provozovnu – provozovna již funguje delší dobu, existují tedy objednávky, které se již realizují. Některé z těchto objednávek už tedy mohou být částečně obslouženy.</li><li>Akvizice jiné společnosti – odpovídá předešlému případu s rozdílem, že tato situace může nastat i po několika měsících či letech používání modulu RoadPlan.</li><li>…</li></ul><p>A v čem je problém? Systém neumožňuje zadat jednotlivé úkony s datem realizace v minulosti, takový úkon nesplňuje některá validační kritéria – jednoduchý příklad je pak uveden v tabulce.</p><table><tbody><tr><th>Úkon</th><th colspan="2">Datum realizace</th><th>Poznámka</th></tr><tr><td>Přistavení</td><td>Termín</td><td>2. 1. 2019</td><td colspan="1"> Úkon není možné přidat vůbec, je v minulosti.</td></tr><tr><td>Vývoz</td><td>Pravidlo opakování</td><td>Každý pátek, od 4. 1. 2019 do 13. 12. 2019.</td><td colspan="1"> Úkon je možné přidat jen částečně. Pokud je dnes 27. 6. 2019, bude zadán následovně: Každý pátek, od 28. 6. 2019 do 13. 12. 2019.</td></tr><tr><td>Odvoz</td><td>Termín</td><td>20. 12. 2019</td><td colspan="1"> Úkon je možné jednoduše přidat.</td></tr></tbody></table><h3>Návrhy řešení</h3><p>Z uvedeného popisu pak jasně vyplývají komplikace, které je nutné vyřešit. Navrhujeme tedy určitá řešení, kterými je možné problém řešit.</p><h4>Zadání pouze dosud nerealizované části objednávky</h4><p>Nebudou provedeny žádné změny v rámci chování formuláře. Uživatel bude při založení částečně realizované objednávky nucen vyhodnotit, která část již byla realizována a která nikoliv.</p><p> Výhody:</p><ul><li>Není nutné řešit změnovým požadavkem.</li></ul><p> Nevýhody:</p><ul><li>Může výrazně ovlivnit dojem uživatelů z aplikace a vést k jejich rychlému znechucení – nutí je přemýšlet.</li><li>Riziko špatně vyhodnocené části objednávky, která nebyla realizována. Některé objednané služby pak nemusí být vůbec vygenerovány.</li><li>V systému nebudou všechny informace o objednávce.</li></ul><h4>Dočasné omezení validačních kritérií</h4><p>Při zakládání objednávky bude možné dočasně vypnout část validačních kritérií – nebude prováděna kontrola, zda není realizace zadaných úkonů naplánována do minulosti.</p><p> Výhody:</p><ul><li>Uživatel nemusí přemýšlet, jaká část objednávky již byla realizována.</li></ul><p> Nevýhody:</p><ul><li>Jednalo by se o změnový požadavek.</li><li>Nutnost revize spousty existujících algoritmů v rámci aplikace:<br><ul><li>formulář objednávky – vyhodnocení, které z validací je nutné pozastavit a které zachovat,</li><li>generování objednaných služeb – revize algoritmu,</li><li>plánování denních výkonů a kontrola jejich realizace,</li><li>…</li></ul></li><li>Ošetření Objednaných služeb „v minulosti“, konkrétně např. jejich potvrzení realizace.</li><li>Vzhledem k rozsahu aplikace je zde riziko, že nebudou ošetřeny všechny potřebné algoritmy.</li><li>Pracnost této varianty bude poměrně vysoká.</li><li>Nekoncepční řešení.</li><li>Možnost, že administrátor zapomene opět zapnout úplné validace.</li></ul><h4>Samostatné okno pro zadání objednávek tohoto typu</h4><p>Bude k dispozici submodul určený přímo pro zakládání objednávek tohoto typu. Uživatel zadá celou objednávku a systém následně automaticky vyhodnotí, která část již byla realizována a která nikoliv. Submodul bude možné zpřístupnit pouze pro zvolené Provozovny.</p><p> Výhody:</p><ul><li>Uživatel nemusí přemýšlet, jaká část objednávky již byla realizována.</li><li>Komfortní prostřední pro uživatele.</li><li>Nezasahuje do stávající implementace – nižší pracnost.</li><li>Možnost využití existujícího formuláře objednávky – nižší pracnost.</li><li>Umožňuje snadné rozšíření, např.:<br><ul><li>zobrazení objednaných služeb, které budou vygenerovány, a označení těch, které budou následně předány do systému (uživatel vidí, že algoritmus pracuje korektně),</li><li>možnost doplnit bližší informace o realizaci objednaných služeb, které již byly realizovány v minulosti (budoucí rozvoj – různá vyhodnocení, jak byla objednávka realizována…).</li></ul></li></ul><p> Nevýhody:</p><ul><li>Jednalo by se o změnový požadavek.</li></ul><h4>Import ze souboru</h4><p>Bude k dispozici možnost importovat soubor s objednávkami, který ale bude muset uživatel vyplnit ručně. Jedná se o obdobu řešení <a href="navrhy-86147199.html">Samostatné okno pro zadání objednávek tohoto typu</a>, kdy je místo uživatelského rozhraní využit např. tabulkový procesor Excel.</p><p> Výhody:</p><ul><li>Nezasahuje do stávající implementace – nižší pracnost.</li></ul><p> Nevýhody:</p><ul><li>Jednalo by se o změnový požadavek.</li><li>Velmi nízký komfort pro uživatele – riziko jeho rychlého znechucení.</li><li>Struktura souborů pro zadání bude muset být navržena (zmíněný formulář objednávky oproti tomu již existuje). Pravděpodobně se bude jednat o více souborů, ne pouze o jeden.</li><li>Vyšší riziko překlepů a podobně.</li></ul><h3>Obecné</h3><p>Dále jsou uvedeny obecné informace, které se vztahují ke všem navrhovaným řešením:</p><ul><li>Uvedené návrhy počítají s tím, že všechny objednané služby realizované v minulosti byly opravdu realizovány, a to v řádném termínu.</li><li>Jednotlivé návrhy vychází z informace, že existující objednávky nejsou spolu s potřebnými informacemi zaneseny v rámci jiného systému (např. WinyX). Je nutné je tedy zadat ručně.</li></ul><h1>Doplňují informace položek diagramu denního výkonu</h1><p>Aktuální návrh řešení je uveden v rámci <a href="navrhy-88015546.html">Zobrazení podrobných informací v diagramu denního výkonu</a>.</p><p>V rámci obrazovky pro plánování denních výkonů (M4) bylo v diagramu denního výkonu doplněno zobrazení doplňujících informací o položce denního výkonu pomocí bublinkové nápovědy. Pro položky denního výkonu typu Objednaná služba je pak zobrazené informace potřeba rozšířit. Dále jsou tedy uvedeny různé varianty. V případě, že by žádná z variant nebyla vyhovující, napište, prosím, jaké informace jsou pro vás stěžejní.</p><table><tbody><tr><th>Varianta</th><th>Struktura</th><th>Drátový diagram</th></tr><tr><td>1</td><td><ul><li>Objednaná služba: Pořadí v rámci dne plánování a název úkonu.</li><li>Místo realizace: Název místa realizace (v rámci manipulace jsou pak zobrazeny 2 názvy).</li><li>Objednaná nádoba: Informace o objednané nádobě – druhy odpadu, typ nádoby a její vlastnictví.</li><li>Časové okno: Časové okno realizace.</li><li>Poznámka: Poznámka k objednané službě.</li></ul></td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-2 8-30-38.png" data-attachment="true"></td></tr><tr><td>2</td><td><ul><li>Objednaná služba: Pořadí v rámci dne plánování a název úkonu.</li><li>Zákazník: Název zákazníka.</li><li>Adresa MR: Adresa místa realizace (v rámci manipulace jsou pak zobrazeny 2 adresy).</li><li>Objednaná nádoba: Informace o objednané nádobě – druhy odpadu, typ nádoby a její vlastnictví.</li><li>Časové okno: Časové okno realizace.</li><li>Poznámka: Poznámka k objednané službě.</li></ul></td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-2 8-31-40.png" data-attachment="true"></td></tr><tr><td>3</td><td><ul><li>Objednaná služba: Pořadí v rámci dne plánování a název úkonu spolu s názvem zákazníka.</li><li>Adresa MR: Adresa místa realizace (v rámci manipulace jsou pak zobrazeny 2 adresy).</li></ul></td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-2 8-37-57.png" data-attachment="true"></td></tr></tbody></table><p>V rámci změn doporučujeme i rozšíření položek denního výkonu typu Provozovna a Likvidační místo.</p><table><tbody><tr><th>Typ</th><th>Struktura</th><th>Drátový diagram</th></tr><tr><td>Provozovna</td><td><ul><li>Provozovna: Kód a název provozovny.</li><li>Adresa: Adresa provozovny.</li></ul></td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-2 8-40-17.png" data-attachment="true"></td></tr><tr><td>Likvidační místo</td><td><ul><li>Likvidační místo: Název likvidačního místa.</li><li>Adresa: Adresa likvidačního místa.</li></ul></td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-2 8-40-1.png" data-attachment="true"></td></tr></tbody></table><h1>Centrování označených položek přehledu v mapě</h1><p> Implementováno.</p><p>V některých situacích, kdy je na jedná obrazovce obsažen přehled položek spolu s mapou zobrazující tyto položky, je vhodné umožnit centrování v této mapě dle právě vybrané položky. To pak probíhá následovně:</p><ol><li>Uživatel označí jednu nebo více položek v přehledu.</li><li>Systém nastaví zobrazení mapy tak, aby byly vidět všechny právě vybrané položky.</li></ol><p>Může však nastat situace, kdy uživatel nastaví zobrazenou oblast v mapě ručně (typicky ho zajímá pohled na určité místo v obci či celá její část) a nepřeje si, aby po výběru došlo ke změně zobrazené oblasti. Dále je tedy uvedeno možné řešení problému.</p><p>V rámci mapy bude k dispozici tlačítko (viz obrázek), které umožní nastavení právě jednoho ze 2 stavů:</p><ol><li>Zapnout automatické centrování mapy dle vybraných položek v přehledu.</li><li>Vypnout automatické centrování mapy.</li></ol><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-3 8-26-1.png" data-attachment="true"></p><h1>Potvrzení o výkonu objednané služby (POVOS)</h1><p> Implementováno.</p><p>Pro potřeby potvrzení o výkonu objednané služby je nutné vyhotovit tiskovou sestavu, která je předána řidiči a kterou zákazník potvrzuje podpisem.</p><p>Tiskovou sestavu je možné vytisknout pro více denních výkonů zároveň (nyní možné pouze z obrazovky pro plánování denních výkonů – M4, v přehledu denních výkonů není výběr více položek zároveň dostupný). Zvolené denní výkony pak musí být schváleny dispečerem. Základní postup je následující:</p><ol><li>Uživatel označí požadované denní výkony a zadá požadavek na tisk sestavy.</li><li>Systém zobrazí formulář pro nastavení tiskové sestavy – viz <a href="navrhy-86147199.html">Nastavení tiskové sestavy</a>.</li><li>Uživatel vyplní formulář a potvrdí tisk.</li><li>Systém vytvoří tiskovou sestavu pro všechny zvolené denní výkon – <a href="navrhy-86147199.html">Tisková sestava</a>.</li></ol><p>Pro každý denní výkon je připravena jedna tisková sestava (TODO: Potvrdit, zda má být výstupem jeden nebo více dokumentů).</p><h3>Nastavení tiskové sestavy</h3><p>Pro každý denní výkon je ve formuláři vygenerována jedna položka, která umožní nastavit odpovídajícího řidiče, který bude denní výkon realizovat (TODO: Ověřit, zda jsou řidiči v rámci systému zaneseni).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-29 12-11-13.png" data-attachment="true"></p><h3>Tisková sestava</h3><p>Jedná se o oboustranný dokument, tak bude i tištěn (TODO: Struktura dokumentu je pevně dána, konkrétní vyplněné hodnoty budou ještě řešeny se zákazníkem. Systém vyplní celou přední stranu dokumentu, druhá strana pak bude vyplněna pouze částečně, jestli vůbec.).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-29 12-12-10.png" data-attachment="true"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-7-29 12-13-37.png" data-attachment="true"></p><h1>Zalamování obsahu při tisku objednávky</h1><p> Implementováno.</p><p>V rámci tisku objednávky může nastat případ, kdy dojde k zalomení obsahu a přechodu na další stranu. Je však potřeba zajistit to, aby nedocházelo k zalomení na libovolném místě v dokumentu. Dále je tedy uveden seznam míst, ve kterých je rozdělení dokumentu umožněno. Uvedené místa jsou pak naznačena na obrázku.</p><p>Poznámka: Některá místa rozdělení se na obrázku opakují. Jedná se však o stejná místa, která jsou však zobrazena v jiném typu položky objednávky (jednorázová, pod rámcovou smlouvou).</p><table><tbody><tr><th>Místo rozdělení</th><th>Popis</th><th>Poznámka</th></tr><tr><td>1</td><td>Rozdělení před první položkou objednávky.</td><td>–</td></tr><tr><td>2.a</td><td>Rozdělení v rámci položky objednávky mezi rámcovou smlouvou a místem realizace.</td><td>Vyskytuje se pouze u položky objednávky typu Rámcová smlouva.</td></tr><tr><td>2.b</td><td>Rozdělení v rámci položky objednávky mezi místem realizace a první objednanou nádobou.</td><td>–</td></tr><tr><td>2.c</td><td>Rozdělení v rámci položky objednávky mezi jednotlivými objednanými nádobami.</td><td>–</td></tr><tr><td>2.d</td><td>Rozdělení v rámci položky objednávky mezi poslední objednanou nádobou a výpočtem ceny.</td><td>Vyskytuje se pouze u položky objednávky typu Jednorázová.</td></tr><tr><td>2.e</td><td>Rozdělení v rámci položky objednávky mezi tabulkami s výpočty ceny.</td><td>Vyskytuje se pouze u položky objednávky typu Jednorázová.</td></tr><tr><td>3</td><td>Rozdělení mezi jednotlivými položkami objednávky.</td><td>–</td></tr><tr><td colspan="1">4</td><td colspan="1">Rozdělení mezi informacemi o předpokládané celkové ceně a informacemi o přijaté záloze</td><td colspan="1">Informace o přijaté záloze jsou vždy tištěny spolu s podpisy zúčastněných stran.</td></tr></tbody></table><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-11 11-59-45.png" data-attachment="true"></p><h1>Pilotní provoz RP</h1><p> Implementováno před začátkem M10. Zvolená varianta naznačena tučně.</p><p>V rámci pilotního provozu na provozovnách zákazníka je požadováno, aby byly dostupné pouze takové moduly, které se přímo týkají objednávek. Dále je požadováno, aby zadané objednávky neměly vliv na zbývající část systému. To například znamená, že vytvořená objednávka nebude uvažována v rámci plánování denních výkonů. Uvedené chování pak má být možné spustit jen na požadovaných provozovnách. Návrh, jak řešit uvedené požadavky, je uveden dále.</p><p>V rámci pilotního provozu pak budou nahrávány pouze jednorázové objednávky. Smyslem je zaškolení uživatelů a zároveň zadání nových zákazníků do systému WinyX.</p><h3>Rozlišení provozoven</h3><p>Jak bylo zmíněno dříve, uvedené chování má být dostupné pouze pro vybrané provozovny. Je tedy potřeba provést určitá opatření:</p><ul><li>Přidat k entitě Provozovna příznak, zda uvedené chování bude pro danou provozovnu aktivní.</li><li>Nastavení příznaku: Bude probíhat na pozadí, tedy na straně Radium.</li></ul><h3>Dostupné moduly</h3><p> Uživatelé budou mít k dispozici pouze následující moduly:</p><ul><li>přehled objednávek,</li><li>formulář objednávky,</li><li>přehled šablon objednávek,</li><li>formulář šablony objednávky,</li><li>přehled objednaných služeb (není potřeba, negenerujeme),</li><li>správa systému,</li><li>informace o aplikaci,</li><li>„proklik do FLWW2“.</li></ul><p>Toho lze dosáhnout několika způsoby:</p><ul><li><strong>Varianta 1: Připravení nových rolí pro uživatele v pilotním provozu. Po přepnutí provozovny do plného provozu bude změněna role odpovídajících uživatelů.</strong></li><li>Varianta 2: Vyhodnocení dle dříve uvedeného atributu u provozovny. Vyžaduje provedení revize vyhodnocení uživatelských práv v rámci RP (vysoká pracnost).</li></ul><h3>Vytváření objednávek</h3><p>Pokud bude pro provozovnu nastaven příznak na Aktivován, bude změněn životní cyklus objednávky. Budou aplikovány uvedené změny:</p><ul><li><strong>Varianta 1:</strong><br><ol><li>Při uložení objednávky do stavu K realizaci nejsou vygenerovány žádné objednané služby.</li><li>Objednávka se automaticky přepne do stavu:<br><ul><li>Varianta 1: Zrušená – nejsou totiž dostupné informace o realizaci jednotlivých objednaných služeb (ty ani neexistují).</li><li>Varianta 2: Dokončená – nutné do budoucna počítat s tím, že pro každou dokončenou objednávky nejsou k dispozici data o realizaci jednotlivých služeb.</li><li><strong>Varianta 3: Dokončena bez informací o realizaci/Dokončena v rámci pilotního provozu (název stavu můžeme upřesnit) – nový stav objednávky. Výhodné i pro budoucí rozvoj a snadné odlišení objednávek z pilotního provozu.</strong></li></ul></li></ol></li><li>Varianta 2 (nedoporučujeme, vyšší pracnost, možné komplikace do budoucna):<br><ol><li>Při uložení objednávky do stavu K realizaci jsou vygenerovány odpovídající objednané služby.</li><li>Vytvořené objednané služby se automaticky přepnou do stavu (nebudeme mít informace o jejich realizaci, nutné aplikovat potřebná opatření ve zbytku systému):<br><ol><li>Varianta 1: Zrušená – nejsou totiž dostupné informace o realizaci jednotlivých objednaných služeb.</li><li>Varianta 2: Realizovaná – nutné do budoucna počítat s tím, že pro každou realizovanou objednanou službu nejsou k dispozici data o realizaci.</li><li>Varianta 3: Nezrealizovaná – nutné do budoucna počítat s tím, že pro každou nezrealizovanou objednanou službu nejsou k dispozici data o tom, jak byla objednané služba naplánována.</li></ol></li><li>Následně se objednávka automaticky přepne do odpovídajícího stavu (pokud je obsažen objednaný úkon na výzvu, je nutné objednávky dokončit ručně).</li></ol></li></ul><p>Poznámka: Při uložení objednávky do stavu K realizaci dochází k odeslání zákazníka do systému WinyX, to bude zachováno.</p><h1>Editace vytvořeného zákazníka ve formuláři objednávky</h1><p> Čeká na vyjádření zákazníka.</p><p>Pokud uživatel vytváří zákazníka ručně, může snadno dojít k překlepu např. v kontaktních údajích a podobně. Nyní ale takového zákazníka ve formuláři objednávky nemůžeme editovat. Jediná možnost, jak provést opravu, je zadat zákazníka znovu.</p><p>Navrhujeme tedy změnu chování ve formuláři objednávky, kdy budou dostupná tlačítka pro výběr, přidání či změnu zákazníka dle právě vybraného zákazníka:</p><ul><li>Tlačítko pro vytvoření nového zákazníka (stávající chování):<br><ul><li>Pokud není vybrán žádný zákazník.</li><li>Pokud je vybrán zákazník načtený ze systému WinyX.</li></ul></li><li>Tlačítko pro editaci nastaveného zákazníka (nové tlačítko, zobrazí předvyplněný formulář pro vytvoření zákazníka):<br><ul><li>Pokud je vybrán zákazník, který není obsažen v systému WinyX (byl vytvořen v rámci RP a zatím nebyl odeslán do WinyX).</li></ul></li><li>Tlačítko pro výběr existujícího zákazníka ze seznamu (stávající chování):<br><ul><li>Vždy.</li></ul></li></ul><p>Poznámka: Dostupná jsou vždy právě 2 tlačítka.</p><h1>Zobrazení doplňujících informací v rámci shluku</h1><p>Aktuální návrh řešení je uveden v rámci <a href="navrhy-88019093.html">Zobrazení detailních informací o lokaci objednané služby v rámci shluku</a>.</p><p>V rámci obrazovky pro plánování denních výkonů (M4) se v rámci mapy vyskytují shluky jednotlivých lokací. Po kliknutí na shluk je pak zobrazen přehled těchto lokací – viz obrázek.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-12 11-6-7.png" data-attachment="true"></p><p>Je ale požadováno rozšířit uvedené řešení o doplňující informace k jednotlivým lokacím. Navrhujeme tedy použití obdobné nabídky, která je použita v rámci diagramu denního výkonu na stejné obrazovce – viz obrázek.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-12 11-8-46.png" data-attachment="true"></p><p>V rámci nabídky pak budou zobrazeny informace odpovídající konkrétnímu typu lokace – viz tabulka. Náhledy jsou pak uvedeny samostatně pro každý typ lokace.</p><table><tbody><tr><th>Typ lokace</th><th colspan="1">Drátový diagram</th></tr><tr><td>Místo realizace</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-12 12-43-1.png" data-attachment="true"></td></tr><tr><td>Likvidační místo</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-12 12-43-36.png" data-attachment="true"></td></tr><tr><td>Provozovna</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-12 12-41-47.png" data-attachment="true"></td></tr><tr><td colspan="1">Místo dočasného uložení</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-9-12 12-45-5.png" data-attachment="true"></td></tr></tbody></table><p>Poznámka: Vzhledem k tomu, že nabídka pro sluk lokací není zobrazena po najetí myší, ale až po kliknutí, je možné pro jednotlivé lokace použít bublinkovou nápovědu.</p><h1>Získání informací o trase vozidla po výpadku</h1><p>Poznámka: Souvisí s <a href="navrhy-86147199.html">Výpadky – nedostupné pozice</a>.</p><p>Pokud dojde k výpadku online ukládání pozičních dat do FLWW2, mohou být dočasně nedostupná aktuální data. Ta jsou po odstranění výpadku do FLWW2 doručena zpětně. To může nějakou dobu trvat, je využíván volný prostor v rámci běžné komunikace.  </p><p>Modul RoadPlan v rámci vyhodnocení realizace Denních výkonů nemá jak rozeznat, zda jsou poziční data vozidla kompletní.</p><p>Situaci lze řešit několika způsoby:</p><h3>Zanedbat chybějící data</h3><p>Vzhledem k tomu, že výpadky tohoto typu nastávají zřídka, je možné od načtení úplných dat abstrahovat. V rámci modulu RoadPlan se jedná pouze o pomocné informace, které nejsou nutné pro potřeby potvrzení realizace denního výkonu. K tomu slouží především tisková sestava POVOS.</p><h3>Zpětné vyhodnocení dat</h3><p>Jakmile přijde požadavek na zpětné vyhodnocení, systém provede opětovné vyhodnocení realizace denního výkonu. Původní data o realizaci již nejsou dále k dispozici, jsou nahrazena těmi novými.</p><p>Nejedná se pak o triviální změnu v rámci systému, je tedy třeba vyhodnotit její nutnost vzhledem k tomu, jak často k výpadkům dochází. Potvrzení realizace denních výkonů provádí v tuto chvíli dispečeři ručně, hlavním zdrojem informací by pak měl být POVOS dodaný od řidiče. Informace z vozidlových jednotek jsou především pomůckou pro vyhodnocení realizace.</p><h4>Ruční inicializace</h4><p>Požadavek na zpětné vyhodnocení dat pak může vzniknout jako reakce na impuls od uživatele. Ten v rámci mapy vidí, že pravděpodobně došlo ke ztrátě některých dat. Označí tedy odpovídající denní výkon a stiskne tlačítko pro automatický přepočet.</p><p>Funkci pak může být možné spustit na několik místech:</p><ol><li>Obrazovka monitoringu realizace denních výkonů – tlačítko umístěno v nástrojové liště přehledu realizací denních výkonu. Zpětné vyhodnocení je pak spuštěno pro označené realizace denního výkonu.</li><li>Formulář potvrzení realizace denního výkonu – tlačítko umístěno v nástrojové liště přehledu realizací objednané služby. Zpětné vyhodnocení je pak spuštěno pro právě zobrazenou realizaci denního výkonu.</li><li>Přehled denních výkonů – tlačítko umístěno v nástrojové liště přehledu denních výkonů. Zpětné vyhodnocení je spuštěno pro označené denní výkony.</li></ol><p>Zpětné vyhodnocení je pak umožněno pouze pro denní výkony v dále uvedených stavech:</p><ul><li>Plněný,</li><li>Ke kontrole.</li></ul><h4>Automatická inicializace</h4><p>Požadavek na zpětné vyhodnocení dat pak může vzniknout 2 způsoby:</p><ol><li>Periodické zkoumání realizací denního výkonu, které se nachází ve stavu Ke kontrole – systém v daném časovém intervalu zjišťuje, zda odpovídající realizace denních výkonů neobsahují nová data, která dříve nebyla k dispozici. Toto řešení pak může zatěžovat systém, mohlo by dojít ke zpomalení zbytku systému.</li><li>Systém zjistí, že po vyhodnocení realizace denního výkonu nedošlo k získání nových dat. Pokud se tak stane, dojde ke zpětnému vyhodnocení. Toto řešení vyžaduje změny nejen v rámci RP, ale i ve FLWW2. Mechanismus vyhodnocení je pak nutné navrhnout. Výsledné pracnost pak bude relativně vysoká. </li></ol><p>Zpětné vyhodnocení je pak umožněno pouze pro denní výkony v dále uvedených stavech:</p><ul><li>Ke kontrole.</li></ul><h1>Tisk prázdného potvrzení o výkonu objednané služby</h1><p> Čeká na vyjádření zákazníka.</p><p>Vznikl požadavek na možnost tisku prázdného potvrzení o výkonu objednané služby (POVOS). V takovém případě není vybrán konkrétní denní výkon a veškerá vstupní data zadává uživatel ručně. Zadat pak může následující informace:</p><ul><li>Vozidlo, pro které bude POVOS vytištěn.</li><li>Zaměstnanec na pozici řidič, který bude vozidlo obsluhovat.</li></ul><p>Poznámka: Ani jeden z parametrů není povinný.</p><p>Tisk prázdné sestavy pak bude možné spustit hned na několika místech (jedná se o možné varianty):</p><ul><li>Přehled denních výkonů – nástrojová lišta hlavní tabulky.</li><li>Obrazovka pro plánování denních výkonů – nástrojová lišta přehledu denních výkonů.</li><li>Obrazovka reportů (nová obrazovka) – viz <a href="navrhy-86147199.html">Modul reportů</a>.</li></ul><p>Tisková sestava pak bude pojmenována následovně: <strong>POVOS – prázdný formulář</strong>.</p><h3>Modul reportů</h3><p>Bude přidána nová položka hlavního menu, v rámci které bude obsažena 1 záložka s nadpisem <strong>Tiskové sestavy</strong> (viz obrázek). Položka hlavního menu je dostupná, pokud má uživatel potřebná oprávnění.</p><ul><li><strong>Formuláře</strong>:<br><ul><li>Obsahuje seznam tiskových sestav, které má uživatel k dispozici.</li><li>Umožňuje spuštění tisku požadované sestavy.</li><li>Umožňuje řazení, filtrování a vyhledávání tiskových sestav.</li></ul></li></ul><p>Poznámka: Zobrazená záložka Reporty je předmětem návrhu řešení M11 (viz <a href="#" data-page-title="Návrhy realizace požadavků pro M11"></a>).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-23 10-32-53.png" data-attachment="true"></p><h3>Vstupní parametry</h3><p>Jakmile uživatel zadá požadavek na tisk prázdného dokumentu POVOS, je zobrazen formulář pro nastavení jeho parametrů, viz tabulka.</p><table><tbody><tr><th colspan="1">Varianta</th><th>Náhled</th><th>Popis</th></tr><tr><td colspan="1">1</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-10 15-11-5.png" data-attachment="true"></td><td><p>Formulář umožňuje nastavení konkrétního řidiče a vozidla. Ani jeden z údajů není povinný.</p><p> Klady:</p><ul><li>Jednoduchost a přehlednost.</li><li>Nízká pracnost.</li></ul><p> Zápory:</p><ul><li>Násobný tisk nutné řešit až při tisku vygenerovaného PDF souboru.</li><li>Nutnost samostatného tisku pro každého řidiče, případně každé vozidlo.</li><li>Vždy je nevyužita druhá polovina listu papíru.</li></ul></td></tr><tr><td colspan="1">2</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-10 15-12-39.png" data-attachment="true"></td><td><p>Formulář umožňuje nastavení konkrétního řidiče a vozidla. Ani jeden z údajů není povinný. Dále je umožněno tisknout sestavu pro více vozidel či řidičů zároveň.</p><p> Klady:</p><ul><li>Možnost tisku pro více řidičů či vozidel zároveň.</li><li>Může být využita i druhá polovina listu papíru.<br></li></ul><p> Zápory:</p><ul><li>Násobný tisk nutné řešit až při tisku vygenerovaného PDF souboru. Následně dojde k násobnému tisku pro všechny obsažené položky.</li><li>Střední až vyšší pracnost.</li></ul></td></tr><tr><td colspan="1">3</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-10 15-11-22.png" data-attachment="true"></td><td><p>Formulář umožňuje nastavení konkrétního řidiče a vozidla. Ani jeden z údajů není povinný. Dále je umožněno tisknout sestavu pro více vozidel či řidičů zároveň. U každé položky je navíc možné nastavit četnost.</p><p> Klady:</p><ul><li>Možnost tisku pro více řidičů či vozidel zároveň v libovolném počtu výtisků.</li></ul><p> Zápory:</p><ul><li>Vyšší pracnost.</li></ul></td></tr></tbody></table><h3>Struktura dokumentu</h3><p>Výsledný dokument pak obsahuje 2 stránky, kde jsou obsaženy 2 totožné formuláře POVOS vyplněné dle nastavených parametrů, viz obrázky.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-23 11-16-41.png" data-attachment="true"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-23 11-17-43.png" data-attachment="true"></p><h1>Tisk potvrzení o výkonu objednané služby po jednotlivých denních výkonech</h1><p> Zamítnuto.</p><p>Je požadováno, aby se jednotlivé denní výkony tiskly do samostatných PDF souborů. Nyní se tiskne jeden PDF soubor pro všechny denní výkony.</p><p>Průběh tisku bude z uživatelského pohledu totožný, změní se až ve chvíli, kdy systém předává vygenerovanou sestavu uživateli. To může nové probíhat 2 způsoby:</p><ol><li>Systém vygeneruje pro každý denní výkon samostatný PDF soubor. Tyto soubory vrátí uživateli v komprimované podobě, tedy ve formě zip dokumentu – začne stahování jednoho souboru.</li><li>Systém vygeneruje pro každý denní výkon samostatný PDF soubor. Tyto soubory vrátí uživateli jednotlivě – začne stahování více souborů.</li></ol><p>Každý PDF soubor pak musí mít jedinečný název v rámci získaných souborů. Složen může být následovně:</p><ol><li>POVOS_TN258EZ_2019-10-21.pdf (SPZ vozidla a datum realizace denního výkonu),</li><li>POVOS_2019-10-21_TN258EZ.pdf (datum realizace denního výkonu a SPZ vozidla),</li><li>PotvrzeniOVykonuObjednaneSluzby_TN258EZ_2019-10-21.pdf (SPZ vozidla a datum realizace denního výkonu),</li><li>PotvrzeniOVykonuObjednaneSluzby_2019-10-21_TN258EZ.pdf (datum realizace denního výkonu a SPZ vozidla).</li></ol><p>Pokud budou PDF soubory předány v komprimované podobě, může být název výsledného souboru následující:</p><ol><li>POVOS_2019_10_28.zip (datum tisku),</li><li>PotvrzeniOVykonuObjednaneSluzby_2019_10_28.zip (datum tisku).</li></ol><h1>Tisk potvrzení o výkonu objednané služby pro více druhů dopravy</h1><p> Čeká na vyjádření zákazníka.</p><p>Rozšiřuje <a href="navrhy-86147199.html">Potvrzení o výkonu objednané služby (POVOS)</a>.</p><p>Aktuálně je možné tisknout sestavu pro více denních výkonů zároveň, uživatel však nemůže zvolit denní výkony různých typů dopravy. To je ale nově požadováno.</p><p>Jako vhodné místo pro tisk se jeví následující varianty, kdy se od té zvolené odvíjí i způsob zadání vstupních dat:</p><ol><li><a href="navrhy-86147199.html">Přehled denních výkonů</a>,</li><li><a href="navrhy-86147199.html">Modul reportů</a>.</li></ol><h3>Přehled denních výkonů</h3><p>V nástrojové liště přehledu denních výkonů bude přidáno tlačítko pro tisk sestavy pro požadované denní výkony. Možné jsou pak 2 základní varianty nastavení vstupních dat sestavy:</p><ol><li>Označení denních výkonů v přehledu:<br><ul><li>Uživatel označí požadované denní výkony přímo v přehledu. Následně je zobrazeno tlačítko pro tisk sestavy. Po jeho stisknutí systém vygeneruje tiskovou sestavu, kde jsou jednotlivé denní výkony řazeny dle provozovny a typu dopravy.</li><li> Výhodou je jednoduchá možnost tisku sestavy pro požadované denní výkony. Navíc má uživatel možnost tisku sestavy pro více provozoven zároveň.</li><li> Nevýhodou je nutnost označování řádků v případě, kdy chce uživatel jednoduše vytisknout sestavu pro všechny denní výkony např. v daný den. Dalším omezením je počet zobrazených denních výkonů v rámci přehledu, kde je použito stránkování.</li></ul></li><li>Nastavení sestavy pomocí formuláře:<br><ul><li>Uživatel stiskne tlačítko pro tisk sestavy. Následně systém zobrazí formulář pro nastavení vstupních dat. Jakmile uživatel vyplní požadované údaje a potvrdí je, systém vygeneruje tiskovou sestavu, kde jsou jednotlivé denní výkony řazeny dle typu dopravy.</li><li>Vstupní data tiskové sestavy pak budou následující:<br><ul><li>Provozovna – výběr konkrétní provozovny v případě, kdy má uživatel právo na více než jednu provozovnu.</li><li>Období – datum od a do.</li><li>Typ dopravy – možnost „zaškrtnout“ požadované typy dopravy.</li></ul></li><li> Výhodou je jednoduchá možnost tisku sestavy za požadované období.</li><li> Nevýhodou je nemožnost tisku sestavy pouze pro pár denních výkonů, kdy se liší provozovna nebo typ dopravy.</li></ul></li></ol><h3>Modul reportů</h3><p>Bude přidána nová položka hlavního menu, v rámci které bude obsažena 1 záložka s nadpisem <strong>Tiskové sestavy</strong>. Položka hlavního menu je dostupná, pokud má uživatel potřebná oprávnění. Jedná se o obdobu zvolené varianty v rámci návrhu pro tisk prázdné sestavy, viz <a href="navrhy-86147199.html">Tisk prázdného potvrzení o výkonu objednané služby</a>. Možnost tisku prázdné i vyplněné sestavy by pak byla umístěna společně.</p><div>Tisková sestava pak bude pojmenována následovně: <strong>POVOS</strong>.</div><p>Možná rozšíření: Výhodou je pak možnost přidání více tiskových sestav POVOS, které by se lišily způsobem zadávání vstupních dat.</p><p>Možné jsou pak 2 základní varianty nastavení vstupních dat sestavy:</p><ol><li>Dialogové okno s přehledem denních výkonů (výběrový dialog):<br><ul><li>Uživatel označí požadované denní výkony přímo v přehledu. Následně výběr potvrdí. Po potvrzení systém vygeneruje tiskovou sestavu, kde jsou jednotlivé denní výkony řazeny dle provozovny a typu dopravy.</li><li> Výhodou je jednoduchá možnost tisku sestavy pro požadované denní výkony. Navíc má uživatel možnost tisku sestavy pro více provozoven zároveň.</li><li> Nevýhodou je nutnost označování řádků v případě, kdy chce uživatel jednoduše vytisknout sestavu pro všechny denní výkony např. v daný den. Dalším omezením je počet zobrazených denních výkonů v rámci přehledu, kde je použito stránkování.</li></ul></li><li>Nastavení sestavy pomocí formuláře:<br><ul><li>Uživatel zadá požadavek na tisk sestavy. Následně systém zobrazí formulář pro nastavení vstupních dat. Jakmile uživatel vyplní požadované údaje a potvrdí je, systém vygeneruje tiskovou sestavu, kde jsou jednotlivé denní výkony řazeny dle typu dopravy.</li><li>Vstupní data tiskové sestavy pak budou následující:<br><ul><li>Provozovna – výběr konkrétní provozovny v případě, kdy má uživatel právo na více než jednu provozovnu.</li><li>Období – datum od a do.</li><li>Typ dopravy – možnost „zaškrtnout“ požadované typy dopravy.</li></ul></li><li> Výhodou je jednoduchá možnost tisku sestavy za požadované období.</li><li> Nevýhodou je nemožnost tisku sestavy pouze pro pár denních výkonů, kdy se liší provozovna nebo typ dopravy.</li></ul></li></ol><h1>Tisk potvrzení o výkonu objednané služby s rozdělením směny</h1><p> Čeká na vyjádření zákazníka.</p><p>Je požadováno, aby v případě, kdy je v rámci denního výkonu obsaženo alespoň jedno rozdělení směny, došlo k rozdělení tiskové sestavy POVOS na samostatné části.</p><p>Systém by takový denní výkon při tisku rozdělil na části právě dle lokací typu Rozdělení směny. Pokud by tedy v rámci denního výkonu bylo obsaženo jedno rozdělení směny, výsledná tisková sestava by pak vypadala, jako by byly tištěny dva denní výkony.</p><p>Pokud bude v denním výkonu obsaženo rozdělení směny, bude možné nastavit odpovídajícího řidiče pro každou část denního výkonu, viz obrázek.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-31 9-25-2.png" data-attachment="true"></p><h1>Tisk itineráře trasy</h1><p> Čeká na vyjádření zákazníka.</p><p>Pro potřeby lepší orientace řidiče je požadován tisk jednoduchého itineráře trasy. Měl by obsahovat informace jak o jednotlivých objednaných službách, tak o samotných lokacích v rámci denního výkonu.</p><p>Jeho tisk může být spuštěn na následujících místech:</p><ol><li>Obrazovka plánování denních výkonů – tlačítko nástrojové lišty přehledu denních výkonů. Tisk je pak spuštěn pro označené denní výkony.</li><li>Formulář editace denního výkonu – tlačítko nástrojové lišty přehledu objednaných služeb. Tisk je spuštěn pro právě zobrazený denní výkon.</li><li>Přehled denních výkonů – tlačítko v nástrojové liště přehledu denních výkonů. Tisk je pak spuštěn pro označené denní výkony.</li></ol><p>Umožněn pak je pro denní výkony v jednom z uvedených stavů:</p><ul><li>Schválený,</li><li>Plněný.</li></ul><p>Struktura itineráře pak může být různá, stejně jako výsledný typ souboru, viz tabulka.</p><table><tbody><tr><th>Varianta</th><th>Náhled</th><th>Popis</th></tr><tr><td>1</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-25 15-15-53.png" data-attachment="true"></td><td><p>Itinerář trasy je generován ve formátu <strong>pdf</strong>.</p><p>Výhodou je podobnost s obrazovkou editace denního výkonu.</p><ul><li>Identifikace denního výkonu:<br><ul><li>řidič,</li><li>přiřazené vozidlo,</li><li>datum realizace.</li></ul></li><li>Obsažené položky denního výkonu:<br><ul><li>Informace o objednané službě:<br><ul><li>pořadí v rámci denního výkonu,</li><li>typ úkonu,</li><li>zákazník,</li><li>druhy odpadu,</li><li>typ nádoby,</li><li>poznámka k objednané službě,</li><li>poznámka k MR,</li><li>kontakt k MR.</li></ul></li><li>Informace o obsažených lokacích objednané služby:<br><ul><li>pořadí v rámci denního výkonu,</li><li>akce v lokaci,</li><li>typ lokace,</li><li>adresa lokace,</li><li>předpokládaný čas příjezdu,</li><li>předpokládaná doba jízdy,</li><li>předpokládaná ujetá vzdálenost,</li><li>rozdíl předpokládaných ujetých vzdáleností mezi lokacemi.</li></ul></li></ul></li><li>Poznámka k dennímu výkonu – k uvedené poznámce navíc doplněn volný prostor pro ruční doplnění poznámky na vytištěný itinerář.</li></ul></td></tr><tr><td>2</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-28 14-27-26.png" data-attachment="true"></td><td><p>Itinerář trasy je generován ve formátu <strong>pdf</strong>.</p><p>Výhodou je čitelnost a přehlednost sestavy.</p><p>Uvedeny jsou pak tyto informace:</p><ul><li>Identifikace denního výkonu:<br><ul><li>řidič,</li><li>přiřazené vozidlo,</li><li>datum realizace.</li></ul></li><li>Obsažené položky denního výkonu:<br><ul><li>Informace o objednané službě:<br><ul><li>pořadí v rámci denního výkonu,</li><li>typ úkonu,</li><li>zákazník,</li><li>druhy odpadu,</li><li>typ nádoby,</li><li>poznámka k objednané službě,</li><li>poznámka k MR,</li><li>kontakt k MR.</li></ul></li><li>Informace o obsažených lokacích objednané služby:<br><ul><li>akce v lokaci,</li><li>typ lokace,</li><li>adresa lokace,</li><li>předpokládaný čas příjezdu.</li></ul></li></ul></li><li>Poznámka k dennímu výkonu – k uvedené poznámce navíc doplněn volný prostor pro ruční doplnění poznámky na vytištěný itinerář.</li></ul><p><br></p></td></tr><tr><td>3</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-10-25 15-0-17.png" data-attachment="true"></td><td><p>Itinerář trasy je generován ve formátu <strong>xlsx</strong>.</p><p>Výhodou je možnost snadné úpravy v rámci vygenerovaného dokumentu.</p><p>Uvedeny jsou pak tyto informace:</p><ul><li>Identifikace denního výkonu:<br><ul><li>řidič,</li><li>přiřazené vozidlo,</li><li>datum realizace.</li></ul></li><li>Obsažené položky denního výkonu:<br><ul><li>Informace o objednané službě:<br><ul><li>pořadí v rámci denního výkonu,</li><li>typ úkonu,</li><li>zákazník,</li><li>druhy odpadu,</li><li>typ nádoby,</li><li>poznámka k objednané službě,</li><li>poznámka k MR,</li><li>kontakt k MR.</li></ul></li><li>Informace o obsažených lokacích objednané služby:<br><ul><li>akce v lokaci,</li><li>typ lokace,</li><li>adresa lokace,</li><li>předpokládaný čas příjezdu.</li></ul></li></ul></li><li>Poznámka k dennímu výkonu – k uvedené poznámce navíc doplněn volný prostor pro ruční doplnění poznámky na vytištěný itinerář.</li></ul></td></tr></tbody></table><h1>Zobrazení označených položek na obrazovce pro plánování denních výkonů</h1><p> Implementováno.</p><p>Na obrazovce pro plánování denních výkonů (M4) bude doplněna možnost určit, jaké denní výkony budou zobrazeny v mapě s denními výkony:</p><ul><li>V mapě denních výkonů budou zobrazeny pouze označené denní výkony.</li><li>V mapě denních výkonů budou zobrazeny všechny načtené denní výkony.</li></ul><p>V obou případech bude v mapě zvýrazněn poslední označený denní výkon (bílé orámování, jako je tomu i nyní u označeného denního výkonu). Na obrázku je pak naznačeno, kde budou tlačítka pro uvedené nastavení umístěna. Vždy je pak stisknuto právě jedno tlačítko. Obdobný prvek se vyskytuje na obrazovce pro monitoring realizace denních výkonů (M7).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 14-21-17.png" data-attachment="true"></p><p>V rámci přehledu je pak umožněno označit více denních výkonů zároveň – označení denních výkonů se pak projevuje v obou mapách. Dále je tedy uvedena rekapitulace chování pro obě mapy:</p><ul><li>Mapa objednaných služeb:<br><ul><li>V mapě se na pozadí zobrazují trajektorie všech označených denních výkonů (pouze trajektorie – bez lokací). Barva trajektorie jednotlivých denních výkonů odpovídá té v mapě s denními výkony.</li><li>V pořadí poslední označený denní výkon je v mapě zvýrazněn.</li><li>Pokud není v přehledu označen žádný denní výkon, není v mapě zobrazena ani žádná trajektorie denního výkonu.</li></ul></li><li>Mapa denních výkonů – v mapě zobrazené trajektorie denních výkonů (pouze trajektorie – bez lokací) se liší dle nastavení, které bylo uvedeno dříve:<br><ul><li>Zobrazit pouze označené – jsou zobrazeny všechny v přehledu označené denní výkony. Poslední označený denní výkon je graficky zvýrazněn. Pokud není označen žádný denní výkon, je v mapě zobrazena trajektorie pro všechny denní výkony.</li><li>Zobrazit vše – jsou zobrazeny všechny v přehledu načtené denní výkony. Pokud je v přehledu označen alespoň jeden denní výkon, je v mapě zvýrazněn. Zvýrazněn je pak pouze poslední označený denní výkon.</li></ul></li></ul><p>Dále budou v přehledu denních výkonů jednotlivé denní výkony barevně odlišeny podle barvy trajektorie na mapě s denními výkony, viz uvedené varianty v tabulce.</p><table><tbody><tr><th>Varianta</th><th>Náhled</th><th>Popis</th></tr><tr><td>1</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 14-33-43.png" data-attachment="true"></td><td>V rámci sloupce Vozidlo je zobrazen barevný pruh s barvou odpovídající trajektorie.</td></tr><tr><td>2</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 14-34-5.png" data-attachment="true"></td><td>V rámci sloupce Vozidlo je zobrazena barevná indikace s barvou odpovídající trajektorie.</td></tr></tbody></table><p>Dojde pak k rozšíření barevné škály pro obarvení trajektorií v mapě s denními výkony, viz uvedené varianty v tabulce.</p><table><tbody><tr><th>Varianta</th><th colspan="2">Náhled</th><th>Popis</th></tr><tr><td colspan="1">1</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 16-11-28.png" data-attachment="true"></td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 16-11-12.png" data-attachment="true"></td><td colspan="1">Jsou vybrány 3 barvy, u každé pak 3 její odstíny.</td></tr><tr><td colspan="1">2</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 16-10-21.png" data-attachment="true"></td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 16-10-52.png" data-attachment="true"></td><td colspan="1">Jsou vybrány 4 barvy, u každé pak 2 její odstíny.</td></tr><tr><td colspan="1">3</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 16-26-47.png" data-attachment="true"></td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-7 16-27-7.png" data-attachment="true"></td><td colspan="1">Je vybráno 10 barev.</td></tr><tr><td colspan="1">4</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-19 11-30-34.png" data-attachment="true"></td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-19 11-30-15.png" data-attachment="true"></td><td colspan="1"><p>Je vybráno 5 barev, u každé pak 2 její odstíny.</p><p>Poznámka: Na požadavek zákazníka doplněna paleta barev, u které nebude brán ohled na barevný mapový podklad.</p></td></tr><tr><td colspan="1">5</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-19 11-30-52.png" data-attachment="true"></td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2019-11-19 11-31-13.png" data-attachment="true"></td><td colspan="1"><p>Je vybráno 7 barev.</p><p>Poznámka: Na požadavek zákazníka doplněna paleta barev, u které nebude brán ohled na barevný mapový podklad.</p></td></tr></tbody></table><p>Poznámka: Denní výkony, které neobsahují ani jednu položku denního výkonu, nejsou v mapě zobrazeny (trajektorie není k dispozici). Nejsou tedy ani graficky odlišeny.</p><h1>Omezení při vytváření zákazníka dle existujícího podnikatelského subjektu</h1><p> Čeká na vyhodnocení pracnosti.</p><p>V rámci systému je možné vytvořit nového zákazníka, který je za určitých podmínek odeslán na schválení do WinyX. Nově je pak požadováno, pokud je zákazník při vytváření načten z rejstříku podnikatelských subjektů, omezení uživatelem editovatelných dat.</p><p>Je tedy požadováno, aby v případě, kdy je zákazník načten z externího systému, došlo k znepřístupnění následujících polí formuláře:</p><ul><li>Název,</li><li>Adresa sídla,</li><li>Právní forma,</li><li>IČO,</li><li>DIČ,</li><li>IČ DPH,</li><li>Plátce DPH.</li></ul><p>Došlo by tedy k následujícím změnám:</p><ul><li>Přidání atributu <strong>Načten z externího systému</strong> u entity Zákazník. To systému umožní vyhodnotit, zda byly informace o zákazníkovi získány z externího systému i v případě, kdy uživatel zákazníka edituje, ne pouze při jeho vytvoření.</li><li>Změna chování formuláře pro vytvoření či editaci zákazníka, kdy jsou jednotlivá pole dostupná na základě přidaného atributu. Navíc je nutné vyhodnotit situaci, kdy uživatel změní typ zákazníka na Nepodnikatele, v takovém případě je nutné aktualizovat hodnotu uvedeného atributu.</li><li>Revize algoritmu pro synchronizaci – nově načtená data z WinyX nesmí přepsat hodnotu nového atributu.</li><li>Doplnění tlačítka pro smazání obsahu formuláře. To umožní uživateli jak smazat obsah formuláře, tak „odemknout“ uzamčená pole v případě, kdy byl zákazník načten z externího systému.</li></ul><p>Navíc bude přidána jednoduchá kontrola, zda již zákazník se stejným IČO není v systému přidán. Pokud zákazník se stejným IČO již existuje, systém při uložení zobrazí modální okno s dotazem, zda si uživatel přeje zákazníka opravdu vytvořit. Uživatel pak může zvolit zda, chce v uložení pokračovat.</p><p>Poznámka: Při načtení zákazníka z rejstříku podnikatelských subjektů však nebude možné v rámci editace adresy sídla rovnou vytvořit místo realizace s totožnou adresou – editace adresy sídla nebude dostupná. Aktuální chování však umožňuje snadné vytvoření místa realizace, kdy jeho adresa odpovídá adrese sídla. Chování je následující:</p><ul><li>Pokud je vyplněna adresa sídla a zároveň není přidáno žádné místo realizace, jsou do formuláře místa realizace automaticky předvyplněny informace o adrese sídla.</li><li>Uživatel pak pro tuto adresu pouze spustí geokódování a případně blíže specifikuje souřadnice.</li></ul><h1>Výpadky – nedostupné pozice</h1><p> Nutná implementace chování na straně FLWW2.</p><p>V rámci testování se objevily případy, kdy pro některá vozidla nejsou k dispozici všechny pozice. V rámci monitoringu realizace denních výkonů pak nejsou z tohoto důvodu k dispozici všechna potřebná data. To se projevuje hned v několika ohledech:</p><ul><li>získaná trajektorie vozidla se se v rámci RP a FLWW2 liší,</li><li>nemusí dojít ke správnému vyhodnocení realizace jednotlivých lokací (mohou chybět data o průjezdu danou oblastí).</li></ul><p>Důvod, proč nejsou pozice k dispozici, není přesně znám – je potřeba jej přesně specifikovat, k tomu by mělo pomoci dále uvedené zaznamenávání chybových stavů. Aktuálně získané informace jsou pak následující:</p><ul><li>Z důvodu vytížení serveru získá RP odpověď typu „timeout“ místo toho, aby API FLWW2 vrátilo požadované informace. Jedná se o pravděpodobný důvod uvedeného problému, ale není jisté, zda se tak děje pouze v tomto případě.</li><li>Předpoklad, že některé pozice jsou z důvodu vytížení geoserveru nedostupné (nebylo pro ně provedeno reverzní geokódování, a tak čekají ve frontě mimo ostatní pozice), se ukázal jako mylný.</li><li>Dalším důvodem nedostupnosti pozic může být výpadek, tedy že se pozice z vozidla do FLWW2 ani nedostanou. Jsou načteny až dodatečně.</li></ul><h2>Návrh řešení</h2><p>V tuto chvíli by mělo vyhodnocení realizace denních výkonů probíhat následovně:</p><ol><li>Realizace je vyhodnocována průběžně během dne.</li><li>Následně, v době kolem půlnoci, je pro denní výkony toho dne ukončeno vyhodnocení realizace. Poté je u těchto denních výkonů změněn stav na hodnotu Ke kontrole.</li></ol><p>Nové řešení pak to stávající rozšiřuje:</p><ul><li>Na API FLWW2 bude doplněna informace, zda jsou pro odpovídající vozidlo k dispozici všechny pozice.</li><li>Pokud systém v rámci kroku 1 zjistí, že pro daný denní výkon nejsou dostupné všechny pozice, označí tento denní výkon příznakem a v rámci uživatelského rozhraní denní výkon zvýrazní – uživatel vidí, že realizace denního výkonu nebyla (a nemohla být) vyhodnocena v plném rozsahu. Zvýraznění denního výkonu je pak provedeno na těchto místech:<br><ul><li>přehled denních výkonů,</li><li>obrazovka pro monitoring realizace denních výkonů,</li><li>obrazovka pro potvrzení realizace denního výkonu.</li></ul></li><li>Nastavení příznaku u denního výkonu uživatele nijak neomezuje v potvrzení realizace tohoto denního výkonu. Jedná se pouze o doplňující informaci.</li><li>V rámci kroku 2 pak nově systém opětovně vyhodnotí realizaci takových denních výkonů, které mají nastaven příznak, že v rámci průběžného vyhodnocení nebyly k dispozici všechny pozice. Automaticky tak opraví ty realizace denního výkonu, u kterých byly pozice obnoveny ještě v den realizace.</li><li>Uživatel pak může provést opětovné vyhodnocení realizace denního výkonu ručně. Samotné vyhodnocení se pak neliší od toho, které je použito v rámci rozšířeného kroku 2. Opětovné vyhodnocení lze spustit na následujících místech:<br><ul><li>přehled denních výkonů,</li><li>obrazovka pro monitoring realizace denních výkonů,</li><li>obrazovka pro potvrzení realizace denního výkonu.</li></ul></li></ul><p>V rámci průběžného vyhodnocení z kroku 1 jsou pak sledovány určité charakteristiky, které pomohou s vyhodnocením, kdy, proč a v jakém rozsahu uvedené komplikace vznikají. Základní parametry sledování jsou uvedeny dále:</p><ul><li>vozidlo,</li><li>čas výskytu,</li><li>množství chybějících pozic,</li><li>…</li></ul><p>Podle získaných informací pak bude možné vyhodnotit, zda problém vzniká pouze u některých vozidel (problém s vozidlovou jednotkou), nebo se například vyskytuje pouze v určitém období (zvýšené vytížení systému).</p><h1>Detail zákazníka při velkém množství míst realizace</h1><p><strong>Zvolena varianta <a href="navrhy-86147199.html">Postupné načítání záznamů</a></strong><strong>.</strong></p><p> Čeká na upřesnění a následné zanesení do dokumentace.</p><p>Ve chvíli, kdy se uživatel pokouší ve správě systému zobrazit detail zákazníka, ke kterému je přiřazeno velké množství míst realizace, nastává problém. Probíhá načítání detailních informací o zákazníkovi, ale vzhledem k jejich množství k samotnému dokončení načítání nedojde. Nejsou tedy zobrazena jak všechna místa realizace, tak ani základní informace – viz obrázek.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-6 13-48-47.png" data-attachment="true"></p><p>Poznámka: U atributů podobného typu v rámci entity Zákazník by k uvedenému problému docházet nemělo (vzhledem k povaze dat). Stojí ale za zvážení, zda nepoužít navržené chování obdobným způsobem i pro ostatní atributy typu kolekce.</p><p>Problém je pak možné řešit několika způsoby, některé z nich jsou uvedeny dále. U všech návrhů řešení pak byla změněna pozice atributu Poznámka, která byla umístěna nad atributy ve formě kolekce. Uvedené změny jsou pak naznačeny žlutě.</p><p><strong>Poznámka: V rámci produkční databáze se pak vyskytuje 34 zákazníků, kteří mají více jak 10 míst realizace. Z toho 11 zákazníků má více jak 50 míst realizace. Více jak 1 000 míst realizace mají 4 zákazníci.</strong></p><h2>Načtení prvních N záznamů</h2><p>Jak již bylo uvedeno, došlo ke změně pozice ovládacího prvku pro atribut Poznámka. Druhou změnou je počet načítaných míst realizace v rámci detailu. Vždy je načteno maximálně N míst realizace. U běžného zákazníka s „rozumným“ počtem míst realizace tedy nedojde ke změně chování.</p><p>Uživatel pak může použít textový filtr pro hledání požadovaného záznamu. Vyhledávání bude umožněno podle názvu a adresy místa realizace. Dále bude k dispozici filtr dle indikace chybějících souřadnic, buď budou brána v potaz všechna místa realizace, nebo pouze ta s nevyhovujícími souřadnicemi. Také je doplněn celkový počet míst realizace odpovídajícího zákazníka. Způsob zobrazení přehledu míst realizace je zachován.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-17 7-49-39.png" data-attachment="true"></p><h2>Postupné načítání záznamů</h2><p>Jak již bylo uvedeno, došlo ke změně pozice ovládacího prvku pro atribut Poznámka. Další změna se odehrává ve skupině ovládacích prvků pro atribut Místa realizace. Zde je doplněno postupné načítání – je načtena pouze část míst realizace, ostatní jsou postupně načítána až ve chvíli, kdy uživatel provede posunutí v rámci přehledu míst realizace. Detail místa realizace je jako doposud zobrazován přímo pod odpovídající položkou představující místo realizace.</p><p>Při zobrazení detailu pak bude načteno prvních 100 míst realizace. Při dosažení konce přehledu je načteno dalších 100 míst realizace. Načítání probíhá do doby, kdy je dosaženo posledního místa realizace.</p><p>Posuvník v přehledu míst realizace je zobrazován v případě, kdy počet obsažených míst realizace přesáhne hodnotu 20 (bez zobrazeného detailu místa realizace).</p><p>Poznámka: Vzhledem k vysoké hodnotě čísla N byl uvedený popis modifikován (přeškrtnutý text).</p><p>Posuvník v přehledu míst realizace je zobrazován ve chvíli, kdy je načteno více než N položek. Tomu odpovídá i maximální výška této skupiny ovládacích prvků. Ta je navýšena pouze ve chvíli, kdy je zobrazen detail místa realizace.</p><ul><li>Pokud je načteno méně než N položek (případně právě N položek), výška skupiny odpovídá počtu načtených položek. Není zobrazen posuvník.</li><li>Pokud je načteno více než N položek (a zároveň není zobrazen detail), odpovídá maximální výška skupiny N položkám. Je zobrazen posuvník. Viz první obrázek.</li><li>Pokud je načteno více než N položek (a zároveň je zobrazen detail), odpovídá maximální výška skupiny N položkám spolu s výškou detailu. Je zobrazen posuvník. Viz druhý a třetí obrázek.</li></ul><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-16 13-30-26.png" data-attachment="true"></p><h2>Zobrazení ve formě tabulky</h2><p>Jak již bylo uvedeno, došlo ke změně pozice ovládacího prvku pro atribut Poznámka. Dále byl přesunut přehled míst realizace na samostatnou kartu. Na kartě Detail pak bylo zachováno alespoň výchozí místo realizace, kdy je stále k dispozici možnost zobrazit detail místa realizace a spustit jeho editaci (část zákazníků eviduje pouze jedno místo realizace, nejsou tedy nuceni přepínat na kartu s místy realizace).</p><p>Karta Místa realizace obsahuje tabulku míst realizace, ta umožňuje filtrování i řazení záznamů (nastavení tabulky není ukládáno do uživatelského nastavení). Je použito stránkování a zobrazeny jsou následující údaje:</p><ul><li>Informace o chybějících souřadnicích.</li><li>Název místa realizace.</li><li>Stav geokódování.</li></ul><p>Pod samotnou tabulkou je pak umístěn detail právě označeného místa realizace.</p><p>Poznámka: Výchozí místo realizace je v tabulce zvýrazněno. Výška tabulky je pevně dána.</p><p> Uvedené řešení chyby vyžaduje spoluúčast ze strany MPG SK.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-13 12-30-27.png" data-attachment="true"></p><h1>Prodleva při načítání dat pro monitoring realizace</h1><p><strong>Zvolena varianta 1.</strong></p><p> Čeká na Implementaci.</p><p>TODO: Změnový požadavek? Jedná se o schválené chování, ve FLWW2 se však mapa při načítání dat chová odlišně.</p><p>Na obrazovce pro monitoring realizace dochází, pokud den realizace odpovídá dnešnímu datu, k pravidelné aktualizaci zobrazených dat. Obnovení pak probíhá v zadaném intervalu. V produkčním prostředí (na konkrétních provozovnách) ale dochází k určité prodlevě, která se projevuje tak, že uživatel nevidí aktuální stav realizace – na obrazovce se pouze točí kolečko, viz obrázek. Toto „zamrznutí“ pak trvá v rozmezí 1 až 3 sekund.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-6 13-50-42.png" data-attachment="true"></p><p>Možná řešení jsou uvedena v tabulce.</p><table><tbody><tr><th>Varianta</th><th>Popis</th><th>Náhled</th></tr><tr><td>1</td><td><p>Bude odebrána animace informující uživatele, že probíhá načítání dat. Uživatel tak vždy uvidí právě načtená data.</p></td><td>–</td></tr><tr><td>2</td><td>Bude odebrána animace informující uživatele, že probíhá načítání dat. Tato informace bude přenesena do hlavní nástrojové lišty obrazovky. Uživatel tedy uvidí, že se právě načítají aktuální data, ale nebude rušen při práci s mapou.</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-13 17-10-23.png" data-attachment="true"></td></tr><tr><td>3</td><td><p>Bude odebrána animace informující uživatele, že probíhá načítání dat. V hlavní nástrojové liště pak bude uveden čas poslední aktualizace. Uživatel tedy vidí, jak stará data má v rámci obrazovky zobrazena.</p><p>Poznámka:</p><ul><li>Informace bude zobrazena pouze v případě, že je sledován aktuální provoz (tedy pouze v den realizace).</li><li>Může být doplněna indikace, že se právě aktualizují zobrazená data. Čas poslední aktualizace bude po dobu načítání dat doplněn o „točící se kolečko“, uživatel tedy vidí, že jsou právě načítána data.</li></ul></td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-13 17-10-53.png" data-attachment="true"></td></tr></tbody></table><h1>Načtení adresy zákazníka pomocí služby FinStat</h1><p> Čeká na vyjádření zákazníka.</p><p>Při načítání dat o zákazníkovi ze služby FinStat je k dispozici adresa tohoto zákazníka, její formát však není pro naše potřeby dostačující. Číslo popisné a číslo orientační je předáno jako jedna společná hodnota (např.: 123/15), to je potřeba řešit.</p><p>Chybou je pak ukládání této hodnoty pod atributem Číslo orientační, což může být matoucí. Hodnota je navíc odesílána do WinyX.</p><p>Poznámka: Zobrazení chybné hodnoty přímo ve WinyX s tímto problémem nesouvisí.</p><h2>Revize načítaní adresy</h2><p>Bude provedena revize chování pro načítání adresy zákazníka pomocí služby FinStat. Uvedená hodnota získaná ze služby FinStat bude uložena pod atributem Číslo popisné, nikoliv k atributu Číslo orientační.</p><p>Uvedené řešení chyby nevyžaduje spoluúčast ze strany MPG SK.</p><h2>Průvodce při načítání adresy</h2><p>Bude provedena revize chování pro načítání adresy zákazníka pomocí služby FinStat, která bude doplněna o průvodce zadání čísla popisného a čísla orientačního.</p><ul><li>Pokud bude získaná hodnota ze služby FinStat obsahovat pouze číslice, bude uložena pod atributem Číslo popisné.</li><li>Jinak bude zobrazen průvodce, kde uživatel zvolí, která část hodnoty bude uložena pod atributem Číslo popisné a která pod atributem Číslo orientační.</li></ul><p> Uvedené řešení chyby vyžaduje spoluúčast ze strany MPG SK.</p><h2>Převodník načítané hodnoty</h2><p>Bude provedena revize chování pro načítání adresy zákazníka pomocí služby FinStat, která bude doplněna o automatizovaný převodník.</p><ul><li>Pokud bude získaná hodnota ze služby FinStat obsahovat pouze číslice, bude uložena pod atributem Číslo popisné.</li><li>Jinak se systém pokusí o vyhodnocení získané hodnoty a určení, která část bude uložena pod atributem Číslo popisné a která pod atributem Číslo orientační (pozn.: může docházet k chybám ve vyhodnocení).</li></ul><p> Uvedené řešení chyby vyžaduje spoluúčast ze strany MPG SK.</p><h1>Zobrazení itineráře trasy u monitoringu realizace</h1><p><strong>Zvolena varianta <a href="navrhy-86147199.html">Revize aktuálního způsobu řešení</a></strong><strong>.</strong></p><p> Čeká na implementaci.</p><p>Na obrazovce pro monitoring realizace je možné zobrazit kontextovou nabídku s itinerářem trasy požadovaného denního výkonu. Ta je zobrazena po najetí myší na odpovídající ikonu v rámci přehledu. Může ale nastat situace, kdy se tabulka nevejde do prostoru v rámci obrazovky. Část této nabídky pak ale není viditelná, viz obrázek.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-6 13-59-58.png" data-attachment="true"></p><h2>Revize aktuálního způsobu řešení</h2><p>Bude provedena revize aktuálního chování, kdy bude nabídka upravena tak, aby mohla vyplnit vetší část prostoru obrazovky (viz obrázek). Díky tomu bude možné zobrazit v nabídce více lokací objednané služby než nyní. Bude tak pokryta značná část problémových případů.</p><p>Uvedené řešení chyby nevyžaduje spoluúčast ze strany MPG SK.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-13 16-25-12.png" data-attachment="true"></p><h2>Změna rozložení obrazovky</h2><p>Itinerář trasy bude zobrazen v samostatném panelu (viz obrázek), jeho struktura bude zachována. V rámci panelu pak bude zobrazen itinerář trasy pro právě označený denní výkon. Pokud je označeno více denních výkonů zároveň, je v panelu zobrazen itinerář trasy takového denního výkonu, který byl označen jako poslední.</p><p> Uvedené řešení chyby vyžaduje spoluúčast ze strany MPG SK.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-13 16-30-49.png" data-attachment="true"></p><h1>Revize typů dopravy u přívěsů</h1><p> Čeká na vyhodnocení pracnosti.</p><p>V rámci pilotního provozu došlo k požadavku provést revizi typů dopravy, pro které je možné použít jednotlivé přívěsy, viz tabulka. Vyhodnocení probíhá dle interního čísla přívěsu.</p><table><tbody><tr><th>Interní číslo</th><th>Aktuální typy dopravy</th><th>Požadované typy dopravy</th></tr><tr><td>09xx</td><td>Hákový nakladač</td><td>Hákový nakladač</td></tr><tr><td>08xx</td><td>Ramenový nakladač</td><td>Ramenový nakladač</td></tr><tr><td>19xx</td><td>Hákový nakladač, Ramenový nakladač</td><td>Hákový nakladač, Ramenový nakladač</td></tr><tr><td colspan="1">48xx</td><td colspan="1">Valník</td><td colspan="1">Valník, Hákový nakladač, Ramenový nakladač</td></tr></tbody></table><p>Změna pak obnáší především 2 základní kroky:</p><ul><li>Aktualizace existujících dat.</li><li>Revize algoritmu pro import přívěsů, viz <a href="../funkcni-specifikace/pripady-uziti/600ucxx-import-dat/600uc02-83265163.html">Převodní můstek interní číslo MPG - typ přívěsu</a>.</li></ul><h1>Změna typu dopravy vozidla</h1><p> Čeká na vyjádření zákazníka.</p><p>Aktuálně je typ dopravy získán na základě interního identifikačního čísla konkrétního vozidla, které je dodáno externím systémem (WinyX). Dle prvních dvou číslic zmíněného čísla dojde k zařazení vozidla pod určitý typ dopravy. Toto interní identifikační číslo pak u několika vozidel (řádově jednotky) neodpovídá skutečnému typu dopravy. Je tedy požadováno, aby bylo možné typ dopravy změnit. Možná řešení jsou uvedena dále.</p><p>Poznámka: Ruční zásah na úrovni databáze není vhodným řešením, a to ani když se jedná o jednotky položek. Při každé změně v rámci konkrétního vozidla navíc dojde k přepsání typu dopravy do původního stavu.</p><h2>Aktualizace v rámci externího systému</h2><p>Jedno z možných řešení je doplnění atributu Typ dopravy přímo v externím systému. Tam by tedy probíhalo i nastavení požadovaného typu dopravy u konkrétního vozidla. V rámci RoadPlan by pak došlo pouze ke změně vyhodnocení v rámci importu. Typ dopravy by nebyl získáván výpočtem z interního evidenčního čísla, ale jednoduše by byl převzat z nově přidaného atributu.</p><h2>Správa vozidel</h2><p>Správa systému modulu RoadPlan by byla doplněna o přehled vozidel, kde by bylo možné nastavit i požadovaný typ dopravy. Ve výchozím stavu by byl typ dopravy získán z externího systému, ale bylo by možné jej změnit.</p><p>Poznámka:</p><ul><li>V tuto chvíli nebude implementována možnost nastavení platnosti typu dopravy u konkrétního vozidla.</li><li>Zároveň je možné doplnit stanoviště vozidla, o kterém bylo diskutováno dříve. Pro připomenutí, v rámci denního výkonu by pozice jeho začátku a konce mohla být vyhodnocena dle konkrétního vozidla.</li></ul><h1>Kopírování bodu průjezdu</h1><p> Čeká na vyjádření zákazníka.</p><p>Vzhledem k tomu, že není v rámci aktuálně používaného mapového serveru (výpočet trasy) umožněno vkládání uzavírek, je potřeba usnadnit dispečerům vytváření objízdných tras. Jedna z možností, kterou dispečeři aktuálně využívají, je vložení bodu průjezdu do trasy. Ti však musí opakovaně vytvářet bod průjezdu pro každou z cest, která vede přes uzavřený úsek. Dále jsou tedy uvedeny možné návrhy řešení.</p><p>Poznámka: Nabízená řešení mohou být implementována zároveň. Uživatel by měl možnost vybrat bod průjezdu z nabídky a v rámci jednoho denního výkonu ho dále jen kopírovat. </p><h2>Kopírování bodu průjezdu</h2><p>V rámci obrazovky pro editaci denního výkonu (M5) bude vložena funkce, která umožní kopírování existujícího bodu průjezdu. Uživatel tedy v tabulce označí požadovaný bod průjezdu a stiskne odpovídající tlačítko v nástrojové liště. Tím dojde k vytvoření kopie označeného bodu průjezdu, která je vložena jako poslední položka denního výkonu.</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-3-4 13-43-8.png" data-attachment="true"></p><h2>Seznam bodů průjezdu</h2><p>Aby uživatel nebyl nucen denně vytvářet jeden a ten samý bod průjezdu, nabízí se možnost vytvoření seznamu bodů průjezdu. Tuto myšlenku je možné zobecnit, jak naznačují varianty řešení uvedené v tabulce (vybrána může být právě jedna varianta).</p><p>Při vytváření takového bodu se pak na pozadí nastaví provozovna, pro kterou bude dostupný. Pouze u uživatelů, kteří mají oprávnění na více provozoven, bude možné provozovnu zvolit (není naznačeno v rámci náhledů). Uživateli se pak zobrazují pouze takové body průjezdy, které odpovídají jeho provozovně.</p><table><tbody><tr><th>Varianta</th><th>Náhled</th><th>Popis</th></tr><tr><td>1</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2020-3-5 8-30-47.png" data-attachment="true"></td><td><p>Pro každý typ adresného bodu je ve správě systému doplněn samostatný číselník. Tam uživatel může vkládat nové, či měnit a odebírat stávající záznamy. Jako příklad konkrétních číselníků lze uvést následující:</p><ul><li>body průjezdu,</li><li>místa dočasného uložení.</li></ul><p>Nevýhodou je ovšem velký počet položek menu v případě, kdy budou tyto číselníky dále rozšiřovány.</p><p>Pro vytváření či editaci bodu průjezdu je použit běžný formulář pro zadání adresy se souřadnicemi, který může být doplněn atributy:</p><ul><li>Název,</li><li>Poznámka.</li></ul><p>Poznámka: Název ani poznámka nejsou nutnými položkami pro plnohodnotnou funkčnost.</p></td></tr><tr><td>2</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2020-3-5 8-31-29.png" data-attachment="true"></td><td><p>Existuje společný přehled adresných bodů, ty jsou zadávány obdobným způsobem jako u varianty 1. I zde mohou být doplněny atributy Název a Poznámka (není nutné). Musí však být obsažen atribut specifikující typ adresného bodu, ten může nabývat následujících hodnot.</p><ul><li>bod průjezdu,</li><li>místo dočasného uložení.</li></ul><p>Výhodou pak je možnost snadného rozšíření typů adresných bodů, které navíc neovlivní počet položek v menu.</p></td></tr></tbody></table><p>Samotný přehled je pak tvořen tabulkou, její sloupce vychází z položek, které je možné zadat v rámci formuláře. Odvíjí se tedy i od zvolené varianty. V případě, kdy má uživatel právo na více než jednu provozovnu, je navíc zobrazen sloupec s informací, pro kterou provozovnu je bod průjezdu vytvořen. V případě potřeby může být doplněn i detail bodu průjezdu (v případě adresného bodu by byl zobrazen ještě typ adresného bodu).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-3-5 11-29-20.png" data-attachment="true"></p><p>Když máme k dispozici přehled bodů průjezdu, můžeme pokračovat v plánování těchto bodů na denní výkony. V tabulce jsou uvedeny možné varianty, jak vytvořený bod na denní výkon vložit. Obě varianty mohou být implementovány současně.</p><table><tbody><tr><th>Varianta</th><th>Náhled</th><th>Popis</th></tr><tr><td>1</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2020-3-5 9-14-51.png" data-attachment="true"></td><td><p>Aktuální tlačítko pro přidání bodu průjezdu bude doplněno o nabídku, kde si může uživatel zvolit, zda si přeje vytvořit nový bod průjezdu, nebo použít existující.</p><p>Nabídka pak obsahuje vložené body průjezdu pro odpovídající provozovnu (případně adresné body typu Bod průjezdu, dle zvolené varianty). Nevýhodou však je nutnost doplnit opatření pro případ, kdy existuje velké množství bodů průjezdu. To ovšem zvyšuje pracnost této varianty řešení.</p><p>V takovém případě by došlo k omezení výpisu na N položek, které by byly řazeny dle četnosti použití v rámci provozovny. Bylo by tedy zobrazeno N nejčastěji používaných bodů průjezdu. Změnou by prošla i struktura kontextové nabídky:</p><ul><li>vložení nového bodu průjezdu – chování jako ve stávající implementaci,</li><li>vložení existujícího bodu průjezdu – po kliknutí se zobrazí výběrový dialog s body průjezdu,</li><li>vložení konkrétního existujícího bodu průjezdu – výběr z N zobrazených bodů průjezdu.</li></ul></td></tr><tr><td>2</td><td><img src="navrhy-realizace-pozadavku-86147199_images/image2020-3-5 9-15-17.png" data-attachment="true"></td><td><p>Aktuální tlačítko pro přidání bodu průjezdu bude zachováno, změny se odehrávají až ve formuláři pro přidání bodu průjezdu. Pokud si uživatel přeje vytvořit nový body průjezdu, nic mu v tom nebrání. Pokud ale chce použít existující bod průjezdu (případně adresné body typu Bod průjezdu, dle zvolené varianty), může toho dosáhnout několika způsoby.</p><ul><li>Postupným psaním požadované adresy – uživatel postupně vpisuje požadovanou adresu, systém mu formou našeptávače nabízí odpovídající záznamy. Vždy je pak zobrazeno maximálně 10 záznamů zároveň.</li><li>Výběrem v modálním okně – uživatel stiskne tlačítko pro zobrazení přehledu bodů průjezdu, systém zobrazí modální okno, kde uživatel zvolí požadovanou položku.</li></ul><p>Po výběru požadovaného bodu průjezdu dojde k předvyplnění formuláře. Jedná se o obdobu vyhledávače podnikatelských subjektů ve formuláři zákazníka.</p></td></tr></tbody></table><p>Poznámka: Uvedené varianty řešení jsou pak v principu použitelné i pro místa dočasného uložení, samozřejmě s drobnými úpravami. </p><h1>Dodatečná změna nádoby v rámci objednávky</h1><p> Čeká na vyjádření zákazníka.</p><p>V praxi se vyskytují případy, kdy zákazník požaduje provedení určitého úkonu s nádobou, ale specifikace požadavku není přesná. Nastávají tak případy, kdy neodpovídá například druh odpadu v nádobě, případně není správně zvolen úkon s nádobou tak, aby uspokojil potřebu zákazníka. V tuto chvíli musí dispečer či obchodní zástupce vytvořit novou objednávku pouze pro nepřesně specifikovanou nádobu, případně její část. Původní objednané služby musí ručně zrušit. Je tedy požadováno, aby některé informace o objednané nádobě šlo měnit i v momentě, kdy již probíhá realizace obsluhy.</p><p>Prvním krokem pro vyřešení požadavku je specifikace toho, co se má stát s původní objednanou nádobou, respektive vytvořenými objednanými službami. My doporučujeme pouze zrušení její platnosti a vytvoření náhradní objednané nádoby. Důvodem je především možnost vyhodnocení, jak často k těmto situacím dochází, u kterých zákazníků a na kterých provozovnách. Uvedená funkce je pak dostupná pouze u objednávek, které jsou ve stavu K realizaci či Plněná. Pokud je pak označena vyhovující objednaná nádoba (již nebyla zrušena její platnost), zobrazí se tlačítko pro spuštění tohoto případu užití (viz obrázek).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-19 12-18-7.png" data-attachment="true"></p><p>Poznámka: Jako vhodné se jeví nejen zrušení platnosti s následným vytvořením navazující objednané nádoby, ale i samostatné zrušení. V tuto chvíli lze takového chování dosáhnout pouze zrušením celé objednávky. Zde je potřeba určit i to, zda bude k dispozici zrušení poslední aktivní objednané nádoby.</p><p>Předpokládané chování je tedy následující:</p><ol><li>Uživatel zvolí objednávku a zadá požadavek na její editaci.</li><li>Systém zobrazí formulář pro odpovídající objednávku.</li><li>Uživatel zvolí aktivní objednanou nádobu a zadá požadavek na zrušení její platnosti.</li><li>Systém zobrazí formulář pro nastavení objednané nádoby (existující formulář), který vyplní dle zvolené nádoby. Editace je pak umožněna pouze u následujících polí:<br><ul><li>Druhy odpadu – možnost přidání či odebrání, případně změny likvidačního místa.</li><li>Objednané úkony – možnost přidání či odebrání, případně změna termínu či pravidla opakování (pozn.: může vyžadovat změnu údajů zadávaných ve formě data a času, musí být nastaveny minimálně na dnešní datum – pro pravidlo opakování, termín).</li></ul></li><li>Uživatel potvrdí provedené změny.</li><li>Systém provede validaci zadaných údajů.</li><li>Systém vyhodnotí, jaké změny proběhly v rámci formuláře:<br><ul><li>Zda došlo ke změně ve skupině s druhy odpadu.</li><li>Zda došlo ke změně ve skupině s objednanými úkony.</li></ul></li><li>Dle rozsahu provedených změn systém vyhodnotí, které objednané služby budou změnou ovlivněny.<br><ul><li>Pokud došlo ke změně ve skupině s druhy odpadu, jsou ovlivněny všechny objednané služby vzniklé z této objednané nádoby.</li><li>Pokud došlo ke změně ve skupině s objednanými úkony, jsou ovlivněny všechny objednané služby vzniklé ze změněných objednaných úkonů.</li><li>Poznámka:<br><ul><li>Zahrnuje nejen změněné, ale i odebrané položky.</li><li>Zajímají nás pak pouze objednané služby ve stavu K naplánování a Naplánovaná.</li></ul></li></ul></li><li>Dle množiny získaných objednaných služeb dojde k upozornění uživatele, jaké akce budou provedeny:<br><ul><li>Pokud jsou nalezeny pouze objednané služby ve stavu K naplánování, není zobrazeno žádné upozornění.</li><li>Pokud je obsažena alespoň jedna objednaná služba ve stavu Naplánovaná a zároveň je objednaná služba vložena na denní výkon v uvedeném stavu:<br><ul><li>Plánovaný: Je zobrazeno upozornění, že uložení změn povede k odebrání služeb z denních výkonů. Uživatel pak potvrdí či zruší uložení změn.</li><li>Schválený, Plněný: Je zobrazeno upozornění, že není možné zrušit platnost objednané nádoby (koresponduje s obdobnými akcemi ve zbytku systému) – uvedené změna tedy neprojde přes validaci. V rámci hlášení je možné zobrazit přímo odpovídající denní výkony.</li><li>Ostatní stavy nás nezajímají, u nich není možné provádět žádné změny na úrovni plánované trasy.</li></ul></li></ul></li><li>Pokud uživatel zruší provedené změny, dojde k návratu do formuláře objednávky, kde nejsou provedeny žádné změny.</li><li>Pokud uživatel potvrdí provedené změny, dojde k návratu do formuláře objednávky. Provedeny jsou následující změny:<br><ul><li>Je zvýrazněna objednaná nádoba, která byla označena jako neplatná.</li><li>Je přidána objednaná nádoba, která nahradila neplatnou objednanou nádobu.</li><li>Pokud uživatel označí v jednu z dvou zmíněných uvedených objednaných nádob, může zrušit zrušení platnosti – vytvořená objednaná nádoba je odebrána, původní nádoba je vrácena do výchozího stavu. Zde je potřeba upozornit na to, že pokud již byly vygenerovány nové objednané služby a ty staré zrušeny, nebude zrušením zrušení platnosti obnoven původní stav. Opět dojde ke zrušení stávajících a vytvoření nových objednaných služeb.</li></ul></li><li>Systém zavře formulář objednané nádoby.</li><li>Uživatel uloží provedené změny v rámci objednávky.</li><li>Systém provede validaci zadaných údajů.<br></li><li>Systém uloží provedené změny a spustí potřebné kroky pro dokončení případu užití:<br><ul><li>Odebrání objednaných služeb z denních výkonů.</li><li>Zrušení všech nalezených objednaných služeb ve stavu K naplánování (zahrnuje i ty z předešlého kroku). TODO: Je požadováno přidání nového stavu objednané služby (zrušena z důvodu zrušení platnosti objednané nádoby)? To může být vhodné pro budoucí reportování, navíc to usnadní znepřístupnění těchto objednaných služeb v jejich přehledu.</li><li>Vygenerování nových objednaných služeb.</li></ul></li><li>Systém zavře formulář objednávky a vrátí se tam, kde došlo k zadání požadavku na editaci objednávky.</li></ol><p>Poznámka: Samotné rušení se aplikuje okamžitě po uložení provedených změn v rámci objednávky, není možné zadat konkrétní datum a čas. Datum a čas zrušení platnosti bude u objednané nádoby uvedeno. Stejně tak bude k dispozici informace, která nádoba z té zrušené vznikla a naopak.</p><h1>Překrývající se lokace při editaci denního výkonu</h1><p> Čeká na vyjádření zákazníka. Aktuální chování je možná dostačující.</p><p>V rámci mapy na obrazovce pro editaci denního výkonu (M5) dochází k překryvu jednotlivých skupin lokací – párování probíhá na základě konkrétních souřadnic lokace. Pokud jsou souřadnice totožné, dojde při zobrazení v mapě k párování. Zjednodušeně řečeno, pokud bude mít místo realizace stejné souřadnice jako bod průjezdu, bude vidět pouze jedna z těchto lokací, ale v rámci nápovědy s pořadím v rámci denního výkonu budou zahnuty obě lokace. Pokud se však souřadnice liší pouze nepatrně, lokace se také překrývají, ale nedojde k párování v rámci nápovědy s pořadím. To je naznačeno na obrázku. V mapě je vidět jedno místo realizace a 3 body průjezdu. Všechny body průjezdu mají totožné souřadnice (nabídka s pořadím je společná), souřadnice místa realizace se však nepatrně liší (mají vlastní nabídku s pořadím v rámci denního výkonu).</p><p><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-16 16-43-43.png" data-attachment="true"></p><h1>Specifikace algoritmu pro výpočet trasy</h1><p> Čeká na vyjádření zákazníka.</p><p>Způsob, jakým je počítána trasa mezi jednotlivými body, je možné specifikovat. Konkrétně je požadováno, aby bylo možné v rámci aplikace určit, zda bude právě použita nejrychlejší či nejkratší trasa. Aktuálně se jedná především o algoritmus pro výpočet trasy denního výkonu.</p><p>Vzhledem ke způsobu, jakým je trasa počítána, není možné způsob výpočtu jednoduše zadat na úrovni dotazu na mapový server. Pro potřeby hledání trasy jsou totiž předpřipravena data, která pomáhají k rychlejšímu získání odpovědi na dotaz. Tato data jsou generována i dle uvedeného kritéria. Nejsou tedy připravena na změnu kritéria v reálném čase, muselo by dojít k přepočtu pomocných dat. Uvedená situace má však řešení.</p><p>Zmíněná pomocná data je možné připravit dle požadovaných kritérií vícekrát. Takže jedna budou k dispozici pro hledání nejrychlejší cesty, druhá pro cestu nejkratší. Na úrovni dotazu na mapový server je pak možné říci, pomocí kterých dat má být trasa vyhodnocena.</p><p>Trasa pro denní výkony by pak byla počítána dle výchozího kritéria, ale uživatel by ho mohl změnit. Tuto akci by provedl v rámci obrazovky pro editaci denního výkonu (M5).</p><p>Poznámka: Místo jediného parametru pro výpočet trasy by jich mohlo být zadáno více – byly by vytvořeny tzv. profily pro výpočet trasy (např. možnost získat trasu alespoň pro osobní vozidlo v případě, kdy pro nákladní vozidlo nebyla žádná trasa nalezena).</p><table><tbody><tr><th>Varianta</th><th>Náhled</th><th colspan="1">Popis</th></tr><tr><td colspan="1">1</td><td colspan="1"><img src="navrhy-realizace-pozadavku-86147199_images/image2020-2-19 11-58-56.png" data-attachment="true"></td><td colspan="1"><p>V rámci detailu denního výkonu by došlo k přidání nové skupiny zobrazených informací. Aktuálně jsou na kartě vloženy souhrnné informace o denním výkonu a uložené průběhy editace denního výkonu. Nově by pak byla přidána skupina pro nastavení profilu výpočtu trasy. Uživatel by pak mohl zvolit, který z profilů bude pro výpočet trasy denního výkonu použit.</p></td></tr><tr><td colspan="1">2</td><td colspan="1">–</td><td colspan="1"><p>V rámci nástrojové lišty tabulky bude doplněno tlačítko, které umožní nastavit profil výpočtu trasy. Po stisknutí tlačítka se objeví modální okno, kde bude možné vybrat požadovaný profil výpočtu trasy. Uživatel zároveň v rámci okna uvidí, jak jsou nastaveny jednotlivé parametry profilu.</p></td></tr></tbody></table><p>Nastavení profilu výpočtu trasy se pak vždy aplikuje na celý denní výkon. Tento profil by pak byl zanesen i v rámci uloženého průběhu editace denního výkonu.</p><p>Na úrovni aplikace by pak mohlo být k dispozici nastavení výchozího profilu pro výpočet trasy. Toto nastavení by dále mohlo být nastavováno i na úrovni provozovny, typu dopravy či přímo vozidla. Při vytvoření denního výkonu by se pak profil výpočtu trasy nastavil dle naznačené struktury. Byl by získán přímo z vozidla, pokud by u něj nebyl k dispozici, nastavení by proběhlo dle typu dopravy – takto by se pokračovalo až na výchozí nastavení aplikace. Zde je pak nutné určit i to, zda se změna profilu např. na úrovni typu dopravy aplikuje i na nerealizované denní výkony, či nikoliv. Tedy zda dojde k přepočtu tras existujících denních výkonů.</p><h1>Nastavení data realizace při rozdělení objednané služby</h1><p> Čeká na vyhodnocení pracnosti.</p><p>Pokud uživatel vytváří místo dočasného uložení, případně rozděluje objednanou službu, systém v rámci formuláře automaticky přednastaví datum realizace vytvářené objednané služby. To je pak nastaveno na rozmezí dnes až zítra. To ovšem není vhodné v případech, kdy dispečer plánuje na několik dní dopředu.</p><p>Navrhujeme tedy, aby se ve formuláři rozmezí pro datum realizace objednané služby přednastavilo dle konkrétního denního výkonu, a to následovně:</p><ul><li>datum realizace denního výkonu,</li><li>datum realizace denního výkonu + 1 den.</li></ul><h1>Výčtový filtr sloupce tabulky pro dynamické hodnoty</h1><p> Čeká na vyjádření zákazníka.</p><p>V rámci tabulek se vyskytují sloupce, které obsahují informaci o konkrétním uživateli (respektive zaměstnanci), např. uživatel, který vytvořil objednávku. V těchto sloupcích je pak možné filtrovat dle zadaného textu. Nově je však požadováno, aby byl ve sloupcích tohoto typu obsažen výčtový filtr.</p><p>Požadavek je možné řešit doplněním dalšího dotazu na API, který zajistí dodání informace, které hodnoty se v rámci sloupce vyskytují. Postup bude tedy následující:</p><ul><li>Odeslání požadavku na data, která mají být zobrazena v tabulce (aktuální chování).</li><li>Odeslání požadavku pro všechny sloupce, kde se vyskytuje uvedený požadavek – získání hodnot, které se v uvedeném sloupci vyskytují. Hodnoty odpovídají právě nastaveným filtrům a podobně. Odeslání požadavku tedy musí být provedeno vždy spolu s požadavkem na získání dat.</li></ul><p>Poznámka: Uvedené chování může způsobit zpomalení načítání dat. Je tedy potřeba rozumně volit, pro které sloupce tabulky bude implementováno. A obecně dávat pozor, aby množství takových sloupců v jedné tabulce bylo rozumné.</p><h1>Revize formuláře pro změnu souřadnic místa realizace v rámci obrazovky pro monitoring realizace denních výkonů</h1><p> Čeká na vyjádření zákazníka.</p><p>Je požadována revize formuláře pro nastavení souřadnic MR tak, aby mohl uživatel snáze určit jeho nové souřadnice. Aktuálně se v mapě zobrazí pouze pozice MR, uživatel však přímo ve formuláři nevidí, kde skutečně proběhly odpovídající aktivace vstupů.</p><p>Pokud vezmeme v potaz detailnost mapových podkladů, uživatel si pravděpodobně po krátkou dobu zapamatuje (než se mu otevře formulář pro editaci MR), na jaké místo chce pozici MR nastavit.</p><p>Pro komplikovanější případy navrhujeme, aby měl uživatel možnost měnit pozici modálního okna. V případě potřeby okno chytne a posune do krajní části obrazovky. Uvidí tak jak formulář pro editaci MR, tak mapu s realizací denního výkonu.</p><p>Poznámka: Nastavená pozice okna nebude ukládána do uživatelského nastavení. Uvedená funkčnost by pak měla být aplikována obecně na úrovni celého systému.</p><h1>Aktualizace denních výkonu dle vozového parku</h1><p> Čeká na vyjádření zákazníka.</p><p>V případě, kdy dojde k přidání nového, nebo odebrání stávajícího vozidla, je nutné provést aktualizaci již vytvořených denních výkonů:</p><ul><li>Pro přidaná vozidla je potřeba vytvořit nové denní výkony, a to pro takové dny realizace, pro které již existují denní výkony, a zároveň se jedná o datum, které není v minulosti.</li><li>Pro odebraná vozidla je potřeba zrušit/odebrat existující denní výkony, a to pro takové dny realizace, které nejsou v minulosti.</li></ul><h2>Aktuální stav</h2><p>Nyní je možné dosáhnout aktualizace 2 způsoby:</p><ol><li>Ručně – uživatel začíná na určitý den plánovat objednané služby, ale zjistí, že některé z vozidel chybí/přebývá. Spustí tedy uvedenou akci ručně. Po stisknutí tlačítka dojde k aktualizaci denních výkonů pro daný den, typ dopravy a provozovnu.</li><li>Automaticky – systém každý den kolem půlnoci provede revizi, zda neexistují denní výkony pro již neaktivní vozidla, případně zda pro některá vozidla denní výkony nechybí. Aktualizace se pak provede na úrovni celého nasazení systému, a to 14 dní dopředu od dnešního data.</li></ol><p>Dle nalezených nesrovnalostí jsou provedeny odpovídající akce:</p><ul><li>Chybějící denní výkon – systém vytvoří pro nově přidané vozidlo denní výkon na všechna data realizace v budoucnosti, pro které existují denní výkony.</li><li>Přebývající denní výkon – systém provede zrušení denního výkonu pro neaktivní vozidlo. Denní výkon je pak nastaven do stavu Zrušený, obdobně jako je tomu u kontroly neschválených denních výkonů na konci dne realizace. Objednané služby, které mohou být vloženy na takovém denním výkonu, jsou z denního výkonu odebrány – je možné je opětovné naplánovat na jiné vozidlo.</li></ul><p>Na zrušené denní výkony pak sice není možné plánovat objednané služby, ale zároveň nejsou nijak zvýrazněny, což může být pro uživatele matoucí.</p><h2>Navrhované chování</h2><p>Jako řešení navrhujeme dále uvedený postup, který je složen ze 2 kroků. První zajistí rychlé napravení problému, druhý pak doplní užitečné chování, které zpříjemní uživateli práci.</p><p>Poznámka: V případě nízké pracnosti je možné oba kroky sloučit do jednoho.</p><table><tbody><tr><th>Krok</th><th>Popis</th><th>Poznámka</th></tr><tr><td>1</td><td><p>Automatická kontrola nebude omezena pevně daným obdobím, dojde ke kontrole všech denních výkonů vyskytujících se v budoucnosti. Budou tak ošetřeny i takové případy, kdy uživatel omylem zobrazí obrazovku pro plánování denních výkonů (M4) např. pro další měsíc (pro daný den jsou vygenerovány denní výkony). </p><p>Pokud uživatel spustí ruční aktualizaci denních výkonů, bude provedena stejná akce jako u automatické aktualizace (viz aktualizované chování dříve) – kontrola tedy bude provedena na úrovni celého nasazení systému, ne pouze na jeho podmnožině. To zajistí doplnění/zrušení denních výkonů pro celé období, ne pouze aktuálně zobrazený den.</p><p>Následně by byly zrušené denní výkony na obrazovce plánování (M4) graficky zvýrazněny ikonou.</p></td><td><p>Je potřeba prověřit, jak dlouho může taková aktualizace dat trvat. Neměla by způsobit „zamrznutí systému“.</p><p>První krok tedy nebude rozlišovat, jakým způsobem byl denní výkon zrušen.</p></td></tr><tr><td>2</td><td><p>Následně by bylo rozlišeno, jakým způsobem byl denní výkon zrušen – zde nabízíme 2 možné přístupy:</p><ol><li>Denní výkony rušené v rámci tohoto chování budou mazány. Nebudou tedy nadále k dispozici.</li><li>Denní výkony budou rušeny, bude ale doplněn nový stav denního výkonu, např. „Zrušen z důvodu deaktivace vozidla“. Takové denní výkony se nebudou nikde v rámci systému zobrazovat. Tedy ani na obrazovce pro plánování (M4).</li></ol></td><td>Ukládání takových denních výkonů asi není potřeba.</td></tr></tbody></table>
</div>
</body>
</html>
