<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>706UC02: Získat souřadnice dle adresy</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je získání souřadnic pro na vstupu získanou adresu. K tomu je použita služba 3. strany.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Synchronizační komponenta</td><td colspan="1">–</td></tr><tr><td colspan="1">FLWW2</td><td colspan="1">Poskytuje službu pro geokódování.</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="../../../../high-level-concept/akteri-78680673.html">Aktéři</a>.</p><h1>Spuštění případu užití</h1><p>Synchronizační komponenta zadá požadavek na získání souřadnic z adresy, a to jedním z uvedených způsobů:</p><ul><li>Synchronizační komponenta zadá požadavek na získání souřadnic při synchronizaci likvidačních míst (viz <a href="#" data-page-title="605UC02: Získat likvidační místa"></a>).</li><li>Synchronizační komponenta zadá požadavek na získání souřadnic při synchronizaci jízd (viz <a href="#" data-page-title="605UC03: Získat jízdy">605UC03: Získat jízdy</a>).</li></ul><h2>Vstupní podmínky</h2><p>–</p><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Adresa</td><td colspan="1"><a href="../../../../datove-modely/datovy-78681044.html">Adresa</a></td><td colspan="1">Ano</td><td colspan="1">Adresa, pro kterou mají být souřadnice získány.</td><td colspan="1">–</td></tr><tr><td colspan="1">Počet záznamů</td><td colspan="1">Celé kladné číslo</td><td colspan="1">Ano</td><td colspan="1">Maximální počet záznamů, který má být vrácen.</td><td colspan="1">–</td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Systém odešle dotaz na mapovou službu v předepsané struktuře (viz <a href="706uc02-117211324.html">ALG01: Volání mapové služby</a>).</li><li>Mapová služba vrátí množinu záznamů, které odpovídají zadaným parametrům.</li><li>Systém předá získaná data na výstupu UC, a to v předepsané struktuře (viz <a href="706uc02-117211324.html">ALG02: Předání odpovědi mapové služby na výstup</a>).</li></ol><h1>Alternativní toky událostí</h1><h2>AF01: Nebyly nalezeny žádné souřadnice</h2><h3>Vstupní podmínky</h3><ul><li>Mapová služba ve své odpovědi nevrátila žádný záznam (volání však neskončilo chybovým hlášením).</li></ul><h3>Tok událostí</h3><ol><li>Alternativní tok událostí začíná krokem 2 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení (MSG_INFO_COORDINATES_NOT_FOUND, viz <a href="../../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Návrat na krok 3 základního toku událostí (je předána prázdná kolekce).</li></ol><h3>Výstupní podmínky</h3><ul><li>Na výstupu UC byla předána prázdná kolekce souřadnic. Doplněno je i chybové hlášení.</li></ul><h1>Výjimkové toky událostí</h1><h2>EF01: Mapová služba není k dispozici</h2><h3>Vstupní podmínky</h3><ul><li>Mapová služba není k dispozici.</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení (MSG_ERR_MAP_SERVICE_NOT_AVAILABLE, viz <a href="../../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Na výstupu UC nebyla předána kolekce souřadnic. Předáno je pouze chybové hlášení.</li></ul><h2>EF02: Volání mapové služby skončilo chybou</h2><h3>Vstupní podmínky</h3><ul><li>Volání mapové služby skončilo chybou.</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení:<br><ul><li>Kód systémového hlášení: MSG_ERR_MAP_SERVICE_RESPONSE_ERROR (viz <a href="../../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Chybové hlášení: chybové hlášení vrácené mapovou službou.</li></ul></li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Na výstupu UC nebyla předána kolekce souřadnic. Předáno je pouze chybové hlášení.</li></ul><h2>EF03: Výstupní data mapové služby nejsou v pořádku</h2><h3>Vstupní podmínky</h3><ul><li>Hodnoty vrácené mapovou službou nejsou v pořádku (např. nebyla dodána očekávaná hodnota, byl překročen povolený rozsah, povinnost zadání, jedinečnost záznamu a podobně).</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 2 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení s uvedenými parametry (viz <a href="../../../../systemove-78681299.html">Systémové hlášky</a>):<br><ul><li>chybové hlášení: TODO,</li><li>název vstupního parametru: TODO název odpovídajícího vstupního parametru,</li><li>hodnota vstupního parametru: TODO hodnota odpovídajícího vstupního parametru.</li></ul></li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Na výstupu UC nebyla předána kolekce souřadnic. Předáno je pouze chybové hlášení.</li></ul><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Na výstupu byla předána kolekce souřadnic, které odpovídají vstupním parametrům případu užití (může se jednat také o prázdnou kolekci).</p><h2>Výstupní data</h2><table><tbody><tr><th>Výstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1"><p>Souřadnice – jedná se o dvojici těchto atributů:</p><ul><li>Zeměpisná délka</li><li>Zeměpisná šířka</li></ul></td><td colspan="1">Desetinné číslo</td><td colspan="1">Ne</td><td colspan="1">Kolekce nalezených souřadnic, které odpovídají hledané adrese.</td><td colspan="1">–</td></tr><tr><td colspan="1">Chybové hlášení</td><td colspan="1">–</td><td colspan="1">Ne</td><td colspan="1">V podstatě se jedná o kód chyby, kvůli které mapová služba nevrátila požadované záznamy.</td><td colspan="1">Informace je předána pouze v případě, kdy nebyly splněny výstupní podmínky tohoto UC.</td></tr></tbody></table><h1>Algoritmy</h1><h2>ALG01: Volání mapové služby</h2><p>Dotazování mapové služby probíhá přes <strong>FLWW2 API</strong>, kdy je volána funkce <strong>Geocoding</strong> (viz <a href="https://confluence.radium.cz/display/FLWW2/flw-geo-service">flw-geo-service</a>, <a href="https://f7-test3-vm.esledovani.cz/rc/FleetwareWebAPI/help/index#/Geocoding">Swagger</a>). Na vstupu předané parametry jsou popsány v tabulce.</p><table><tbody><tr><th>Parametr</div></div></th><th>Hodnota</div></div></th><th colspan="1">Stručný popis</div></div></th><th>Poznámka</div></div></th></tr><tr><td>func</td><td>search_text</td><td colspan="1">Požadována funkce, která má být v rámci volání použita.</td><td>Bližší popis funkce je uveden samostatně, viz <a href="https://confluence.radium.cz/display/FLWW2/flw-geo-service#flw-geo-service-Search_text">Search_text</a>.</td></tr><tr><td>cinput</td><td>–</td><td colspan="1">Formát, ve kterém jsou na vstup předány souřadnice (dotaz).</td><td>–</td></tr><tr><td>coutput</td><td>WGS84</td><td colspan="1">Formát, ve kterém jsou na výstupu předány souřadnice (odpověď).</td><td>–</td></tr><tr><td>text</td><td><p>Na vstupu získaná <a href="../../../../datove-modely/datovy-78681044.html">Adresa</a> (vstupní parametr <strong>Adresa</strong>) ve formě textového řetězce:</p><ul><li>Formát: <strong><Ulice>;<Číslo popisné>;<Číslo orientační>;<Město></strong></li><li>Příklad: <strong>Palackého;29;;Trenčín</strong></li></ul><p>Uvedené položky odpovídají atributům entity <a href="../../../../datove-modely/datovy-78681044.html">Adresa</a>.</p></td><td colspan="1">Text představující hledanou adresu.</td><td>–</td></tr><tr><td>coord</td><td>–</td><td colspan="1">Souřadnice, pro které má být nalezena adresa.</td><td>–</td></tr><tr><td>max_count</td><td>Hodnota vstupního parametru <strong>Počet záznamů</strong>.</td><td colspan="1">Maximálně počet záznamu, který může být v rámci odpovědi vrácen.</td><td>–</td></tr><tr><td colspan="1">gopt_country</td><td colspan="1">Hodnota konfiguračního parametru <strong>geocodeCountry</strong> (viz <a href="https://confluence.radium.cz/pages/viewpage.action?pageId=88033346">Konfigurační parametry</a>).</td><td colspan="1">Omezení algoritmu dle zvolené země.</td><td colspan="1">–</td></tr></tbody></table><h2>ALG02: Předání odpovědi mapové služby na výstup</h2><p>Algoritmus slouží k transformaci adresných bodů vrácených mapovou službou (viz <a href="706uc02-117211324.html">ALG01: Volání mapové služby</a>) do struktury, která je čitelná systémem. Na vstupu je tedy získána množina adresných bodů ve formátu daném mapovou službou, na výstupu získáme množinu hledaných souřadnice (dvojice atributů <strong>Zeměpisná šířka</strong> a <strong>Zeměpisná délka</strong>). </p><table><tbody><tr><th>Vstupní parametr (mapová služba)</div></div></th><th>Atribut řešené struktury</div></div></th><th>Validace vstupního parametru</div></div></th><th>Získání hodnoty ze vstupního parametru</div></div></th><th>Poznámka</div></div></th></tr><tr><td colspan="1">x</td><td colspan="1">Zeměpisná šířka</td><td colspan="1">–</td><td colspan="1"><ul><li>Převzata hodnota získaná na vstupu.</li></ul></td><td colspan="1">–</td></tr><tr><td colspan="1">y</td><td colspan="1">Zeměpisná délka</td><td colspan="1">–</td><td colspan="1"><ul><li>Převzata hodnota získaná na vstupu.</li></ul></td><td colspan="1">–</td></tr></tbody></table><p>Pro každý adresný bod tedy vzniká struktura obsahující obě souřadnice tohoto bodu. Jejich výsledná množina je předána na výstupu UC (výstupní parametr <strong>Souřadnice</strong>).</p><h1>Validace</h1><p>–</p><h1>Uživatelské rozhraní</h1><p>–</p><h1>Grafický návrh</h1><p>–</p><h1>Revize</h1><p>–</p>
</div>
</body>
</html>
