<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>200UC02: Upravit denní výkon</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl UC</h1><p>Cílem UC je editace <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th>Popis</th><th colspan="1">Typická role</th></tr><tr><td>Uživatel</td><td><p>Jedná se o uživatele aplikace RoadPlan, který musí mít oprávnění spouštět tento UC.</p></td><td colspan="1"><p> </p></td></tr></tbody></table><h1>Spuštění případu užití</h1><p>Uživatel zadá požadavek k editaci Denního výkonu jedním z těchto způsobů:</p><ul><li>Editace Denního výkonu z přehledu Denních výkonů na obrazovce pro plánování Denních výkonů (viz <a href="#" data-page-title="206UC04: Zobrazit panel přehledu denních výkonů"></a>).<br></li><li>Editace Denního výkonu z obrazovky monitoringu realizace Denních výkonů (viz <a href="#" data-page-title="300UI01: Obrazovka pro monitoring realizace denních výkonů"></a>).</li><li>Editace Denního výkonu z přehledu Denních výkonů (viz <a href="#" data-page-title="200UI03: Obrazovka přehledu denních výkonů"></a>).</li></ul><h1>Vstupní podmínky</h1><p>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na moduly a UC</a>:</p><ul><li>Plánování denních výkonů.</li></ul><p>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na typ entit</a>:</p><ul><li>Denní výkony - zobrazení a modifikace,</li><li>Objednané služby - zobrazení a modifikace.</li></ul><h3>Vstupní data</h3><ul><li>Entita <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>.</li></ul><h1>Základní tok událostí</h1><ol><li>Systém vytvoří kopii <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> získaného na vstupu UC z následujících důvodů:<br><ol><li>Pro zachování původního stavu <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> v případě zrušení provedených změn – viz <a href="200uc02-83266876.html">EF01: Storno</a>.</li><li>Pro načtení původního stavu <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> v rámci editace (bez opuštění formuláře) – viz <a href="#" data-page-title="200UC40: Načíst uložený průběh editace denního výkonu"></a>.</li><li>Pro uložení původního <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> v případě, kdy je <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> schválen a následně je nutné jej dále editovat (je nutné zachovat původní schválený plán pro další vyhodnocení, např. operativní změny v den realizace) – viz krok 6 základního toku událostí.</li></ol></li><li>Systém zobrazí formulář <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> a provede jeho nastavení dle vytvořené kopie <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> dle <a href="#" data-page-title="200UI02: Formulář denního výkonu"></a>.</li><li>Uživatel provede požadovaná nastavení <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</li><li>Uživatel stiskne tlačítko Uložit.</li><li>Systém provede validaci vstupních údajů.</li><li>Pokud je editovaný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> ve stavu Plněný (atribut Stav):<br><ol><li>Systém aktualizuje hodnotu atributu Schválený denní výkon – vloží do něj <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> ve stavu, kdy byl volán tento UC.</li></ol></li><li>Systém uloží provedené změny <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</li><li>Systém se vrátí zpět do části aplikace, kde došlo k požadavku na editaci <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</li></ol><p>Poznámka:</p><ul><li>Možnost editace v rámci formuláře je uvedena samostatně v popisu jeho UI – formulář je tedy možné zobrazit i pro takové <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>, které není možné editovat, a to v režimu pro čtení.</li><li>Pokud byly v rámci editace odebrány <a href="../../../datove-modely/datovy-78681044.html">Položky denního výkonu</a> typu Objednaná služba, je po uložení změn nutné zajistit, aby byly odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> zpřístupněny pro další vkládání do jiných <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a>. Uvedené odebrání z <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> musí totiž být skutečně provedeno až po uložení <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>, ne v průběhu jeho editace (může dojít ke stornu provedených změn).</li></ul><h1>Alternativní toky událostí</h1><h3>AF01: Údaje ve formuláři nejsou validní</h3><h4>Vstupní podmínky</h4><ul><li>Údaje ve formuláři nejsou validní – viz <a href="200uc02-83266876.html">Validace</a>.</li></ul><h4>Tok události</h4><ol><li>Alternativní tok událostí začíná krokem 4 základního toku událostí.</li><li>Systém zvýrazní ovládací prvky, které neobsahují validní hodnotu.</li><li>Systém zobrazí uživateli informaci, že některé ze zadaných údajů nejsou validní (TODO: kód hlášky, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>). <strong>Návrat na krok 2 základního toku událostí</strong>.</li></ol><h3>AF02: Schválení denního výkonu</h3><h4>Vstupní podmínky</h4><ul><li>Uživatel stiskne tlačítko Uložit a schválit.</li></ul><h4>Tok událostí</h4><ol><li>Alternativní tok událostí začíná krokem 3 základního toku událostí.</li><li>Systém nastaví hodnotu atributu Stav editovaného <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> na Schválený – spustí <a href="#" data-page-title="200UC37: Schválit denní výkon">200UC37: Schválit denní výkon</a>, na vstup UC jsou předány následující hodnoty:<br><ul><li>Denní výkon: <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> editovaný v rámci tohoto UC.</li></ul></li><li><strong>Návrat na krok 4 základního toku událostí</strong>.</li></ol><p>Poznámka: V rámci volání UC pro schválení <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> není kontrolováno, zda je odpovídající <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> právě editován – v takovém případě by nebylo možné jeho uložení a schválení provést zároveň.</p><h3>AF03: Plněný denní výkon</h3><p>Pokud je <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> právě realizován, je nutné po provedení změny zpětně vyhodnotit jeho realizaci.</p><h4>Vstupní podmínky</h4><p><a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> získaný na vstupu UC je v jednom z dále uvedených stavů:</p><ul><li>Plněný.</li></ul><h4>Tok událostí</h4><ol><li>Alternativní tok začíná krokem 7 základního toku událostí.</li><li>Systém provede vyhodnocení realizace pro nový plán – spustí <a href="#" data-page-title="300UC10: Vyhodnotit realizaci denního výkonu">300UC10: Vyhodnotit realizaci denního výkonu</a>, na vstupu UC jsou předány následující hodnoty:<br><ol><li>Denní výkon: <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> získaný na vstupu UC.</li></ol></li></ol><h3>AF04: Provést aktualizaci trasy</h3><p>Pokud je na <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> přihlášeno zařízení (FOB), musí dojít k aktualizaci trasy a odeslání notifikace o této skutečnosti na přihlášené zařízení.</p><h4>Vstupní podmínky</h4><ul><li>Jsou splněny vstupní podmínky v rámci <a href="#" data-page-title="205UC08: Provést aktualizaci trasy denního výkonu">205UC08: Provést aktualizaci trasy denního výkonu</a> (pro odpovídající <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>). </li></ul><h4>Tok událostí</h4><ol><li>Alternativní tok začíná krokem 7 základního toku událostí.</li><li>Systém provede aktualizaci odpovídající trasy – spustí <a href="#" data-page-title="205UC08: Provést aktualizaci trasy denního výkonu">205UC08: Provést aktualizaci trasy denního výkonu</a>, na vstupu UC jsou předány následující hodnoty:<br><ul><li>Denní výkon: na vstupu získaný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>.</li></ul></li></ol><h4>Výstupní podmínky</h4><ul><li>Došlo k aktualizaci trasy odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> a odeslání notifikace na přihlášené zařízení (pokud jsou splněny další podmínky).</li></ul><h1>Výjimkové toky událostí</h1><h3>EF01: Storno</h3><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí může začít kdykoliv v rámci kroku 2 základního toku událostí.</li><li>Pokud uživatel stiskne tlačítko Storno.<br><ol><li>Pokud byla v rámci formuláře provedena alespoň jedna změna:<br><ol><li>Systém zobrazí modální okno s dotazem, zda si uživatel opravdu přeje zahodit provedené změny (MSG_CONF_CANCEL_EDIT_DAILY_ROUTE, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Pokud si uživatel nepřeje zahodit provedené změny – stiskne tlačítko Ne:<br><ol><li>Systém zavře modální okno. <strong>Návrat na krok 2 základního toku událostí</strong>.</li></ol></li><li>Systém zavře modální okno.<br></li></ol></li><li>Systém se vrátí zpět do části aplikace, kde došlo k požadavku na editaci <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>. <strong>Konec toku událostí</strong>.</li></ol></li><li>Pokud uživatel opustí formulář <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.<br><ol><li><strong>Konec toku událostí</strong>.</li></ol></li></ol><h4>Výstupní podmínky</h4><ul><li>Nebyly uloženy změny provedené v <a href="../../../datove-modely/datovy-78681044.html">Denním výkonu</a>.</li></ul><h3>EF02: Denní výkon je editován jiným uživatelem</h3><h4>Vstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> je editován jiným uživatelem.</li></ul><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s chybovým hlášením, že <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> nemůže být editován, protože ho právě edituje někdo jiný (MSG_INFO_UNAVAILABLE_EDIT_DAILY_ROUTE, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel stiskne tlačítko OK.</li><li>Systém se vrátí zpět do části aplikace, kde došlo k požadavku na editaci <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>. <strong>Konec toku událostí</strong>.</li></ol><h4>Výstupní podmínky</h4><ul><li>Nebyl zobrazen formulář pro editaci <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</li></ul><h3>EF03: Denní výkon nemůže být uložen</h3><h4>Vstupní podmínky</h4><ul><li>Není možné uložit změny provedené v rámci <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>, a to z dále uvedených důvodů:<br><ul><li>Pro jednu <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> existuje více než jedna přímo navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> (navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> vzniká při rozdělení či vytvoření MDU).</li><li>Pro <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a>, která byla rozdělena, nebo z které vzniklo MDU, neexistuje žádná navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.</li><li>V rámci <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, která byla rozdělena, nebo z které vzniklo MDU, není obsažena žádná <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>.</li></ul></li></ul><p>Poznámka:</p><ul><li>Výjimkový tok vznikl v reakci na chybu, která byla získána v rámci testování. Vstupní podmínky tedy mohou být dále rozšiřovány.</li><li>Vstupní podmínky byly upraveny dle potřeb násobného dělení <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>. Stále se pak jedná o „zachycení“ chybových stavů.</li></ul><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 7 základního toku událostí.<br><ol><li>Systém zobrazí modální okno s chybovým hlášením, že není možné uložit <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> (MSG_ERR_DAILY_ROUTE_SAVE_NOT_POSSIBLE, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li></ol></li><li>Uživatel stiskne tlačítko OK.</li><li>Systém zavře modální okno.</li><li>Systém se vrátí zpět do části aplikace, kde došlo k požadavku na editaci <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>. <strong>Konec toku událostí</strong>.</li></ol><h4>Výstupní podmínky</h4><ul><li>Nebyly uloženy změny provedené v <a href="../../../datove-modely/datovy-78681044.html">Denním výkonu</a>.</li></ul><h1>Výstupní podmínky</h1><ul><li>Byly uloženy změny provedené v <a href="../../../datove-modely/datovy-78681044.html">Denním výkonu</a>.</li></ul><h1>Validace</h1><p>Validace je prováděna průběžně, pokud uživatel vstoupí do pole s možností zadání hodnoty, zadá hodnotu a pole opustí ve stavu, kdy hodnota není validní, je na to upozorněn. Ovládací prvek je graficky zvýrazněn a je doplněno chybové hlášení. Konkrétní validace jednotlivých polí jsou uvedeny v <a href="#" data-page-title="200UI02: Formulář denního výkonu"></a>. Hlídána jsou jak konkrétní validační kritéria každé položky, tak i to, zda je položka povinná.</p><p>Jakmile uživatel stiskne tlačítko Uložit, je provedena validace všech polí.</p><p>Pokud jsou všechny údaje v pořádku, je <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> uložen. Pokud ne, jsou chybně vyplněná pole zvýrazněna a doplněna o chybové hlášení. Uživateli je navíc zobrazeno chybové hlášení, že <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> nemůže být uložen.</p><h1>Algoritmy</h1><p>Nejsou.</p><h1>Uživatelské rozhraní</h1><p>Rozložení formuláře je uvedeno v samostatném dokumentu – viz <a href="#" data-page-title="200UI02: Formulář denního výkonu"></a>.</p><h1>Revize</h1><h3>16. 6. 2023: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc02-83266876.html">Vstupní podmínky</a></td><td colspan="1">Odebrána poznámka o dostupnosti formuláře denního výkonu (naznačeno modře).</td></tr></tbody></table><h3>23. 10. 2021: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc02-83266876.html">AF04: Provést aktualizaci trasy</a></td><td colspan="1">Doplnění aktualizace trasy odpovídajícího denního výkonu (naznačeno růžově).</td></tr></tbody></table><h3>27. 3. 2021: Tomáš Nadrchal</h3><p>Provedeny změny v rámci celého dokumentu (naznačeno modře). Viz <a href="../../../rp-sprava-pozadavku/id-89065686.html">ID-040: Násobné rozdělení objednané služby</a>.</p><h3>8. 10. 2019: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc02-83266876.html">AF03: Plněný denní výkon</a></td><td colspan="1">Doplněn alternativní tok událostí pro případ, kdy je <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> ve stavu Plněný.</td></tr></tbody></table><h3>3. 10. 2019: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc02-83266876.html">EF01: Storno</a></td><td colspan="1">Doplněn dotaz, zda mají být zrušeny provedené změny (naznačeno modře).</td></tr><tr><td colspan="1"><a href="200uc02-83266876.html">EF03: Denní výkon nemůže být uložen</a></td><td colspan="1">Doplněn výjimkový tok, který vznikl v reakci na chybu, která byla získána v rámci testování.</td></tr></tbody></table><h3>19. 3. 2019: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"></td><td colspan="1">Doplněno dříve domluveného chování, které bylo rozšířeno dle aktuálních požadavků.</td></tr></tbody></table><p><br></p>
</div>
</body>
</html>
