<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>200UC54: Přegenerovat denní výkony</title>
</head>
<body>
<div class="wiki-content">
<p><strong>Nahrazeno (viz <a href="#" data-page-title="202UC07: Generovat denní výkony pro plánované období">202UC07: Generovat denní výkony pro plánované období</a>)!</strong></p><p></p><h1>Stručný popis, cíl UC</h1><p>Cílem UC je pro zadaný <strong>den </strong>zajistit existenci právě jednoho Denního výkonu pro každé Vozidlo daného <strong>Typu dopravy</strong>, které patří pod danou <strong>Provozovnu</strong>. V rámci tohoto procesu může dojít jak ke vzniku nových Denních výkonů, tak ke zrušení těch již existujících.</p><p>Proces je spouštěn jednak automaticky, generování probíhá na daný počet dní dopředu a pouze v určených dnech v týdnu. Kromě toho může přegenerování pro vybraný den, Provozovnu a Typ dopravy kdykoli spustit oprávněný uživatel z <a href="#" data-page-title="202UC01: Zobrazit obrazovku plánování">202UC01: Zobrazit obrazovku plánování</a>.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th>Popis</th><th colspan="1">Typická role</th></tr><tr><td colspan="1">Čas</td><td colspan="1">Komponenta systému RoadPlan, která dle nastavených parametrů spouští v požadovaném čase danou úlohu.</td><td colspan="1">–</td></tr><tr><td>Uživatel</td><td><p>Jedná se o uživatele aplikace RoadPlan, který musí mít oprávnění spouštět tento UC.</p></td><td colspan="1"><p>Dispečer</p></td></tr></tbody></table><h1>Spuštění případu užití</h1><p>Případ užití je spouštěn automaticky systémem v předem určených časech, může být ale vyvolán i na základě uživatelské akce.</p><h3>Při spuštění systémem: </h3><ul><li>Případ užití je spouštěn v pravidelném čase dle <em>generateDailyRoutesSchedule</em> (viz <a href="#" data-page-title="Konfigurační hodnoty"></a>). </li><li>Pokračovat na Základní tok událostí.</li></ul><h3>Při spuštění uživatelem: </h3><ul><li>Případ užití může být spuštěn v rámci <a href="#" data-page-title="202UC01: Zobrazit obrazovku plánování">202UC01: Zobrazit obrazovku plánování</a>, tedy obrazovky <a href="#" data-page-title="200UI01: Obrazovka pro plánování denních výkonů"></a>.</li><li>Pokračovat na AF01: Přegenerování spuštěno uživatelem.</li></ul><h1>Vstupní podmínky</h1><h3>Při spuštění systémem:</h3><ul><li>Nejsou vyžadovány.</li></ul><h5>Vstupní data</h5><ul><li>Aktuální datum,</li><li>kolekce všech Provozoven,</li><li>kolekce všech podporovaných typů dopravy,</li><li>konfigurační hodnota <em>generateDailyRoutesHorizon</em> (viz <a href="#" data-page-title="Konfigurační hodnoty"></a>),</li><li>konfigurační hodnota <em>generateDailyRoutesDaysOfWeek</em> (viz <a href="#" data-page-title="Konfigurační hodnoty"></a>).</li></ul><h3>Při spuštění uživatelem:</h3><ul><li>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na moduly a UC</a>:<br><ul><li>Plánování denních výkonů .</li></ul></li><li>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na typ entit</a>:<br><ul><li>Denní výkony - zobrazení a modifikace.</li></ul></li></ul><h5>Vstupní data</h5><ul><li>Datum realizace,</li><li><a href="../../../datove-modely/datovy-78681044.html">Provozovna</a>,</li><li><a href="../../../datove-modely/datovy-78681044.html">Typ dopravy</a>.</li></ul><h1>Základní tok událostí</h1><p>Systém jednotlivě provede níže uvedený tok událostí:</p><ul><li>pro každou Provozovnu <em>P</em>,<br><ul><li>každý podporovaný Typ dopravy <em>TD</em>,<br><ul><li>každý jednotlivý datum <em>D</em> z intervalu <Aktuální den; Aktuální den + hodnota <em>generateDailyRoutesHorizon</em>), pokud odpovídá dnu v týdnu zadaném v parametru <em>generateDailyRoutesDaysOfWeek</em>.</li></ul></li></ul></li></ul><ol><li>Systém načte všechna aktivní <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a>, která zároveň splňují níže uvedené podmínky:<br><ul><li>Atribut Provozovna: odpovídá právě zpracovávané <a href="../../../datove-modely/datovy-78681044.html">Provozovně</a> <em>P</em>.</li><li>Atribut Typ dopravy: odpovídá právě zpracovávanému <a href="../../../datove-modely/datovy-78681044.html">Typu dopravy</a> <em>TD</em>.</li></ul></li><li>Takto získaná <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a> systém uchová jako kolekci <em>A</em> (Aktuální vozidla).</li><li>Systém načte všechny <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>, které zároveň splňují níže uvedené podmínky:<br><ul><li>Atribut Provozovna: odpovídá právě zpracovávané <a href="../../../datove-modely/datovy-78681044.html">Provozovně</a> <em>P</em>.</li><li>Atribut Typ dopravy: odpovídá právě zpracovávanému <a href="../../../datove-modely/datovy-78681044.html">Typu dopravy</a> <em>TD</em>.</li><li>Atribut Datum realizace: odpovídá právě zpracovávanému datu <em>D</em>.</li></ul></li><li>Systém z takto získaných <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> zjistí jejich <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a> (atribut Vozidlo entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>) a uchová je v kolekci <em>E</em> (vozidla z Existujících denních výkonů).</li><li>Systém obě kolekce <em>A</em>, <em>E</em> porovná a na základě výsledku porovnání provede tyto kroky:<br><ol><li>[Vytvoření chybějících Denních výkonů] Pokud má na vstupu UC získaná <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> vyplněny souřadnice (hodnota atributu Souřadnice je různá od NULL):<br><ol><li>Pro <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a>, která se nacházejí pouze v kolekci <em>A</em>, systém vytvoří nové <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>. K tomuto účelu pro každé takové <a href="../../../datove-modely/datovy-78681044.html">Vozidlo</a> spustí případ užití <a href="#" data-page-title="200UC01: Přidat denní výkon"></a> s následujícími vstupními parametry:</li></ol><br><ul><li><ul><li>Provozovna: <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> <em>P</em>.</li><li>Typ dopravy: <a href="../../../datove-modely/datovy-78681044.html">Typ dopravy</a> <em>TD</em>.</li><li>Datum realizace: Datum <em>D</em>.</li><li>Vozidlo: <a href="../../../datove-modely/datovy-78681044.html">Vozidlo</a>, pro které je právě vytvářen <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>.</li><li>Atribut Vytvořen uživatelem = False.</li></ul></li></ul></li><li>[Zrušení přebývajících Denních výkonů] Pro <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a>, která se nacházejí pouze v kolekci <em>E</em>, systém zruší (dle ALG01: Zrušit denní výkon; vstupní parametr Jen prázdné = True) jejich existující <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> plánované na den <em>D, </em>provozovnu <em>P </em>a typ dopravy<em> TD</em> v případě, že příslušný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> současně splňuje tyto podmínky:<br><ol><li>nebyl vytvořen uživatelsky (atribut Vytvořen uživatelem = False),</li><li>jeho stav je Plánovaný,</li><li>nejsou na něho plánované žádné <a href="../../../datove-modely/datovy-78681044.html">Položky denního výkonu</a> (atribut Položky denního výkonu entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> je Null).</li></ol></li><li>[Nastavení příznaku o vytvoření Denního výkonu] Pro <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> těch <a href="../../../datove-modely/datovy-78681044.html">Vozidel</a>, která se nacházejí v obou kolekcích (některé <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> přidané uživatelem již mohou splňovat kritéria pro automatické generování) dojde ke kontrole, zda jsou všechny takové <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> výkony označené jako vytvořené systémem:<br><ol><li>Pro všechny tyto <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>, u kterých je hodnota atributu Vytvořen uživatelem rovna TRUE:<ol><li>Systém nastaví hodnotu atributu Vytvořen uživatelem na FALSE.</li></ol></li></ol></li></ol></li></ol><h1>Alternativní toky událostí</h1><h3>AF01: Přegenerování spuštěno uživatelem</h3><p>Pro na vstupu předanou <a href="../../../datove-modely/datovy-78681044.html">Provozovně</a> <em>P, <a href="../../../datove-modely/datovy-78681044.html">Typ dopravy</a> <em>TD a datum D:</em></em></p><ol><li>Systém načte všechna aktivní <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a>, která zároveň splňují níže uvedené podmínky:<br><ul><li>Atribut Provozovna: odpovídá <a href="../../../datove-modely/datovy-78681044.html">Provozovně</a> <em>P</em>.</li><li>Atribut Typ dopravy: odpovídá <a href="../../../datove-modely/datovy-78681044.html">Typu dopravy</a> <em>TD</em>.</li></ul></li><li>Takto získaná <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a> systém uchová jako kolekci <em>A</em> (Aktuální vozidla).</li><li>Systém načte všechny <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>, které zároveň splňují níže uvedené podmínky:<br><ul><li>Atribut Provozovna: odpovídá <a href="../../../datove-modely/datovy-78681044.html">Provozovně</a> <em>P</em>.</li><li>Atribut Typ dopravy: odpovídá <a href="../../../datove-modely/datovy-78681044.html">Typu dopravy</a> <em>TD</em>.</li><li>Atribut Datum realizace: odpovídá datu <em>D</em>.</li></ul></li><li>Systém z takto získaných <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> zjistí jejich <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a> (atribut Vozidlo entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>) a uchová je v kolekci <em>E</em> (vozidla z Existujících denních výkonů).</li><li>Systém obě kolekce <em>A</em>, <em>E</em> porovná a na základě výsledku porovnání provede tyto kroky:<br><ol><li>[Vytvoření chybějících Denních výkonů] Pokud má na vstupu UC získaná <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> vyplněny souřadnice (hodnota atributu Souřadnice je různá od NULL):<br><ol><li>Pro <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a>, která se nacházejí pouze v kolekci <em>A</em>, systém vytvoří nové <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>. K tomuto účelu pro každé takové <a href="../../../datove-modely/datovy-78681044.html">Vozidlo</a> spustí případ užití <a href="#" data-page-title="200UC01: Přidat denní výkon"></a> s následujícími vstupními parametry:</li></ol><ul><li><ul><li>Provozovna: <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a><em>P</em>.</li><li>Typ dopravy: <a href="../../../datove-modely/datovy-78681044.html">Typ dopravy</a><em>TD</em>.</li><li>Datum realizace: Datum <em>D</em>.</li><li>Vozidlo: <a href="../../../datove-modely/datovy-78681044.html">Vozidlo</a>, pro které je právě vytvářen <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>.</li><li>Atribut Vytvořen uživatelem = False.</li></ul></li><li>Jinak:<br><ol><li>Systém zobrazí modální okno s chybovým hlášením, že není možné vytvořit <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> (MSG_ERR_DAILY_ROUTE_CREATE_ORGANITAZIONAL_UNIT_COORDINATES_NOT_SET, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li></ol></li></ul></li><li>[Zrušení přebývajících Denních výkonů] Pro <a href="../../../datove-modely/datovy-78681044.html">Vozidla</a>, která se nacházejí pouze v kolekci <em>E</em>, se systém pokusí zrušit (dle ALG01: Zrušit denní výkon; vstupní parametr Jen prázdné = False) jejich existující <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> plánované na den <em>D, </em>provozovnu <em>P </em>a typ dopravy<em> TD</em> v případě, že příslušný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> splňuje podmínku:<br><ol><li>nebyl vytvořen uživatelsky (atribut Vytvořen uživatelem = False),</li><li>jeho stav je Plánovaný.</li></ol></li><li>[Nastavení příznaku o vytvoření Denního výkonu] Pro <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> těch <a href="../../../datove-modely/datovy-78681044.html">Vozidel</a>, která se nacházejí v obou kolekcích (některé <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> přidané uživatelem již mohou splňovat kritéria pro automatické generování) dojde ke kontrole, zda jsou všechny takové <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> výkony označené jako vytvořené systémem:<br><ol><li>Pro všechny tyto <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>, u kterých je hodnota atributu Vytvořen uživatelem rovna TRUE:<br><ol><li>Systém nastaví hodnotu atributu Vytvořen uživatelem na FALSE.</li></ol></li></ol></li></ol></li></ol><h1>Výjimkové toky událostí</h1><p>Neuvedeny.</p><h1>Výstupní podmínky</h1><p>Pro na vstupu předané údaje o Provozovně, Typ dopravy a datu je aktualizována množina automaticky vytvářených Denních výkonů tak, že odpovídají aktuálním Vozidlům zařazeným pod danou Provozovnu.   </p><h1>Validace</h1><p>Neuvedeny.</p><h1>Algoritmy</h1><h3>ALG01: Zrušení denních výkonů</h3><p>Algoritmus na vstupu přijímá:</p><ul><li>kolekci <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a>,</li><li>boolean parametr Jen prázdné.</li></ul><ol><li>Pokud je vstupní parametr Jen prázdné = True, pokračovat na krok 3 (s celou kolekcí na vstupu předaných <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a>). </li><li>Pro hodnotu vstupního parametru Jen prázdné = False algoritmus zjistí, na které na vstupu předané <a href="../../../datove-modely/datovy-78681044.html">Denních výkony</a> je plánovaná alespoň jedna <a href="../../../datove-modely/datovy-78681044.html">Položka denního výkonu</a> (atribut Položky denního výkonu entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> je různý od Null):<br><ol><li>Pokud je nalezen alespoň jeden takový <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>, algoritmus zajistí zobrazení dotazu MSG_CONF_CLEAR_DAILY_ROUTES (viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a>), do hlášky předá seznam atributů Textová identifikace vozidla pro <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> nalezené v kroku 1a. <br><ol><li>Když uživatel dotaz odsouhlasí (zvolí možnost Ano), pokračovat na krok 3 (s celou kolekcí na vstupu předaných <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a>).</li><li>Když uživatel dotaz neodsouhlasí (zvolí možnost Ne), odebere systém z na vstupu předané kolekce <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> instance nalezené v kroku 2. Pokračovat krokem 3.</li></ol></li><li>Jinak pokračovat krokem 3 (s celou kolekcí na vstupu předaných <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a>).</li></ol></li><li>Pro všechny <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> v kolekci:<br><ol><li>Pokud je atribut Položky denního výkonu entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> různý od Nul, dojde k vyčištění <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> pomocí volání <a href="#" data-page-title="200UC36: Vyčistit denní výkon"></a>.</li><li>Nastavit atribut Stav na "Zrušený".</li></ol></li></ol><h1>Uživatelské rozhraní</h1><p>Případ užití není vizuální.</p><h1>Revize</h1><h3>4. 12. 2019 Miroslav Slivoně</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc54-88020283.html">Základní tok událostí</a></td><td colspan="1">Z kroku 3 odstraněna podmínky na stav DV = Plánovaný, do kroku 5.b přidána podmínka na stav DV = Plánovaný.</td></tr><tr><td colspan="1"><a href="200uc54-88020283.html">AF01: Přegenerování spuštěno uživatelem</a></td><td colspan="1">Z kroku 3 odstraněna podmínky na stav DV = Plánovaný, do kroku 5.b přidána podmínka na stav DV = Plánovaný.</td></tr></tbody></table><p><br></p><p>18. 11. 2019 Tomáš Nadrchal</p><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc54-88020283.html">Základní tok událostí</a></td><td colspan="1">Doplněno chování pro případ, že <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> nemá nastavené souřadnice, dále doplněna aktualizace příznaku způsobu vytvoření <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> (naznačeno modře).</td></tr><tr><td colspan="1"><a href="200uc54-88020283.html">AF01: Přegenerování spuštěno uživatelem</a></td><td colspan="1">Doplněno chování pro případ, že <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> nemá nastavené souřadnice, dále doplněna aktualizace příznaku způsobu vytvoření <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> (naznačeno modře).</td></tr></tbody></table>
</div>
</body>
</html>
