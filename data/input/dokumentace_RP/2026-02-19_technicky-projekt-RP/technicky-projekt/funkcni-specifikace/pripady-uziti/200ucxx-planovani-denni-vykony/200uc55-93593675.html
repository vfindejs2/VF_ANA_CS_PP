<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>200UC55: Sloučit objednanou službu</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je sloučení nějakým způsobem rozdělené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>. Jedná se se tedy o vrácení akce provedené v rámci uvedených UC:</p><ul><li><a href="#" data-page-title="200UC34: Rozdělit položku denního výkonu"></a>,</li><li><a href="#" data-page-title="200UC17: Vytvořit místo dočasného uložení"></a>.</li></ul><p>Poznámka: Případ užití nahrazuje <a href="#" data-page-title="200UC35: Sloučit rozdělenou objednanou službu"></a> a <a href="#" data-page-title="200UC18: Odebrat místo dočasného uložení"></a>.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Uživatel</td><td colspan="1">–</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Aktéři"></a>.</p><h1>Spuštění případů užití</h1><p>Uživatel zadá požadavek na sloučení objednané služby, a to jedním z uvedených způsobů:</p><ul><li>Uživatel zadá požadavek na sloučení objednané služby v tabulce lokací objednané služby ve formuláři denního výkonu (viz <a href="#" data-page-title="200UI02: Tabulka pro editaci denního výkonu">200UI02: Tabulka pro editaci denního výkonu</a>).</li><li>Uživatel zadá požadavek na sloučení objednané služby v přehledu objednaných služeb na obrazovce plánování denních výkonů (viz <a href="#" data-page-title="200UI01: Přehled objednaných služeb"></a>).</li><li>Uživatel zadá požadavek na sloučení objednané služby v panelu objednaných služeb na obrazovce plánování denních výkonů (viz <a href="#" data-page-title="206UC02: Zobrazit panel přehledu objednaných služeb"></a>).<br></li></ul><h2>Vstupní podmínky</h2><p>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na moduly a UC</a>:</p><ul><li>Plánování denních výkonů.</li></ul><p>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na typ entit</a>:</p><ul><li>Denní výkony - zobrazení a modifikace,</li><li>Objednané služby - zobrazení a modifikace.</li></ul><p>Musí být umožněna editace na vstupu získané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (vstupní parametr Objednaná služba):</p><ul><li>atribut stav je nastaven na hodnotu <strong>K naplánování</strong>, <strong>Naplánovaná</strong> (viz <a href="../../../datove-modely/datovy-78681044.html">Stav objednané služby</a>).</li></ul><p>Sloučení je možné pouze v případě, pokud byla na vstupu získaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> (vstupní parametr Objednaná služba) nějakým způsobem rozdělena (rozdělení, vytvoření MDU). Musí být splněna alespoň jedna z dále uvedených podmínek:</p><ul><li>hodnota atributu Následující objednaná služba je různá od NULL,</li><li>hodnota atributu Předchozí objednaná služba je různá od NULL.</li></ul><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Objednaná služba</td><td colspan="1"><a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a></td><td colspan="1">Ano</td><td colspan="1"><a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>, u které má být provedeno sloučení.</td><td colspan="1">–</td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Systém zobrazí formulář sloučení objednané služby – spustí <a href="#" data-page-title="200UI20: Formulář sloučení objednané služby"></a>, na vstup jsou předány následující informace:<br><ul><li>Objednaná služba: na vstupu získaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> (vstupní parametr Objednaná služba).</li></ul></li><li>Uživatel vyplní formulář.</li><li>Uživatel potvrdí provedené změny.</li><li>Systém provede validaci zadaných údajů.</li><li>Systém sloučí <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> získané na výstupu formuláře sloučení objednané služby (výstupní parametr Objednané služby ke sloučení, viz <a href="#" data-page-title="200UI20: Formulář sloučení objednané služby"></a>) – spustí algoritmus <a href="200uc55-93593675.html">Sloučení objednaných služeb</a>.</li><li>Systém aktualizuje pořadí jednotlivých částí <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> – spustí <a href="../101ucxx-objednane-sluzby/101uc08-105448028.html">101UC08: Aktualizovat pořadí v rámci objednané služby</a>, na vstupu jsou předána následující data:<br><ul><li>Objednaná služba: na vstupu získaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.<br></li></ul></li><li>Pokud je na vstupu získaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> (vstupní parametr Objednaná služba) naplánována na <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> – hodnota atributu Položka denního výkonu je různá od NULL:<br><ol><li>Systém přepočítá trasu odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> – spustí <a href="200uc29-83267154.html">200UC29: Získat trasu denního výkonu</a>, na vstupu jsou předána následující data:<br><ul><li>Denní výkon: atribut Denní výkon entity <a href="../../../datove-modely/datovy-78681044.html">Položka denního výkonu</a> – atribut Položka denního výkonu na vstupu získané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.<br></li></ul></li><li>Pokud je odpovídající <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> ve stavu Plněný (atribut stav):<br><ol><li>Systém přepočítá realizaci odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> – spustí <a href="../300ucxx-monitoring-realizace-dennich-vykonu/300uc10-84840374.html">300UC10: Vyhodnotit realizaci denního výkonu</a>, na vstupu jsou předána následující data:<br><ul><li>Denní výkon: atribut Denní výkon entity <a href="../../../datove-modely/datovy-78681044.html">Položka denního výkonu</a> – atribut Položka denního výkonu na vstupu získané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.<br></li></ul></li></ol></li></ol></li><li>Jinak systém přepočítá trasu této <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> – spustí algoritmus <a href="../101ucxx-objednane-sluzby/101uc01-82116734.html">Získání trasy</a> (viz <a href="#" data-page-title="101UC01: Vygenerovat objednané služby"></a>).</li><li>Systém zavře zobrazený formulář.</li></ol><h1>Alternativní toky události</h1><h3>AF01: Údaje ve formuláři nejsou validní</h3><h4>Vstupní podmínky</h4><ul><li>Údaje ve formuláři nejsou validní (viz <a href="200uc55-93593675.html">Validace</a>).</li></ul><h4>Tok události</h4><ol><li>Alternativní tok událostí začíná krokem 4 základního toku událostí.</li><li>Systém zvýrazní ovládací prvky, které neobsahují validní hodnotu. <strong>Návrat na krok 2 základního toku událostí</strong>.</li></ol><h3>AF02: Provést aktualizaci trasy</h3><p>Pokud je na <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> přihlášeno zařízení (FOB), musí dojít k aktualizaci trasy a odeslání notifikace o této skutečnosti na přihlášené zařízení.</p><h4>Vstupní podmínky</h4><ul><li>Jsou splněny vstupní podmínky v rámci <a href="#" data-page-title="205UC08: Provést aktualizaci trasy denního výkonu">205UC08: Provést aktualizaci trasy denního výkonu</a> (pro odpovídající <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>). </li></ul><h4>Tok událostí</h4><ol><li>Alternativní tok začíná krokem 6.a základního toku událostí.</li><li>Systém provede aktualizaci odpovídající trasy – spustí <a href="#" data-page-title="205UC08: Provést aktualizaci trasy denního výkonu">205UC08: Provést aktualizaci trasy denního výkonu</a>, na vstupu UC jsou předány následující hodnoty:<ul><li>Denní výkon: atribut Denní výkon entity <a href="../../../datove-modely/datovy-78681044.html">Položka denního výkonu</a> – atribut Položka denního výkonu na vstupu získané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li></ul></li></ol><p>Poznámka: Pokud akce nad <a href="../../../datove-modely/datovy-78681044.html">Denním výkonem</a> proběhne v rámci obrazovky editace (viz <a href="#" data-page-title="200UC02: Upravit denní výkon">200UC02: Upravit denní výkon</a>), není provedena aktualizace trasy. K té dochází až po uložení provedených změn, tedy po dokončení odkazovaného UC.</p><h4>Výstupní podmínky</h4><ul><li>Došlo k aktualizaci trasy odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> a odeslání notifikace na přihlášené zařízení (pokud jsou splněny další podmínky).</li></ul><h1>Výjimkové toky událostí</h1><h3>EF01: Storno</h3><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 2 základního toku událostí.</li><li>Pokud uživatel stiskne tlačítko Storno:<br><ol><li>Systém se vrátí zpět do části aplikace, kde došlo k požadavku na sloučení <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>. <strong>Konec toku událostí</strong>.</li></ol></li><li>Pokud uživatel opustí formulář pro sloučení <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>:<br><ol><li><strong>Konec toku událostí</strong>.</li></ol></li></ol><h4>Výstupní podmínky</h4><ul><li>Nedošlo ke sloučení <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, která byla získána na vstupu.</li></ul><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Došlo ke sloučení <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, která byla získána na vstupu.</p><h2>Výstupní data</h2><p>–</p><h1>Algoritmy</h1><h2>Sloučení objednaných služeb</h2><p>Na vstupu algoritmu jsou získány <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, u kterých je požadováno sloučení. Ty pochází z <a href="#" data-page-title="200UI20: Formulář sloučení objednané služby"></a> (výstupní parametr Objednané služby ke sloučení) a jejich struktura je následující:</p><ul><li>Získaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> představuje první z dvojice <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> ke sloučení – při sloučení této <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> tedy využíváme atribut Následující objednaná služba (nikdy není předána v pořadí poslední <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>).</li><li>Získaná kolekce <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> je pak řazena dle pořadí, v jakém na sebe <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> navazují (viz obrázek, <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> ke sloučení zvýrazněny).</li></ul><p><img src="200uc55-sloucit-objednanou-sluzbu-93593675_images/image2021-3-27 15-20-13.png" data-attachment="true"></p><p>Než začneme s popisem chování samotného algoritmu, stručně popíšeme logiku, podlé které bude slučování probíhat. Ta je naznačena i na přiloženém obrázku (<a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> ke sloučení zvýrazněny – vzhledem k aktuálnímu kroku algoritmu).</p><ol><li>Systém vezme v pořadí poslední <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> ze získané kolekce a provede její sloučení s navazující <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> (dle atributu Následující objednaná služba):<br><ol><li>Pokud se jedná o <strong>rozdělení</strong>, přesune obsažené <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> a vazby na navazující <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> do výchozí <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>. Následně je navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> smazána.</li><li>Pokud se jedná o <strong>MDU</strong>, smaže odpovídající <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> typu MDU v obou <a href="../../../datove-modely/datovy-78681044.html">Objednaných službách</a> a pokračuje obdobně jako při <strong>rozdělení</strong>.</li></ol></li><li>Systém pokračuje s další <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a>, která zatím nebyla sloučena (viz krok 1). To probíhá do doby než sloučí všechny <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> získané na vstupu algoritmu (postupuje od poslední <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> k první).</li></ol><p>Poznámka: <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> jsou slučovány „od konce“ z toho důvodu, abychom nemuseli řešit vyhodnocování zbývajících vazeb mezi <a href="../../../datove-modely/datovy-78681044.html">Objednanými službami</a>, u kterých nemá být provedeno sloučení. Tím, že mažeme druhou z dvojice slučovaných <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> (tu navazující), mohlo by se při běžném průchodu „od začátku“ stát, že bychom si smazali <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a>, na kterou se jiná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> stále odkazuje. Díky použití směru „od konce“ tento případ nenastává, a nemusí tak být v rámci algoritmu řešen.</p><p><img src="200uc55-sloucit-objednanou-sluzbu-93593675_images/image2021-3-27 16-1-15.png" data-attachment="true"></p><p>Nyní se dostáváme k samotnému algoritmu. Pro úplnost jsou uvedena vstupní data, která máme v tuto chvíli k dispozici:</p><ul><li>Kolekce <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>, u kterých má být provedeno sloučení (získána na výstupu <a href="#" data-page-title="200UI20: Formulář sloučení objednané služby"></a>, výstupní parametr Objednané služby ke sloučení).</li></ul><p>Pro všechny získané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (v sestupném pořadí) jsou postupně provedeny následující akce:</p><ol><li>Systém v rámci každé iterace pracuje s následujícími <a href="../../../datove-modely/datovy-78681044.html">Objednanými službami</a>:<br><ul><li><strong>Výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> – právě zkoumaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>, u které má být provedeno sloučení.</li><li><strong>Následující</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> – druhá z dvojice <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>, které mají být sloučeny. Získána jako hodnota atributu Následující objednaná služba <strong>výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li><li><strong>Navazuji</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> – navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>, která se vyskytuje bezprostředně za slučovanou dvojicí <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>. Získána jako hodnota atributu Následující objednaná služba <strong>následující</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (může být NULL).</li></ul></li><li>Pokud je k dispozici <strong>navazující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>, je provedena aktualizaci odpovídajících vazeb:<br><ol><li>Systém nastaví hodnoty dále uvedených atributů <strong>výchozí </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>:<br><ul><li>Následující objednaná služba: hodnota atributu Následující objednaná služba <strong>následující</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li><li>Způsob rozdělení následující objednané služby: hodnota atributu Způsob rozdělení následující objednané služby <strong>následující</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li></ul></li><li>Systém nastaví hodnoty dále uvedených atributů <strong>navazující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>:<br><ul><li>Předchozí objednaná služba: <strong>výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.</li><li>Způsob rozdělení předchozí objednané služby: hodnota zachována.</li></ul></li></ol></li><li>Pokud dochází ke sloučení vazby typu Místo časného uložení (atribut Způsob rozdělení následující objednané služby <strong>výchozí </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>):<ol><li>Systém odebere <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> představující MDU ve <strong>výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a>:<ol><li>Systém získá takovou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> ve <strong>výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a> (atribut Lokace objednané služby), která splňuje všechny dále uvedené podmínky zároveň:<br><ul><li><ul><li>atribut Typ lokace nabývá hodnoty Místo dočasného uložení,</li><li>jedná se o v pořadí poslední <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> tohoto typu v uvedené množině.</li></ul></li></ul></li><li>Pokud existuje alespoň  jedna <a href="../../../datove-modely/datovy-78681044.html">Obsluha lokace objednané služby</a>, která se odkazuje na odebíranou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> (viz krok <strong>3.a.i</strong>; atribut <strong>Lokace objednané služby</strong>):<br><ol><li>Systém smaže všechny takové <a href="../../../datove-modely/datovy-78681044.html">Obsluhy lokace objednané služby</a>.</li></ol></li><li>Pokud existuje alespoň jedna <a href="../../../datove-modely/datovy-78681044.html">FOB informace o realizaci lokace objednané služby</a>, která odkazuje na odebíranou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> (viz krok <strong>3.a.i</strong>; atribut <strong>Identifikátor lokace objednané služby</strong>):<br><ol><li>Systém zruší nastavení atributu <strong>Identifikátor lokace objednané služby</strong> v rámci získaných <a href="../../../datove-modely/datovy-78681044.html">FOB informací o realizaci lokace objednané služby</a> (nastaveno na NULL).</li></ol></li><li>Systém odebere získanou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> představující MDU (viz krok <strong>3.a.i</strong>).</li></ol></li><li>Systém odebere <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> představující MDU v <strong>následující</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a>:<br><ol><li>Systém získá takovou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> v <strong>následující</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a> (atribut Lokace objednané služby), která splňuje všechny dále uvedené podmínky zároveň:<br><ul><li><ul><li>atribut Typ lokace nabývá hodnoty Místo dočasného uložení,</li><li>jedná se o v pořadí první <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> tohoto typu v uvedené množině.</li></ul></li></ul></li><li>Pokud existuje alespoň  jedna <a href="../../../datove-modely/datovy-78681044.html">Obsluha lokace objednané služby</a>, která se odkazuje na odebíranou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> (viz krok <strong>3.b.i</strong>; atribut <strong>Lokace objednané služby</strong>):<br><ol><li>Systém smaže všechny takové <a href="../../../datove-modely/datovy-78681044.html">Obsluhy lokace objednané služby</a>.</li></ol></li><li>Pokud existuje alespoň jedna <a href="../../../datove-modely/datovy-78681044.html">FOB informace o realizaci lokace objednané služby</a>, která odkazuje na odebíranou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> (viz krok <strong>3.b.i</strong>; atribut <strong>Identifikátor lokace objednané služby</strong>):<br><ol><li>Systém zruší nastavení atributu <strong>Identifikátor lokace objednané služby</strong> v rámci získaných <a href="../../../datove-modely/datovy-78681044.html">FOB informací o realizaci lokace objednané služby</a> (nastaveno na NULL).<br></li></ol></li><li>Systém odebere získanou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> představující MDU (viz krok <strong>3.b.i</strong>).</li></ol></li></ol></li><li>Pokud je v rámci <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> k dispozici alespoň jedna <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> (atribut Lokace objednané služby):<br><ol><li>Systém přesune všechny <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> z <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (atribut Lokace objednané služby) do <strong>výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (atribut Lokace objednané služby), a to následovně:<br><ul><li>pořadí <a href="../../../datove-modely/datovy-78681044.html">Lokací objednané služby</a> v <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a> je zachováno,</li><li><a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> jsou vloženy jako v pořadí poslední <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> <strong>výchozí</strong> <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li></ul></li></ol></li><li>Pokud je <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> vložena na <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> (hodnota atributu Položka denního výkonu je různá od NULL):<br><ol><li>Systém nastaví hodnotu atributu Položka denního výkonu <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> na NULL (pro potřeby dalšího kroku si zapamatuje identifikaci této <a href="../../../datove-modely/datovy-78681044.html">Položky denního výkonu</a>).</li><li>Systém smaže odpovídající <a href="../../../datove-modely/datovy-78681044.html">Položku denního výkonu</a> (atribut Položka denního výkonu <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>).</li></ol></li><li>Systém smaže <strong>následující </strong><a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a>.</li></ol><p>V závěru je pro lepší orientaci uveden stručný popis celého algoritmu, kde systém postupně prochází všechny <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (v sestupném pořadí – od konce), které mají být sloučeny. Provádí následující akce:</p><ol><li>Systém si připraví <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, které jsou z pohledu aktuální iterace důležité pro sloučení – dvojici slučovaných <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> (dále jako výchozí a následující) a případně i <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> bezprostředně navazující (dále jako navazující).</li><li>Pokud je k dispozici navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>, systém provede aktualizaci vazeb mezi výchozí a navazující <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a> (zachová vazby i po odebrání následující <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>).</li><li>Pokud dochází ke sloučení vazby typu MDU, systém odebere odpovídající <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> tohoto typu ze slučovaných <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> (případně odebere i informace o jejich realizaci včetně <a href="../../../datove-modely/datovy-78681044.html">FOB informací o realizaci lokace objednané služby</a>).</li><li>Systém přenese zbývající <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> z následující <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> na výchozí (informace o realizaci buď není k dispozici, nebo je přenesena a v závěru UC přepočítána).</li><li>Pokud je následující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> naplánována na <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>, systém ji odebere z odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</li><li>Systém smaže následující <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a>.</li></ol><h3>Technická poznámka</h3><p>Při slučování <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> dochází k přenosu <a href="../../../datove-modely/datovy-78681044.html">Lokací objednané služby</a> s nově vytvořené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> do té výchozí. Dochází pak pouze k přenosu těchto <a href="../../../datove-modely/datovy-78681044.html">Lokací objednané služby</a> (nejsou tedy mazány a nově vytvářeny).</p><p><img src="200uc55-sloucit-objednanou-sluzbu-93593675_images/image2025-1-15 13-34-8.png" data-attachment="true"></p><h1>Validace</h1><p>Validace je prováděna průběžně, pokud uživatel vstoupí do pole s možností zadání hodnoty, zadá hodnotu a pole opustí ve stavu, kdy hodnota není validní, je na to upozorněn. Ovládací prvek je graficky zvýrazněn a je doplněno chybové hlášení. Konkrétní validace jednotlivých polí jsou uvedeny v <a href="#" data-page-title="200UI20: Formulář sloučení objednané služby"></a>. Hlídána jsou jak konkrétní validační kritéria každé položky, tak i to, zda je položka povinná.</p><p>Jakmile uživatel stiskne tlačítko Uložit, je provedena validace všech polí.</p><h1>Uživatelské rozhraní</h1><p>Rozložení formuláře pro zrušení rozdělení <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> je uvedeno v samostatném dokumentu, viz <a href="#" data-page-title="200UI20: Formulář sloučení objednané služby"></a>.</p><h1>Revize</h1><h3>15. 1. 2025: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</th><th>Stručný popis změny/doplnění</th></tr><tr><td colspan="1"><a href="200uc55-93593675.html">Sloučení objednaných služeb</a></td><td colspan="1">Odebrání reference na odebírané lokace v rámci odpovídající FOB zprávy (naznačeno modře).</td></tr><tr><td colspan="1"><a href="200uc55-93593675.html">Technická poznámka</a></td><td colspan="1">Bližší informace k implementaci případu užití – pouze popis <strong>aktuálního</strong> stavu (naznačeno modře).</td></tr></tbody></table><h3>23. 5. 2023: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></div></div></div></div></div></th><th>Stručný popis změny/doplnění</div></div></div></div></div></div></th></tr><tr><td colspan="1"><a href="200uc55-93593675.html">Spuštění případu užití</a></td><td colspan="1">Revize případů užití, které spouštějí tento UC (naznačeno modře).</td></tr></tbody></table><h3>15. 3. 2022: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc55-93593675.html">Základní tok událostí</a></td><td colspan="1">Doplněno chování pro výpočet pořadí jednotlivých částí objednané služby (naznačeno modře). <em><strong>ID-053</strong></em></td></tr></tbody></table><h3>23. 10. 2021: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="200uc55-93593675.html">AF02: Provést aktualizaci trasy</a></td><td colspan="1"><p>Doplnění aktualizace trasy odpovídajícího denního výkonu (naznačeno růžově).</p></td></tr></tbody></table>
</div>
</body>
</html>
