<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>200UC40: Načíst uložený průběh editace denního výkonu</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl UC</h1><p>Cílem UC je načíst uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>, a vrátit se tak k požadovanému stavu <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th>Popis</th><th colspan="1">Typická role</th></tr><tr><td>Uživatel</td><td><p>Jedná se o uživatele aplikace RoadPlan, který musí mít oprávnění spouštět tento UC.</p></td><td colspan="1"><p> </p></td></tr></tbody></table><h1>Spuštění případu užití</h1><p>Uživatel zadá požadavek na načtení uloženého průběhu editace jedním z těchto způsobů:</p><ul><li>Načtení uloženého průběhu editace v panelu se záložkami ve formuláři Denního výkonu (<a href="../../uzivatelske-rozhrani/200uixx/200ui02/200ui02-84214538.html">200UI02: Panel se záložkami</a>).</li></ul><h1>Vstupní podmínky</h1><p>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na moduly a UC</a>:</p><ul><li>Plánování denních výkonů.</li></ul><p>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na typ entit</a>:</p><ul><li>Denní výkony - zobrazení a modifikace.</li></ul><p>Poznámka: Načíst uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a> není možné u takového <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>, který se nachází v jenom z následujících stavů (atribut Stav):</p><ul><li>Uzavřený.</li></ul><h3>Vstupní data</h3><ul><li>Denní výkon: <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>, u kterého má být obnoven <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>.</li><li>Průběh editace denního výkonu: <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>, který má být obnoven.</li></ul><h1>Základní tok událostí</h1><ol><li>Systém zobrazí modální okno s dotazem pro potvrzení požadavku na obnovení <a href="../../../datove-modely/datovy-78681044.html">Průběhu editace denního výkonu</a> (MSG_CONF_CANCEL_RESTORE_DAILY_ROUTE, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí požadavek na obnovení – stiskne tlačítko Ano.</li><li>Systém zavře modální okno.</li><li>Systém provede potřebné validace uloženého <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a> – viz <a href="200uc40-84839977.html">Validace</a>.</li><li>Systém obnoví <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> obsažený v <a href="../../../datove-modely/datovy-78681044.html">Průběhu editace denního výkonu</a> (atribut Denní výkon) – viz <a href="200uc40-84839977.html">Obnovení denního výkonu</a>.</li><li>Systém přepočítá trasu obnoveného <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> – spustí <a href="#" data-page-title="200UC29: Získat trasu denního výkonu">200UC29: Získat trasu denního výkonu</a>, na vstup UC jsou předány následující hodnoty:<br><ul><li>Denní výkon: obnovený <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>.</li></ul></li><li>Systém zobrazí modální okno s informací, že byl uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a> v pořádku obnoven (MSG_INFO_DAILY_ROUTE_RESTORED, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí zobrazené hlášení – stiskne tlačítko OK.</li><li>Systém zavře modální okno.</li></ol><h1>Alternativní toky událostí</h1><p>Nejsou.</p><h1>Výjimkové toky událostí</h1><h3>EF01: Storno</h3><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 2 základního toku událostí.</li><li>KDYŽ uživatel stiskne tlačítko Ne.<br><ol><li>Systém zavře modální okno. <strong>Konec toku událostí</strong>.</li></ol></li><li>KDYŽ uživatel stiskne tlačítko křížku pro zavření modálního okna.<br><ol><li>Systém zavře modální okno. <strong>Konec toku událostí</strong>.</li></ol></li></ol><h4>Výstupní podmínky</h4><ul><li>Nebyl obnoven uložený <a href="../../../datove-modely/datovy-78681044.html">Průběhy editace denního výkonu</a>.</li></ul><h3>EF02: Uložený průběh editace není validní</h3><h4>Vstupní podmínky</h4><ul><li>Uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>. již není validní – viz <a href="200uc40-84839977.html">Validace</a> .</li></ul><h4>Tok události</h4><ol><li>Výjimkový tok událostí začíná krokem 3 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že není možné obnovit uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>, a bude tedy smazán (MSG_ERR_UNABLE_RESTORE_DAILY_ROUTE, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí zobrazené hlášení – stiskne tlačítko OK.</li><li>Systém zavře modální okno.</li><li>Systém smaže <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a> získaný na vstupu UC – spustí <a href="#" data-page-title="200UC41: Smazat uložené průběhy editace denního výkonu"></a>, na vstup UC jsou pak předány následující hodnoty:<br><ul><li>Denní výkon: <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> získaný na vstupu UC.</li><li>Průběhy editace denního výkonu: <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a> získaný na vstupu UC.</li></ul></li><li><strong>Konec toku událostí</strong>.</li></ol><h4>Výstupní podmínky</h4><ul><li>Nebyl obnoven uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>.</li><li>Byl smazán uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>.</li></ul><h1>Výstupní podmínky</h1><ul><li>Byl obnoven uložený <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>.</li></ul><h1>Validace</h1><p>TODO: Prověřit.</p><p>Před samotným obnovením <a href="../../../datove-modely/datovy-78681044.html">Průběhu editace denního výkonu</a> je nutné provést určité kontroly proveditelnosti. Mohla by totiž nastat situace, kdy je například některá z <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> již naplánována na jiný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>. V takovém případě není možné existující <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a> použít.</p><p>Projdeme tedy všechny <a href="../../../datove-modely/datovy-78681044.html">Položky denního výkonu</a> typu Objednaná služba (atribut Typ položky) obsažené v <a href="../../../datove-modely/datovy-78681044.html">Průběhu editace denního výkonu</a>, který má být obnoven (atribut Položky denního výkonu entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> – atribut Denní výkon entity <a href="../../../datove-modely/datovy-78681044.html">Průběh editace denního výkonu</a>).</p><p>V rámci každé takové <a href="../../../datove-modely/datovy-78681044.html">Položky denního výkonu</a> pak provádíme kontrolu obsažené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (atribut Objednaná služba entity <a href="../../../datove-modely/datovy-78681044.html">Položka denního výkonu</a>), porovnáváme tedy uložený stav <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> v rámci <a href="../../../datove-modely/datovy-78681044.html">Průběhu editace denního výkonu</a> a aktuální stav odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>. Jednotlivá validační kritéria jsou uvedena dále:</p><ul><li>Aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> je naplánována na stále stejný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> jako uložená <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>, nebo není naplánována na žádném <a href="../../../datove-modely/datovy-78681044.html">Denním výkonu</a>.</li><li>Pokud není aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> naplánována na žádném <a href="../../../datove-modely/datovy-78681044.html">Denním výkonu</a>, musí být v jednom z uvedených stavů (atribut Stav):<br><ul><li>K naplánování.</li></ul></li><li>Pokud byla uložená <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> rozdělena (atribut Navazující objednaná služba je různý od NULL), musí být aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> také rozdělena. Navazující <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> musí být pro uloženou i aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> totožná.</li><li>Pokud nebyla uložená <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> rozdělena (atribut Navazující objednaná služba je NULL), nesmí být rozdělena ani aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.</li><li>Pokud je uložená <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> navazující <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a> (atribut Určení objednané služby nabývá hodnoty Rozdělení), musí existovat i odpovídající aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.</li><li>Pokud bylo z uložené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> vytvořeno místo dočasného uložení (MDU, atribut Místo dočasného uložení je různý od NULL), musí být z aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> taky vytvořeno MDU. <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> představující MDU musí být pro uloženou i aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> totožná.</li><li>Pokud nebylo z uložené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> vytvořeno MDU (atribut Místo dočasného uložení je  NULL), nesmí být vytvořeno MDU ani z aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li><li>Pokud uložená <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> představuje MDU (atribut Určení objednané služby nabývá hodnoty Místo dočasného uložení), musí existovat i odpovídající aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.</li><li>Pokud byla uložená <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> rozdělena (alespoň jeden z atributů Následující objednaná služba, Předchozí objednaná služba je různý od NULL), musí existovat i odpovídající aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>.</li></ul><h1>Algoritmy</h1><h3>Obnovení denního výkonu</h3><p>V rámci obnovení nejsou aktualizovány hodnoty všech atributů <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> – u některých to není potřeba, u jiných to pak není žádoucí – viz tabulka.</p><table><tbody><tr><th>Atribut</th><th colspan="1">Obnovit hodnotu</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Stav</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Provozovna</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Datum realizace</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Typ dopravy</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td>Vozidlo</td><td colspan="1"></td><td colspan="1"><a href="../../../datove-modely/datovy-78681044.html">Vozidlo</a> může být u některých <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> změněno – jedná se však o změnu, která má obecný charakter, a měla by tak být zachována.</td></tr><tr><td colspan="1">Použití přívěsu</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Použité přívěsy</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Intervaly omezení</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Začátek provozní doby</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Délka provozní doby</td><td colspan="1"></td><td colspan="1">Při uživatelské změně nastavení provozní doby je aktualizováno systémem – zde není třeba znova počítat.</td></tr><tr><td colspan="1">Počáteční položka denního výkonu</td><td colspan="1"></td><td colspan="1">Místo, kde začíná <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>, může být změněno – jedná se však o změnu, která má obecný charakter, a měla by tak být zachována.</td></tr><tr><td colspan="1">Koncová položka denního výkonu</td><td colspan="1"></td><td colspan="1">Místo, kde končí <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>, může být změněno – jedná se však o změnu, která má obecný charakter, a měla by tak být zachována.</td></tr><tr><td colspan="1">Položky denního výkonu</td><td colspan="1"></td><td colspan="1">V rámci <a href="../../../datove-modely/datovy-78681044.html">Položek denního výkonu</a> typu Objednaná služba (atribut Typ položky) je žádoucí zachovat změny provedené v rámci obsažené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>. Jsou tedy použity aktuální <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, ne ty uchované v rámci <a href="../../../datove-modely/datovy-78681044.html">Průběhu editace denního výkonu</a>. Jako příklad lze uvést změnu adresy <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> představující místo realizace. Výsledný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> se tedy od toho uloženého může lišit.</td></tr><tr><td colspan="1">Ujetá vzdálenost celkem</td><td colspan="1"></td><td colspan="1">Hodnota získána v rámci přepočtu trasy.</td></tr><tr><td colspan="1">Doba jízdy celkem</td><td colspan="1"></td><td colspan="1">Hodnota získána v rámci přepočtu trasy.</td></tr><tr><td colspan="1">Poznámka</td><td colspan="1"></td><td colspan="1">Poznámka mohla být změněna záměrně – jedná se o obecnou informaci, kterou může být žádoucí zachovat.</td></tr><tr><td colspan="1">Časové využití</td><td colspan="1"></td><td colspan="1">Hodnota získána v rámci přepočtu trasy.</td></tr><tr><td colspan="1">Podíl kilometrů s přívěsem</td><td colspan="1"></td><td colspan="1">Hodnota získána v rámci přepočtu trasy.</td></tr><tr><td colspan="1">Počet objednaných služeb</td><td colspan="1"></td><td colspan="1">Hodnota získána v rámci přepočtu trasy.</td></tr><tr><td colspan="1">Schválený denní výkon</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Průběhy editace denního výkonu</td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Vytisknuto potvrzení o výkonu objednané služby </td><td colspan="1"></td><td colspan="1">–</td></tr><tr><td colspan="1">Textová identifikace vozidla</td><td colspan="1"></td><td colspan="1">V rámci obnovení <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> není změněno přiřazené <a href="../../../datove-modely/datovy-78681044.html">Vozidlo</a>. Proto není obnovena ani hodnota tohoto atributu.</td></tr><tr><td colspan="1">Vytvořeno uživatelem</td><td colspan="1"></td><td colspan="1">–</td></tr></tbody></table><h1>Uživatelské rozhraní</h1><p>Rozložení dialogového okna je uvedeno v samostatném dokumentu – viz <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui06-79430049.html">700UI06: Systémové hlášky</a>.</p><h1>Revize</h1><h3>30. 3. 2021: Tomáš Nadrchal</h3><p>Provedeny změny v rámci celého dokumentu (naznačeno modře). Viz <a href="../../../rp-sprava-pozadavku/id-89065686.html">ID-040: Násobné rozdělení objednané služby</a>.</p><p><br></p><h3>31. 10. 2019: Tomáš Nadrchal </h3><table><tbody><tr><th>Odkaz</div></div></div></th><th>Stručný popis změny/doplnění</div></div></div></th></tr><tr><td colspan="1"><a href="200uc40-84839977.html">Validace</a></td><td colspan="1">Revize validačních kritérií z důvodu doplnění nových možností při práci s denními výkony (naznačeno modře).</td></tr><tr><td colspan="1"><a href="200uc40-84839977.html">Obnovení denního výkonu</a></td><td colspan="1">Doplněny nové atributu entity <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> (naznačeno modře).</td></tr></tbody></table>
</div>
</body>
</html>
