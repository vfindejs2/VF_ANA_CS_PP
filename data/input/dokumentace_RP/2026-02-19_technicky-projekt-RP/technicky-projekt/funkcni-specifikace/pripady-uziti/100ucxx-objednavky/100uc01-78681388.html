<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>100UC01: Založit objednávku</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl UC</h1><p>Cílem UC je založení nové <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a>. Na základě uživatelských oprávnění systém uživateli zpřístupní volání dalších funkčností (např. vytváření <a href="../../../datove-modely/datovy-78681044.html">Zákazníků</a>).</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th>Popis</th><th colspan="1">Typická role</th></tr><tr><td>Uživatel</td><td><p>Jedná se o uživatele aplikace RoadPlan, který musí mít oprávnění spouštět tento UC.</p></td><td colspan="1"><p> </p></td></tr></tbody></table><h1>Spuštění případu užití</h1><p>Uživatel zadá požadavek k založení nové <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> jedním z těchto způsobů:</p><ul><li>Založení nové Objednávky z přehledu Objednávek (<a href="100uc05-78681147.html">100UC05: Zobrazit přehled objednávek</a>).</li><li>Založení nové Objednávky ze šablony (<a href="100uc02-79429803.html">100UC02: Založit objednávku ze šablony</a>).</li><li>Založení nové Objednávky duplikací stávající Objednávky (<a href="100uc07-79429801.html">100UC07: Duplikovat objednávku</a>).</li></ul><h1>Vstupní podmínky</h1><ul><li>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na moduly a UC</a>:<br><ul><li>Objednávky.<br></li></ul></li><li>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na typ entit</a>:<br><ul><li>Objednávky - zobrazení a modifikace</li><li>Objednávky - zobrazení,</li><li>Zákazníci - zobrazení,<br></li><li>Rámcové smlouvy - zobrazení,</li><li>Likvidační místa - zobrazení,</li><li>Typy nádob - zobrazení,</li><li>Nepovinné: Zákazníci - zobrazení a modifikace.</li><li>Nepovinné: Likvidační místa - zobrazení a modifikace.</li></ul></li><li>Uživatel má následující <a href="../../../uzivatelska-78681297.html">oprávnění na instance entity</a>:<br><ul><li>Uživatel může mít právo na omezenou množinu <a href="../../../datove-modely/datovy-78681044.html">Zaměstnanců</a>.</li><li>Uživatel může mít právo na omezenou množinu <a href="../../../datove-modely/datovy-78681044.html">Provozoven</a> (minimálně pak alespoň na 1).</li></ul></li></ul><h3>Vstupní data</h3><ul><li><a href="../../../datove-modely/datovy-78681044.html">Provozovna</a>, pro kterou má být vytvořena <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>.</li><li><a href="../../../datove-modely/datovy-78681044.html">Uživatel</a>, který zakládá <a href="../../../datove-modely/datovy-78681044.html">Objednávku</a>.</li><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> (nepovinné).</li></ul><h1>Základní tok událostí</h1><ol><li>Systém zobrazí formulář <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> dle <a href="#" data-page-title="100UI06: Formulář objednávky (v2)"></a>:<br><ol><li>Pokud je na vstupu předána <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>: Systém nastaví formulář dle na vstupu předané <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a>, na vstup jsou předány následující hodnoty:<br><ol><li>Objednávka: na vstupu předaná <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>.</li><li>Uživatel: na vstupu předaný <a href="../../../datove-modely/datovy-78681044.html">Uživatel</a></li><li>Provozovna: na vstupu předaná <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a>.</li></ol></li><li>Jinak: Systém nastaví formulář do výchozího stavu, na vstup jsou předány následující hodnoty:<br><ol><li>Objednávka: NULL.</li><li>Uživatel: na vstupu předaný <a href="../../../datove-modely/datovy-78681044.html">Uživatel</a></li><li>Provozovna: na vstupu předaná <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a>.</li></ol></li></ol></li><li>Systém na základě uživatelských oprávnění umožní uživateli spustit:<br><ol><li>TODO: Přidat UC: Vytvořit zákazník,</li><li>TODO: Přidat UC: Vytvořit bankovní spojení,</li><li>TODO: Přidat UC: Vytvořit zástupce objednavatele,<br></li><li>TODO: Přidat UC: Vytvořit Místo realizace,</li><li>TODO: Přidat UC: Přidat objednanou nádobu, </li><li>TODO: Přidat UC: Editovat objednanou nádobu,</li><li>TODO: Přidat UC: Odebrat objednanou nádobu,</li><li>TODO: Přidat UC: Nastavit řádek výpočtu ceny,</li><li>TODO: Přidat UC: Nastavit notifikaci,</li><li>TODO: Přidat UC: Odebrat notifikaci.</li></ol></li><li>Uživatel vyplní formulář.</li><li>Uživatel stiskne tlačítko Uložit.</li><li>Systém provede validaci vstupních údajů (viz <a href="100uc01-78681388.html">Validace</a>).</li><li>Systém vygeneruje číslo <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> (viz <a href="100uc01-78681388.html">Číslo objednávky</a>) – atribut Číslo objednávky.</li><li>Systém nastaví informaci o existenci <a href="../../../datove-modely/datovy-78681044.html">Objednaného úkonu</a> na výzvu (viz <a href="100uc01-78681388.html">Vyhodnotit existenci objednaného úkonu na výzvu</a>) – atribut Je obsažen objednaný úkon na výzvu.</li><li>Systém uloží <a href="../../../datove-modely/datovy-78681044.html">Objednávku</a> pod získaným číslem.</li><li>Systém aktualizuje hodnotu uvedených atributů <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> (nejsou získány přímo z formuláře):<br><ul><li><strong>Vytvořeno</strong>: aktuální čas.</li><li><strong>Vytvořil</strong>: na vstupu získaný <a href="../../../datove-modely/datovy-78681044.html">Uživatel</a>.<br></li><li><strong>Vytvořeno systémem</strong>: nastavena hodnota <strong>FALSE</strong>.</li></ul></li><li>Pokud má být odeslána notifikace:<br><ol><li>Systém odešle notifikaci, spustí <a href="#" data-page-title="100UC08: Odeslat notifikace k upřesnění dispečerem"></a> (TODO: Upřesnit).</li></ol></li><li>Pokud je <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> ukládána do stavu K realizaci (atribut Stav):<br><ol><li>Pokud má být proveden export zákazníka, systém zajistí potřebné akce (viz <a href="100uc01-78681388.html">AF04: Exportovat zákazníka</a>).</li><li>Pokud je odpovídající <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> (atribut Provozovna entity <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>) obsažena v kolekci <a href="../../../datove-modely/datovy-78681044.html">Provozoven</a> zanesených v pilotním provozu nad modulem Objednávek (organizationalUnitsPilotOrders, viz <a href="../../../konfiguracni-81592468.html">Konfigurační hodnoty</a>):<br><ol><li>Systém nastaví stav <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> na Dokončená bez informace o realizaci (atribut Stav).</li></ol></li><li>Jinak:<br><ol><li>Systém vygeneruje <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, spustí <a href="#" data-page-title="101UC01: Vygenerovat objednané služby"></a>, na vstup je pak předána právě vytvořená <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>.</li></ol></li></ol></li><li>Systém se vrátí zpět do části aplikace, kde byl vyvolán UC.</li></ol><p>Poznámka:</p><ul><li>Pokud není informace, kde byl UC vyvolán, k dispozici, je uživatel přesměrován na přehled <a href="../../../datove-modely/datovy-78681044.html">Objednávek</a> (<a href="#" data-page-title="100UC05: Zobrazit přehled objednávek"></a>). TODO: Promyslet zvýraznění vytvořené objednávky.</li><li>Chování tlačítka pro uložení <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> přímo k realizaci je uvedeno v rámci popisu UI formuláře.</li><li>Pokud je <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> ukládána do stavu K realizaci a zároveň se jedná o <a href="../../../datove-modely/datovy-78681044.html">Provozovnu</a> zanesenou v pilotním provozu, dojde rovnou k přepnutí <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> do stavu Dokončená bez informace o realizaci. I přesto jsou prováděny všechny akce spojené s uložením do stavu K realizaci (např. odeslání nového <a href="../../../datove-modely/datovy-78681044.html">Zákazníka</a> do systému WinyX), pokud není uvedeno jinak.<br></li></ul><h1>Alternativní toky událostí</h1><h3>AF01: Údaje ve formuláři nejsou validní</h3><h4>Vstupní podmínky</h4><ul><li>Údaje ve formuláři nejsou validní – viz <a href="100uc01-78681388.html">Validace</a>.</li></ul><h4>Tok události</h4><ol><li>Alternativní tok událostí začíná krokem 5 základního toku událostí.</li><li>Systém zvýrazní ovládací prvky, které neobsahují validní hodnotu.</li><li>Systém zobrazí modální okno s informací, že některé ze zadaných údajů nejsou validní (viz <a href="100uc01-78681388.html">Validace</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno. <strong>Návrat na krok 3 základního toku událostí</strong>.</li></ol><h3>AF02: Vstupní data nebyla nalezena</h3><h4>Vstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>, která byla získána na vstupu UC, neexistuje.</li></ul><h4>Tok událostí</h4><ol><li>Alternativní tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že nebyla předána existující hodnota pro všechny vstupní parametry (MSG_ERR_ITEM_NOT_FOUND, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li><li>Systém ignoruje <a href="../../../datove-modely/datovy-78681044.html">Objednávku</a> předanou na vstupu UC. <strong>Skok na krok 1.b základního toku událostí</strong>.</li></ol><h3>AF03: Uživatel nemá právo na vstupní data</h3><h4>Vstupní podmínky</h4><ul><li>Uživatel nemá právo na <a href="../../../datove-modely/datovy-78681044.html">Objednávku</a>, která byla získána na vstupu UC.</li></ul><h4>Tok událostí</h4><ol><li>Alternativní tak událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že byla předána hodnota, na kterou uživatel nemá právo (MSG_ERR_NOT_AUTHORIZED_FOR_ITEM, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li><li>Systém ignoruje <a href="../../../datove-modely/datovy-78681044.html">Objednávku</a> předanou na vstupu UC. <strong>Skok na krok 1.b základního toku událostí</strong>.</li></ol><h3>AF04: Exportovat zákazníka</h3><h4>Vstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> byla uložena do stavu K realizaci (atribut Stav).</li><li>V <a href="../../../datove-modely/datovy-78681044.html">Objednávce</a> nastavený <a href="../../../datove-modely/datovy-78681044.html">Zákazník</a> (atribut Objednavatel) má být exportován (byl založen v RoadPlan) – splňuje všechny dále uvedené podmínky zároveň:<br><ul><li>Hodnota atributu Externí identifikátor není k dispozici.</li><li>Hodnota atributu Odeslán ke kontrole je nastavena na FALSE.</li></ul></li></ul><h4>Tok událostí</h4><ol><li>Alternativní tok událostí začíná krokem <strong>11.a</strong> základního toku událostí.</li><li>Systém provede export <a href="../../../datove-modely/datovy-78681044.html">Zákazníka</a> do externího systému – spustí <a href="#" data-page-title="603UC22: Zahájit export záznamů"></a>, na vstup jsou předány následující hodnoty:<br><ul><li>Zákazník: <a href="../../../datove-modely/datovy-78681044.html">Zákazník</a> nastavený v rámci <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> (atribut Objednavatel).</li></ul></li><li>Systém pokračuje v základním toku událostí.</li></ol><h4>Výstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Zákazník</a> byl odeslán do externího systému.</li></ul><h1>Výjimkové toky událostí</h1><h3>EF01: Storno</h3><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí může začít kdykoliv.</li><li>KDYŽ uživatel stiskne tlačítko Storno.<br><ol><li>Systém se vrátí zpět do části aplikace, kde byl vyvolán UC. <strong>Konec toku událostí</strong>.</li></ol></li><li>KDYŽ uživatel opustí formulář pro založení <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a>.<br><ol><li><strong>Konec toku událostí</strong>.</li></ol></li></ol><p>Poznámka: Pokud není informace, kde byl UC vyvolán, k dispozici, je uživatel přesměrován na výchozí stránku aplikace RoadPlan (<a href="#" data-page-title="703UC01: Zobrazit stránku O aplikaci">703UC01: Zobrazit stránku O aplikaci</a>).</p><h4>Výstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> nebyla vytvořena a uložena.</li></ul><h3>EF02: Uživatel nemá oprávnění na spuštění UC</h3><h4>Vstupní podmínky</h4><ul><li>Uživatel nemá na požadovaný UC oprávnění.</li></ul><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že Uživatel nemá na požadovaný UC oprávnění (kód hlášky MSG_ERR_NOT_AUTHORIZED_FOR_ITEM, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li><li>Systém se vrátí zpět do části aplikace, kde byl vyvolán UC. <strong>Konec toku událostí</strong>.</li></ol><p>Poznámka: Pokud není informace, kde byl UC vyvolán, k dispozici, je uživatel přesměrován na výchozí stránku aplikace RoadPlan (<a href="#" data-page-title="703UC01: Zobrazit stránku O aplikaci">703UC01: Zobrazit stránku O aplikaci</a>).</p><h4>Výstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> nebyla vytvořena a uložena.</li></ul><h3>EF03: Vstupní data nejsou k dispozici</h3><h4>Vstupní podmínky</h4><p>Pro spuštění výjimkového toku událostí je postačující splnění alespoň jedné z uvedených podmínek.</p><ul><li><a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> nebyla získána na vstupu UC.</li><li><a href="../../../datove-modely/datovy-78681044.html">Uživatel</a> nebyl získán na vstupu UC.</li></ul><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že nebyla předána hodnota pro všechny vstupní parametry (MSG_ERR_ITEMS_EMPTY, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li><li>Systém se vrátí zpět do části aplikace, kde byl vyvolán UC. <strong>Konec toku událostí</strong>.</li></ol><p>Poznámka: Pokud není informace, kde byl UC vyvolán, k dispozici, je uživatel přesměrován na výchozí stránku aplikace RoadPlan (<a href="#" data-page-title="703UC01: Zobrazit stránku O aplikaci">703UC01: Zobrazit stránku O aplikaci</a>).</p><h4>Výstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> nebyla vytvořena a uložena.</li></ul><h3>EF04: Vstupní data nebyla nalezena</h3><h4>Vstupní podmínky</h4><p>Pro spuštění výjimkového toku událostí je postačující splnění alespoň jedné z uvedených podmínek.</p><ul><li><a href="../../../datove-modely/datovy-78681044.html">Provozovna</a>, která byla získána na vstupu UC, neexistuje.</li><li><a href="../../../datove-modely/datovy-78681044.html">Uživatel</a>, který byl získán na vstupu UC, neexistuje.</li></ul><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že nebyla předána existující hodnota pro všechny vstupní parametry (MSG_ERR_ITEM_NOT_FOUND, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li><li>Systém se vrátí zpět do části aplikace, kde byl vyvolán UC. <strong>Konec toku událostí</strong>.</li></ol><p>Poznámka: Pokud není informace, kde byl UC vyvolán, k dispozici, je uživatel přesměrován na výchozí stránku aplikace RoadPlan (<a href="#" data-page-title="703UC01: Zobrazit stránku O aplikaci">703UC01: Zobrazit stránku O aplikaci</a>).</p><h4>Výstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> nebyla vytvořena a uložena.</li></ul><h3>EF05: Uživatel nemá právo na vstupní data</h3><h4>Vstupní podmínky</h4><ul><li>Uživatel nemá právo na <a href="../../../datove-modely/datovy-78681044.html">Provozovnu</a>, která byla získána na vstupu UC.</li><li>Uživatel nemá právo na <a href="../../../datove-modely/datovy-78681044.html">Uživatele</a>, která byla získána na vstupu UC.</li></ul><h4>Tok událostí</h4><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém zobrazí modální okno s informací, že byla předána hodnota, na kterou uživatel nemá právo (MSG_ERR_NOT_AUTHORIZED_FOR_ITEM, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Uživatel potvrdí chybové hlášení.</li><li>Systém zavře modální okno.</li><li>Systém se vrátí zpět do části aplikace, kde byl vyvolán UC. <strong>Konec toku událostí</strong>.</li></ol><p>Poznámka: Pokud není informace, kde byl UC vyvolán, k dispozici, je uživatel přesměrován na výchozí stránku aplikace RoadPlan (<a href="#" data-page-title="703UC01: Zobrazit stránku O aplikaci">703UC01: Zobrazit stránku O aplikaci</a>).</p><h4>Výstupní podmínky</h4><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> nebyla vytvořena a uložena.</li></ul><h1>Výstupní podmínky</h1><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> byla vytvořena a uložena.</li></ul><h1>Validace</h1><p>Validace je prováděna průběžně, pokud uživatel vstoupí do pole s možností zadání hodnoty a opustí jej ve stavu, kdy hodnota není validní, je na to upozorněn. Ovládací prvek je graficky zvýrazněn a je doplněno chybové hlášení. Konkrétní validace jednotlivých polí jsou uvedeny v <a href="#" data-page-title="100UI06: Formulář objednávky (v2)"></a>. Hlídána jsou jak konkrétní validační kritéria každé položky, tak i to, zda je položka povinná.</p><p>Jakmile uživatel stiskne tlačítko Uložit, je provedena validace všech polí. Samotný průběh validace se liší dle stavu <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> (atribut Stav), do kterého je ukládána, jak je uvedeno v rámci popisu formuláře. Obecně je pak chování následující:</p><ul><li>Rozpracovaná, K upřesnění – povinné položky nemusí být vyplněny, vyplněné údaje musí být validní.</li><li>K realizaci, Zrušená, Plněná, Dokončená – všechny povinné položky musí být vyplněny, všechny údaje musí být validní.</li></ul><p>Pokud jsou všechny údaje v pořádku, je <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> uložena. Pokud ne, jsou chybně vyplněná pole zvýrazněna a doplněna o chybové hlášení. Uživateli je navíc zobrazeno chybové hlášení, že <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> nemůže být uložena. Chybové hlášení je pak skládáno na základě obsažených chyb, kdy jsou v rámci dialogového okna jednotlivá hlášení skládána za sebe na samostatné řádky. Identifikovány jsou pak následující chyby, viz tabulka. Ve sloupci Podmínky jsou pak uvedena kritéria, která musí být splněna, aby došlo k zobrazení hlášky v rámci dialogového okna.</p><table><tbody><tr><th>Chyba</th><th>Chybové hlášení</th><th>Podmínky</th><th>Poznámka</th></tr><tr><td>Některé ze zadaných údajů nejsou validní.</td><td>MSG_ERR_FORM_NOT_VALID, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a></td><td>Nejsou splněna všechna validační kritéria polí obsažených ve formuláři.</td><td>Uvedené rozlišení dle stavu <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> je uvedeno v rámci popisu formuláře.</td></tr><tr><td>Je nastavena <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> s chybnými souřadnicemi.</td><td><p>MSG_ERR_COORDINATES_NOT_SET, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a>, na vstupu jsou předány následující hodnoty:</p><ul><li>Na vstupu je předán entita <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a>.</li><li>Instance entity splňující uvedené podmínky (použit je atribut Název).<br></li></ul></td><td>Nastavená <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> (atribut Provozovna entity <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>) nemá k dispozici souřadnice – hodnota alespoň jedno z dále uvedených atributů není k dispozici: <strong>Zeměpisná šířka</strong>, <strong>Zeměpisná délka</strong>.</td><td>–</td></tr><tr><td>Je nastaveno <a href="../../../datove-modely/datovy-78681044.html">Místo realizace</a> s chybnými souřadnicemi.</td><td><p>MSG_ERR_COORDINATES_NOT_SET, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a>, na vstupu jsou předány následující hodnoty:</p><ul><li>Entita <a href="../../../datove-modely/datovy-78681044.html">Místo realizace</a>.</li><li>Instance entity splňující uvedené podmínky (použit je atribut Název).</li></ul></td><td><p>Alespoň jedno nastavené <a href="../../../datove-modely/datovy-78681044.html">Místo realizace</a> (atribut <strong>Místo realizace</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Položka objednávky</a> – atribut <strong>Položky objednávky</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>) nemá k dispozici souřadnice – hodnota alespoň jedno z dále uvedených atributů není k dispozici: <strong>Zeměpisná šířka</strong>, <strong>Zeměpisná délka</strong>.</p><p>Nastavené <a href="../../../datove-modely/datovy-78681044.html">Místo realizace</a> (atribut <strong>Cílové místo realizace</strong> odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Objednaného úkonu</a> – atribut <strong>Objednaný úkon</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednaná nádoba</a> – atribut <strong>Objednané nádoby</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Položka objednávky</a> – atribut <strong>Položky objednávky</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>) nemá k dispozici souřadnice – hodnota alespoň jedno z dále uvedených atributů není k dispozici: <strong>Zeměpisná šířka</strong>, <strong>Zeměpisná délka</strong>.</p></td><td><p>Postačuje splnění alespoň jedné z uvedených podmínek.</p></td></tr><tr><td>Je nastaveno <a href="../../../datove-modely/datovy-78681044.html">Likvidační místo</a> s chybnými souřadnicemi.</td><td><p>MSG_ERR_COORDINATES_NOT_SET, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a>, na vstupu jsou předány následující hodnoty:</p><ul><li>Na vstupu je předán entita <a href="../../../datove-modely/datovy-78681044.html">Likvidační místo</a>.</li><li>Instance entity splňující uvedené podmínky (použit je atribut Název).<br></li></ul></td><td><p>Alespoň jedno nastavené <a href="../../../datove-modely/datovy-78681044.html">Likvidační místo</a> (atribut <strong>Likvidační místo</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Vývoz na Likvidační místo</a> – atribut <strong>Vývozy na Likvidační místo</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednaná nádoba</a> – atribut <strong>Objednané nádoby</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Položka objednávky</a> – atribut <strong>Položky objednávky</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>) nemá k dispozici souřadnice – hodnota alespoň jedno z dále uvedených atributů není k dispozici: <strong>Zeměpisná šířka</strong>, <strong>Zeměpisná délka</strong>.</p><p>Nastavené výchozí <a href="../../../datove-modely/datovy-78681044.html">Likvidační místo</a> (atribut <strong>Výchozí likvidační místo</strong> odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Objednaného úkonu</a> – atribut <strong>Objednaný úkon</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednaná nádoba</a> – atribut <strong>Objednané nádoby</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Položka objednávky</a> – atribut <strong>Položky objednávky</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a>) nemá k dispozici souřadnice – hodnota alespoň jedno z dále uvedených atributů není k dispozici: <strong>Zeměpisná šířka</strong>, <strong>Zeměpisná délka</strong>.</p></td><td>Postačuje splnění alespoň jedné z uvedených podmínek.</td></tr><tr><td>Není nastavena notifikace.</td><td>MSG_ERR_NOTIFICATION_NOT SET, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a></td><td><p>Není nastavena notifikace a zároveň je splněna jedna z uvedených podmínek:</p><ul><li>Stav <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> (atribut Stav) nabývá hodnoty K upřesnění (poznámka: při založení <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> není hodnota k dispozici).</li><li>V rámci ovládacího prvku pro nastavení stavu <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> je nastavena hodnota K upřesnění.</li></ul></td><td>Notifikace je dostupná pouze pro stavy <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a>.</td></tr><tr><td colspan="1">Termín <a href="../../../datove-modely/datovy-78681044.html">objednaného úkonu</a> je v minulosti</td><td colspan="1">MSG_ERR_ORDER_TERM_IN_PAST, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a>.</td><td colspan="1"><p>V rámci objednávky je vložen alespoň jeden <a href="../../../datove-modely/datovy-78681044.html">objednaný úkon</a>, který splňuje všechny dále uvedené podmínky:</p><ul><li>Hodnota atributu <strong>Podmínka vykonání</strong> je nastavena na <strong>Termín</strong>.</li><li>Hodnota atributu <strong>Termín od</strong> je menší než dnešní datum (je v minulosti).</li></ul></td><td colspan="1">Jedná se o případy, kdy ukládáme rozpracovanou objednávku – nastavené termíny již nejsou ke dni uložení validní.</td></tr><tr><td colspan="1">Pravidlo opakování začíná v minulosti</td><td colspan="1">MSG_ERR_ORDER_REPETITION_RULE_IN_PAST, viz <a href="#" data-page-title="Systémové hlášky">Systémové hlášky</a>.</td><td colspan="1"><p>V rámci objednávky je vložen alespoň jeden <a href="../../../datove-modely/datovy-78681044.html">objednaný úkon</a>, který splňuje všechny dále uvedené podmínky:</p><ul><li>Hodnota atributu <strong>Podmínka vykonání</strong> je nastavena na <strong>Pravidlo opakování</strong>.</li><li>Hodnota atributu <strong>Pravidlo opakování</strong> obsahuje časové rozmezí se začátkem menším než dnešní datum (je v minulosti).</li></ul></td><td colspan="1">Jedná se o případy, kdy ukládáme rozpracovanou objednávku – nastavená pravidla opakování již nejsou ke dni uložení validní.</td></tr></tbody></table><h1>Algoritmy</h1><h3>Číslo objednávky</h3><p>Číslo objednávky je složeno ze dvou částí:</p><ul><li><strong>Prefix</strong> – kódové označení <a href="../../../datove-modely/datovy-78681044.html">Provozovny</a>, pro kterou <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> vzniká. Kódová označení pro jednotlivé <a href="../../../datove-modely/datovy-78681044.html">Provozovny</a> je pak k dispozici v rámci atributu <strong>Kód</strong>. <em>Pravděpodobně odpovídá stávající implementaci.</em></li><li><strong>Pořadové číslo</strong> – pořadové číslo <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> vzhledem k dané <a href="../../../datove-modely/datovy-78681044.html">Provozovně</a>. Vznikne inkrementací pořadového čísla poslední vytvořené <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a>. První <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> každé <a href="../../../datove-modely/datovy-78681044.html">Provozovny</a> má pořadové číslo <strong>1</strong>.</li></ul><p>Z jednotlivých části je pak vytvořeno číslo objednávky:</p><ul><li>Formát: <strong><prefix>-<pořadové číslo></strong>.</li><li>Příklad hodnoty: <strong>1125-000247</strong>.</li></ul><p>Pokud není v rámci <a href="../../../datove-modely/datovy-78681044.html">Provozovny</a> k dispozici hodnota atributu <strong>Kód</strong>, je číslo objednávky získáno následovně:</p><ul><li>Formát: <strong><pořadové číslo></strong>.</li><li>Příklad hodnoty: <strong>000247</strong>.</li></ul><p>Číslo objednávky je vytvářeno až při uložení <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a>. Dokud tedy není <a href="../../../datove-modely/datovy-78681044.html">Objednávka</a> uložena, není rezervováno ani její číslo. Nebude tak docházet k vytváření „prázdných míst“ v číselné řadě s čísly objednávek.</p><p>Poznámka: <strong>Algoritmus pro získání čísla objednávky se může lišit dle konkrétního zákazníka, je s tím tedy potřeba při implementaci počítat!</strong></p><h3>Vyhodnotit existenci objednaného úkonu na výzvu</h3><p>Algoritmus je využit i pro migraci existujících <a href="../../../datove-modely/datovy-78681044.html">Objednávek</a>, kterou je v rámci implementace požadavku nutné provést (viz <a href="../../../datove-modely/datovy-78681044.html">Migrace informace o existenci objednaného úkonu na výzvu</a>).</p><p>V rámci <a href="../../../datove-modely/datovy-78681044.html">Objednávky</a> je mj. evidována informace, za je obsažen alespoň jeden <a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a> na výzvu. Pokud tedy existuje takový <a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a>, který splňuje všechny dále uvedené podmínky zároveň, je na výstupu algoritmu vrácena hodnota <strong>TRUE</strong>:</p><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a> spadá pod právě řešenou <a href="../../../datove-modely/datovy-78681044.html">Objednávku</a> (atribut Objednávka entity <a href="../../../datove-modely/datovy-78681044.html">Položka objednávky</a> – atribut Položka objednávky entity <a href="../../../datove-modely/datovy-78681044.html">Objednaná nádoba</a> – atribut Objednaná nádoba entity <a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a>).</li><li>Atribut Podmínka vykonání je nastaven na hodnotu Na výzvu (viz <a href="../../../datove-modely/datovy-78681044.html">Podmínka vykonání objednaného úkonu</a>).</li></ul><p>Jinak takový <a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a> neexistuje, na výstupu je vrácena hodnota <strong>FALSE</strong>.</p><p>Poznámka: Při nalezení prvního <a href="../../../datove-modely/datovy-78681044.html">Objednaného úkonu</a>, který splňuje zmíněné podmínky, je možné algoritmus předčasně ukončit → v takovém případě již víme, že existuje alespoň jeden <a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a> na výzvu.</p><h1>Uživatelské rozhraní</h1><p>Rozložení formuláře je spolu s výchozím nastavením hodnot jednotlivých komponent uvedeno v samostatném dokumentu – viz <a href="#" data-page-title="100UI06: Formulář objednávky (v2)"></a>.</p><h1>Revize</h1><h3>18. 8. 2025: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</th><th>Stručný popis změny/doplnění</th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Validace</a></td><td colspan="1"><p>Doplněny validace související s termínem a pravidlem opakování (naznačeno modře).</p></td></tr></tbody></table><h3>30. 4. 2024: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</th><th>Stručný popis změny/doplnění</th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Validace</a></td><td colspan="1"><p>Změny související s novými typy úkonu (naznačeno růžově).</p></td></tr></tbody></table><h3>16. 2. 2024: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Základní tok událostí</a></td><td colspan="1">Doplněno nastavení nového atributu objednávky (naznačeno modře).</td></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Validace</a></td><td colspan="1">Doplněna validace pro zadané výchozí likvidační místo (naznačeno modře).</td></tr></tbody></table><h3>31. 8. 2023: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Číslo objednávky</a></td><td colspan="1"><p>Revize chování algoritmu pro získání čísla objednávky (naznačeno modře).</p><p>Poznámka: Uvedené chování je pravděpodobně alespoň v částečném rozsahu implementováno.</p></td></tr></tbody></table><h3>24. 6. 2022: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Základní tok událostí</a></td><td colspan="1">Doplněn export zákazníků (naznačeno modře).</td></tr><tr><td colspan="1"><a href="100uc01-78681388.html">AF04: Exportovat zákazníka</a></td><td colspan="1">Doplnění alternativní tok pro export zákazníků (naznačeno modře).</td></tr></tbody></table><h3>4. 3. 2022: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Základní tok událostí</a></td><td colspan="1">Doplněno chování pro nastavení informace o existenci objednaného úkonu na výzvu (naznačeno modře). <em><strong>ID-035</strong></em></td></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Vyhodnotit existenci objednaného úkonu na výzvu</a></td><td colspan="1">Doplněn algoritmus pro vyhodnocení existence objednaného úkonu na výzvu (naznačeno modře). <em><strong>ID-035</strong></em></td></tr></tbody></table><h3>10. 9. 2019: Tomáš Nadrchal</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1"><a href="100uc01-78681388.html">Základní tok událostí</a></td><td colspan="1">Doplněno chování pro vyhodnocení, zda je odpovídající <a href="../../../datove-modely/datovy-78681044.html">Provozovna</a> zanesena v pilotním provozu nad modulem Objednávek (naznačeno modře).</td></tr></tbody></table><h3>31. 7. 2019: Tomáš Nadrchal</h3><p>Provedeny změny v rámci celého dokumentu dle požadavků z M9 (naznačeno modře).</p>
</div>
</body>
</html>
