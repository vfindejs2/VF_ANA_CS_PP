<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>300UC11: Ukončit vyhodnocování realizace denního výkonu</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl UC</h1><p>Případ užití zajišťuje ukončení realizace <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> vozidla a zápis odpovídajících dat do příslušné instance entity <a href="../../../datove-modely/datovy-78681044.html">Realizace denního výkonu</a>.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th>Popis</th><th colspan="1">Typická role</th></tr><tr><td>Systém FleetwareWeb2</td><td><p>Externí aplikace FleetwareWeb2, která komunikuje s aplikací RoadPlan na systémové úrovni.</p></td><td colspan="1"><p>—</p></td></tr><tr><td colspan="1">Čas</td><td colspan="1">Komponenta systému RoadPlan, která dle nastavených parametrů spouští v požadovaném čase danou úlohu.</td><td colspan="1">—</td></tr></tbody></table><h1>Spuštění případu užití</h1><ul><li>Plánované spuštění - konec aktuálního dne (dále jako den D).</li></ul><h1>Vstupní podmínky</h1><p>Ve vstupní frontě existuje alespoň jedna instance <a href="../../../datove-modely/datovy-78681044.html">Realizace denního výkonu</a>, která zároveň splňuje tyto podmínky:</p><ul><li>je ve stavu Platný,</li><li>její Datum a čas realizace odpovídá okamžiku ze dne D,</li><li>její atribut Datum a čas konce je NULL.</li></ul><p>Pro vozidlo existuje <a href="../../../konfiguracni-81592468.html">konfigurace</a> určující číslo sledovaného <a href="https://confluence.radium.cz/display/FLWW/Vstupy+vozidel">vstupu vozidla</a>.</p><ul><li>Vozidlo má toto číslo vstupu definované pomocí parametru objektu, který lze získat z FLWW2 API: GET /objects/{objectId}/labels/{key}. Název klíče je daný konfiguračním parametrem <em>PTOInputLabelKey</em>.</li><li>Pokud takový parametr vozidlo nemá nastavený, je použita výchozí hodnota daná konfiguračním parametrem defaultPTOInput.</li></ul><h1>Základní tok událostí</h1><p>Pro každou instanci <a href="../../../datove-modely/datovy-78681044.html">Realizace denního výkonu</a> ve vstupní frontě systém:</p><ol><li>Zjistí ze systému ze systému FleetwareWeb2:<br><ol><li>Celkem ujetou vzdálenost, kterou příslušné vozidlo (zjištěné z odkazovaného <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>) urazilo za daný den D.</li><li>Čas konce poslední jízdy započaté v den D. Pokud jízda trvá do následujícího dne, nebo není korektně ukončena (například při datovém výpadku), pak je Denní výkon ukončen časem 23:59:59.  </li><li>Průběh trajektrorie vozidla za den D.</li><li>Události odpovídající aktivaci sledovaného vstupu vozidla za den D (viz Vstupní podmínky).</li></ol></li><li>Pro danou instanci <a href="../../../datove-modely/datovy-78681044.html">Realizace denního výkonu</a> systém:<br><ol><li>Nastaví atribut Ujetá vzdálenost celkem na hodnotu zjištěnou v kroku 1.<br></li><li>Nastaví atribut Datum a čas konce na čas zjištěný v kroku 1.</li><li>Uloží do atributu Trajektorie její průběh zjištěný v kroku 1.<br></li></ol></li><li>Systém provede nastavení <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>, které patří do příslušného <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> dle <a href="300uc11-84840376.html">ALG01: Nastavení Objednaných služeb</a>.</li><li>Uloží jednotlivé <a href="../../../datove-modely/datovy-78681044.html">Události manipulace s nádobou</a> nalezené v kroku 1.</li><li>Změní stav příslušného <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> na "Ke kontrole".</li></ol><h1>Alternativní toky událostí</h1><p>Nejsou.</p><h1>Výjimkové toky událostí</h1><p>Neuvedeny.</p><h1>Výstupní podmínky</h1><p>Došlo ke korektnímu ukončení zpracovaných <a href="../../../datove-modely/datovy-78681044.html">Realizací denního výkonu</a>.</p><h1>Validace</h1><p>Neuvedeny.</p><h1>Algoritmy</h1><h3>ALG01: Nastavení Objednaných služeb</h3><p>Pro každou Objednanou službu zařazenou do Denního výkonu, který odpovídá zpracovávané Realizaci denního výkonu, bude provedeno následující nastavení atributů:</p><table><tbody><tr><th>Atribut</th><th>Hodnota</th><th>Poznámka</th></tr><tr><td colspan="1">Stav</td><td colspan="1">Ke kontrole</td><td colspan="1">–</td></tr><tr><td>Realizace denního výkonu</td><td>reference na vyhodnocovanou <a href="../../../datove-modely/datovy-78681044.html">Realizaci denního výkonu</a></td><td>–</td></tr><tr><td>Realizována</td><td><p>True: Pokud ke všem <a href="../../../datove-modely/datovy-78681044.html">Lokacím objednané služby</a> (které mají vazbu na danou <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> a <a href="../../../datove-modely/datovy-78681044.html">Realizaci denního výkonu</a>) existuje odpovídající <a href="../../../datove-modely/datovy-78681044.html">Obsluha lokace objednané služby</a> s nenulovými atributy Datum a čas obsluhy, Událost manipulace s nádobou.</p><p>False: V ostatních případech.</p></td><td>Tj. služba je považována za realizovanou, pokud byla pozitivně vyhodnocená obsluha všech jejích lokací.</td></tr><tr><td>Pořadí v kontrole realizace</td><td><p>Pořadí, které má Objednaná služba v příslušném Denním výkonu.</p><p>Viz poznámka </p></td><td><p>Uvažovat pouze pořadí v rámci Položek denního výkonu typu Objednaná služba.</p><p>Nezohledňovat výskyt ostatních typů položek.</p></td></tr></tbody></table><p><br></p><h1>Uživatelské rozhraní</h1><p>UC není vizuální.</p><h1>Revize</h1><h3>11. 11. 2019: Miroslav Slivoně</h3><table><tbody><tr><th>Odkaz</div></div></th><th>Stručný popis změny/doplnění</div></div></th></tr><tr><td colspan="1"><a href="300uc11-84840376.html">Základní tok událostí</a></td><td colspan="1">Doplněno ošetření nestandardního stavu v kroku 1b.</td></tr></tbody></table><h3>18. 6. 2019: Miroslav Slivoně</h3><table><tbody><tr><th>Odkaz</div></div></th><th>Stručný popis změny/doplnění</div></div></th></tr><tr><td colspan="1"><a href="300uc11-84840376.html">ALG01: Nastavení Objednaných služeb</a></td><td colspan="1">Doplněn algoritmus, který nastaví data služeb pro potřeby funkčností v M8..</td></tr></tbody></table><h3>7. 6. 2019: Miroslav Slivoně</h3><table><tbody><tr><th>Odkaz</div></div></th><th>Stručný popis změny/doplnění</div></div></th></tr><tr><td colspan="1"><a href="300uc11-84840376.html">V</a>stupní podmínky</td><td colspan="1">Doplnění způsobu získání čísla sledovaného vstupu vozidla z API FLWW2.</td></tr></tbody></table><h3>23. 5. 2019: Miroslav Slivoně</h3><table><tbody><tr><th>Odkaz</div></div></th><th>Stručný popis změny/doplnění</div></div></th></tr><tr><td colspan="1"><a href="300uc11-84840376.html">Základní tok událostí</a></td><td colspan="1">Doplněno přepínání stavu Denních výkonů a Objednaných služeb.</td></tr></tbody></table>
</div>
</body>
</html>
