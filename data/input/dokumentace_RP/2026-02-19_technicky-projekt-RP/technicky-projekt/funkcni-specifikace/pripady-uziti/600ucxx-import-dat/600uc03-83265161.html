<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>600UC03: Automatický geokóding adres</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl UC</h1><p>Technický UC, který zajišťuje doplnění souřadnic k adresám (míst realizací, likvidačních míst, provozoven), která byla importována z externího systému (WinyX) bez zeměpisných souřadnic.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th>Popis</th><th colspan="1">Typická role</th></tr><tr><td>Čas</td><td><p>Komponenta systému, která spouští dávkové úlohy ve stanoveném čase.</p></td><td colspan="1"><p> </p></td></tr><tr><td colspan="1">Geokóding</td><td colspan="1">Služba, která umožňuje transformaci adres na zeměpisné souřadnice.</td><td colspan="1"> </td></tr></tbody></table><h1>Spuštění případu užití</h1><p>UC je spouštěn podle definovaného časového harmonogramu automaticky. Při každém spuštění zpracuje dávku N adres.</p><p> Parametry spuštění úlohy lze nastavit jako <a href="../../../konfiguracni-81592468.html">Konfigurační hodnoty</a>.</p><h1>Vstupní podmínky</h1><p>Nejsou.</p><h1>Základní tok událostí</h1><ol><li>Systém vyhledá adresy míst realizací, likvidačních míst a provozoven, které:<br><ol><li>Buď mají stav geokódingu "negeokódováno",</li><li>nebo mají stav gekódingu "geokódováno automaticky" a příznak změněné adresy = true (viz poznámka).</li></ol></li><li>K těmto adresám se systém pokusí pomocí volání služby geokódingu dohledat souřadnice (<a href="600uc03-83265161.html">EF01: Nedostupná služba geokódingu</a>):<br><ol><li>Pokud jsou souřadnice nalezeny:<br><ol><li>Systém uloží tyto souřadnice k adrese (pokud je nalezeno více výsledků, použije systém první z nich).</li><li>K adrese nastaví stav geokódingu "geokódováno automaticky".</li><li>Zaloguje do transakčního logu jako INFO volání geokódingu (Id adresy, počet vrácených výsledků, popis prvního).</li></ol></li><li>Pokud souřadnice nalezeny nejsou, pak:<br><ol><li>K adrese nastaví stav geokódingu "nenalezeno".</li><li>Zaloguje do transakčního logu jako INFO volání geokódingu (Id adresy, počet vrácených výsledků).</li></ol></li></ol></li></ol><p>Poznámka:</p><ul><li>Mechanismus předpokládá, že při modifikaci tvaru adresy (během importu dat) bude nastaven příznak změněné adresy. Následně bude geokódování zopakováno pro adresy, který byly původně geokódovány automaticky.</li><li>Adresy, jejichž poloha byla upřesněna uživatelsky v aplikaci (stav geokódingu = "geokódováno uživatelsky"), automatický geokóding znovu nezpracovává. </li><li>Předpoklad: Modifikace tvaru adresy ve WinyX odpovídá její opravě nebo doplnění. V případě, že se jedná o zadání jiné adresy, neprovede uživatel ve WinyX editaci, ale zruší původní adresu a založí novou.</li><li>TODO - Při automatické aktualizaci adres by měl proběhnout pro MR, LM, P přepočet aktuálních tras a lokací objednaných služeb (obodobně jako v <a href="#" data-page-title="500UC08: Upravit místo realizace">500UC08: Upravit místo realizace</a>). </li></ul><h1>Alternativní toky událostí</h1><p>Nejsou.</p><h1>Výjimkové toky událostí</h1><h3>EF01: Nedostupná služba geokódingu</h3><p>V případě nedostupnosti geokódingu systém neposílá další požadavky, příslušnou dávku se pokusí zpracovat při dalším spuštění dle časového harmonogramu.</p><h1>Výstupní podmínky</h1><p>K adresám v příslušné dávce je zaznamenám stav geokódingu a souřadnice - pokud jsou nalezeny.</p><h1>Validace</h1><p>Nepopsány.</p><h1>Algoritmy</h1><p>Nepopsány.</p><h1>Uživatelské rozhraní</h1><p>UC je nevizuální.</p><p> </p><h1>Revize</h1><h3>29. 10. 2019: Miroslav Slivoně</h3><table><tbody><tr><th>Odkaz</div></th><th>Stručný popis změny/doplnění</div></th></tr><tr><td colspan="1">Základní tok</td><td colspan="1">Upřesnění pro případ, kdy je vráceno více výsledků. (Současná implementace již takto funguje.)</td></tr></tbody></table>
</div>
</body>
</html>
