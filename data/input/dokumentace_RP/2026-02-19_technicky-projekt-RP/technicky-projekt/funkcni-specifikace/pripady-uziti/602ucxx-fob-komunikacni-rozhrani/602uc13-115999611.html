<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>602UC13: Odeslat konkrétní části souhrnného itineráře trasy na FOB</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je odeslání zprávy na rozhraní aplikace FOB, která obsahuje konkrétní část požadovaného souhrnného itineráře trasy.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">FOB</td><td colspan="1">–</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Přehled aktérů"></a>.</p><h1>Spuštění případu užití</h1><p>FOB zadá požadavek na odeslání konkrétní části souhrnného itineráře trasy, a to jedním z uvedených způsobů:</p><ul><li>FOB odešle požadavek na získání konkrétních části souhrnného itineráře trasy (viz <a href="#" data-page-title="602UC12: Přijmout požadavek na získání konkrétních částí souhrnného itineráře trasy z FOB"></a>).</li></ul><h2>Vstupní podmínky</h2><p>–</p><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Identifikátor objektu</td><td colspan="1">Číslo</td><td colspan="1">Ano</td><td colspan="1">Identifikace objektu (entita FLWW2), na který má být odeslána zpráva.</td><td colspan="1">–</td></tr><tr><td>Identifikátor odpovědní zprávy</td><td>Řetězec</td><td>Ne</td><td>Identifikátor zprávy, na kterou se v rámci tohoto UC odpovídá („request“ zpráva).</td><td>–</td></tr><tr><td>Verze komunikačního protokolu</td><td>Řetězec</td><td>Ano</td><td>Verze, od které se odvíjí struktura obsahu zprávy.</td><td>Jedná se o verzi použité XML obálky pro obsah zprávy (její struktury).</td></tr><tr><td>Identifikátor trasy</td><td>Číslo</td><td>Ano</td><td>Identifikátor trasy.</td><td>Hodnota je natavena dle interního identifikátoru odpovídajícího denního výkonu.</td></tr><tr><td>Datum poslední změny trasy</td><td>Datum a čas (časové razítko)</td><td>Ano</td><td>Datum a čas, ve kterém došlo ke změně souboru s trasou.</td><td>Hodnota je natavena dle data poslední změny odpovídajícího denního výkonu.</td></tr><tr><td>Pořadí části souhrnného itineráře trasy</td><td>Číslo</td><td>Ano</td><td>Pořadové číslo části souhrnného itineráře trasy, která je požadována.</td><td>–</td></tr><tr><td>Část souhrnného itineráře trasy</td><td>Řetězec</td><td>Ano</td><td>Požadovaná část souhrnného itineráře trasy.</td><td>Obsah zprávy je kódován pomocí <a href="https://confluence.radium.cz/display/FLWW2/Protocol+Buffers">Protocol Buffers</a>, předán je pak jako bitové pole (UTF-8).</td></tr><tr><td>Počet částí souhrnného itineráře trasy</td><td>Číslo</td><td>Ano</td><td>Celkový počet částí souhrnného itineráře trasy.</td><td>–</td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Systém odešle zprávu na FOB – spustí <a href="602uc01-98241328.html">602UC01: Odeslat zprávu na FOB</a>, na vstup jsou předány následující informace:<br><ul><li><strong>Identifikátor objektu</strong>: hodnota vstupního parametru <strong>Identifikátor objektu</strong>.</li><li><strong>Typ obsahu zprávy</strong>: FOB_RTSI_PART (viz <a href="../../../datove-modely/datovy-78681044.html">Typ FOB zprávy</a>).</li><li><strong>Obsah zprávy</strong>: viz <a href="602uc13-115999611.html">ALG01: Generovat obsah zprávy</a>.</li><li><strong>Identifikátor odpovědní zprávy</strong>: hodnota vstupního parametru <strong>Identifikátor odpovědní zprávy</strong>.</li><li><strong>Je vyžadováno potvrzení zprávy</strong>: FALSE.</li><li><strong>Verze komunikačního protokolu</strong>: hodnota vstupního parametru <strong>Verze komunikačního protokolu</strong>.</li></ul></li></ol><p>Poznámka: Doručení zprávy s požadovanou částí souhrnného itineráře trasy není aplikací FOB potvrzováno. Pokud aplikaci FOB nějaké části souhrnného itineráře trasy chybí, opětovně si je vyžádá.</p><h1>Alternativní toky událostí</h1><p>–</p><h1>Výjimkové toky událostí</h1><h2>EF01: Generování obsahu zprávy skončilo chybou</h2><h3>Vstupní podmínky</h3><ul><li>Při generování obsahu zprávy došlo k chybě.</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení (MSG_ERR_FOB_PACKET_CONTENT_GENERATE_NOT_SUCCESSFUL, viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>).</li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Nedošlo k odeslání zprávy.</li></ul><h2>EF02: Verze obsahu zprávy není podporována</h2><h3>Vstupní podmínky</h3><ul><li>Na vstupu získaná verze obsahu zprávy  (vstupní parametr <strong>Verze komunikačního protokolu</strong>) není podporována.</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení s uvedenými parametry (viz <a href="../../../systemove-78681299.html">Systémové hlášky</a>):<br><ul><li><strong>Chybové hlášení</strong>: MSG_ERR_FOB_PACKET_VERSION_NOT_SUPPORTED.</li><li><strong>Verze</strong>: hodnota vstupního parametru <strong>Verze komunikačního protokolu</strong>.</li></ul></li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Nedošlo k odeslání zprávy.</li></ul><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Došlo k odeslání zprávy na rozhraní aplikace FOB, která obsahuje konkrétní část požadovaného souhrnného itineráře trasy.</p><h2>Výstupní data</h2><table><tbody><tr><th>Výstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Chybové hlášení</td><td colspan="1">–</td><td colspan="1">Ne</td><td colspan="1">V podstatě se jedná o kód chyby, kvůli které nemohl být dokončen UC.</td><td colspan="1"><p>Informace je předána pouze v případě, kdy nebyly splněny výstupní podmínky tohoto UC.</p></td></tr></tbody></table><h1>Algoritmy</h1><h2>ALG01: Generovat obsah zprávy</h2><p>Pro zajištění zpětné kompatibility je při generování obsahu zprávy vyhodnocována jeho požadovaná verze (vstupní parametr <strong>Verze komunikačního protokolu</strong>).</p><table><tbody><tr><th>Verze komunikačního protokolu</th><th>Verze obsahu zprávy (algoritmus)</th></tr><tr><td>1.0</td><td><a href="602uc13-115999611.html">Verze 1.0</a></td></tr></tbody></table><p>Poznámka: Pokud není požadovaná verze podporována, je vyvolán odpovídající výjimkový tok (viz <a href="602uc13-115999611.html">EF02: Verze obsahu zprávy není podporována</a>).</p><h3>Verze 1.0</h3><p>V rámci zprávy jsou odesílány další potřebné informace, jejich struktura je uvedena dále (formát musí odpovídat standardu XML).</p>truehtml/xml1<p>Popis jednotlivých elementů je uveden v tabulce.</p><table><tbody><tr><th>Element/atribut</div></th><th colspan="1">Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th>Hodnota</div></th><th colspan="1">Poznámka k formátu</div></th><th>Poznámka</div></th></tr><tr><td colspan="1">itineraryPart</td><td colspan="1">–</td><td colspan="1">Ano</td><td colspan="1">Element s informacemi o konkrétní části souhrnného itineráře trasy.</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">routeId</td><td colspan="1">Číslo</td><td colspan="1">Ano</td><td colspan="1">Jedinečný identifikátor trasy.</td><td colspan="1">Hodnota vstupního parametru <strong>Identifikátor trasy</strong>.</td><td colspan="1">–</td><td colspan="1">Identifikátor trasy vychází z interního identifikátoru odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</td></tr><tr><td colspan="1">order</td><td colspan="1">Číslo</td><td colspan="1">Ano</td><td colspan="1">Pořadí konkrétní části souhrnného itineráře trasy.</td><td colspan="1">Hodnota vstupního parametru <strong>Pořadí části souhrnného itineráře trasy</strong>.</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">count</td><td colspan="1">Číslo</td><td colspan="1">Ano</td><td colspan="1">Celkový počet částí souhrnného itineráře trasy.</td><td colspan="1">Hodnota vstupního parametru <strong>Počet částí souhrnného itineráře trasy</strong>.</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">lastMod</td><td colspan="1">Datum a čas</td><td colspan="1">Ano</td><td colspan="1">Datum poslední změny trasy.</td><td colspan="1">Hodnota vstupního parametru Datum poslední změny trasy (hodnota je předána v UTC).</td><td colspan="1">Hodnota je formátována dle standardu <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</td><td colspan="1">Určen především pro vyhodnocení, zda má přihlášené zařízení aktuální verzi trasy. Hodnota odpovídá datu poslední změny odpovídajícího <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>.</td></tr><tr><td colspan="1">file</td><td colspan="1">Řetězec</td><td colspan="1">Ano</td><td colspan="1">Popis o konkrétní části souhrnného itineráře trasy.</td><td colspan="1">Hodnota vstupního parametru <strong>Část souhrnného itineráře trasy</strong>.</td><td colspan="1">Obsah zprávy je kódován pomocí <a href="https://confluence.radium.cz/display/FLWW2/Protocol+Buffers">Protocol Buffers</a>, předán je pak jako bitové pole (UTF-8).</td><td colspan="1">–</td></tr></tbody></table><p>Pro úplnost je doplněn i náhled výsledného paketu, který je odesílán na FOB (zobrazené hodnoty jsou pouze ilustrativní).</p>html/xml1<h1>Validace</h1><p>–</p><h1>Uživatelské rozhraní</h1><p>–</p><h1>Grafický návrh</h1><p>–</p><h1>Revize</h1><p>–</p>
</div>
</body>
</html>
