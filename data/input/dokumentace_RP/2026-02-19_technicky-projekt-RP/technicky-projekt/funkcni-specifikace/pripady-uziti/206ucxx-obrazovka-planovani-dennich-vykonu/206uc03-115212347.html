<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>206UC03: Zobrazit panel mapy objednaných služeb</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je zobrazení panelu s mapou takových objednaných služeb, které jsou právě zobrazeny v rámci panelu s přehledem objednaných služeb stejné obrazovky (viz <a href="#" data-page-title="206UC02: Zobrazit panel přehledu objednaných služeb"></a>). To znamená, že např. nastavení filtru v panelu s přehledem ovlivní množství dostupných záznamů v mapě.</p><p>Poznámka: Použitá mapa vychází z obecné komponenty, tomu odpovídá také její chování (viz <a href="#" data-page-title="700UI01: Komponenty – mapa">700UI01: Komponenty – mapa</a>).</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Uživatel</td><td colspan="1">–</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="../../../high-level-concept/akteri-78680673.html">Aktéři</a>.</p><h1>Spuštění případu užití</h1><p>Uživatel zadá požadavek na zobrazení panelu mapy objednaných služeb, a to jedním z uvedených způsobů:</p><ul><li>Uživatel zobrazí obrazovku plánování denních výkonů (viz <a href="206uc01-114460020.html">206UC01: Zobrazit obrazovku plánování denních výkonů</a>).</li></ul><h2>Vstupní podmínky</h2><p>Uživatel má oprávnění na zobrazení obrazovky plánování denních výkonů (viz <a href="206uc01-114460020.html">206UC01: Zobrazit obrazovku plánování denních výkonů</a>).</p><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1"><p>Objednané služby</p></td><td colspan="1"><a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> (kolekce)</td><td colspan="1">Ano</td><td colspan="1">Objednané služby, které mají být zobrazeny v panelu s mapou (předáno včetně pořadového čísla a barevného značení).</td><td colspan="1">Může být předána prázdná kolekce.</td></tr><tr><td colspan="1">Denní výkony</td><td colspan="1"><a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a> (kolekce)</td><td colspan="1">Ano</td><td colspan="1">Denní výkony, pro které mohou být zobrazeny jejich trajektorie v panelu s mapou (předáno včetně barevného značení).</td><td colspan="1">Může být předána prázdná kolekce.</td></tr><tr><td colspan="1">Režim pro čtení</td><td colspan="1">Boolean</td><td colspan="1">Ano</td><td colspan="1">Informace, zda je možné v rámci panelu provádět změny. Pokud je panel zobrazen pouze ke čtení – TRUE, jinak – FALSE.</td><td colspan="1"><em>V rámci panelu není aktuálně možné provádět žádné změny.</em></td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Systém zobrazí panel přehledu objednaných služeb (viz <a href="206uc03-115212347.html">Uživatelské rozhraní</a>).</li><li>Systém zpřístupní dostupné funkčnosti.</li></ol><h1>Alternativní toky událostí</h1><p>–</p><h1>Výjimkové toky událostí</h1><p>Poznámka: Oprávnění na spuštění případu užití jsou vyhodnocována v nadřazeném UC.</p><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Uživateli byl zobrazen panel s mapou objednaných služeb, ve kterém zobrazené záznamy a dostupné funkce odpovídají jeho uživatelským oprávněním.</p><h2>Výstupní data</h2><p>–</p><h1>Algoritmy</h1><p>–</p><h1>Validace</h1><p>–</p><h1>Uživatelské rozhraní</h1><h2>Drátový diagram</h2><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-5-29 14-4-38.png" data-attachment="true"></p><h2>Přehled UI komponent</h2><table><tbody><tr><th>Prvek</th><th>Skupina</th><th>Poznámka</th></tr><tr><td colspan="1">1</td><td colspan="1"><a href="206uc03-115212347.html">Mapa</a></td><td colspan="1">–</td></tr><tr><td colspan="1">2</td><td colspan="1"><a href="206uc03-115212347.html">Nástrojová lišta</a></td><td colspan="1">–</td></tr></tbody></table><h2>Mapa</h2><p>Mapa slouží k zobrazení polohy <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>, kdy vykreslujeme jak jejich dílčí <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>, tak spojnice mezi nimi. Současně může být vykreslena také trajektorie pro některý z <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> načtených v rámci obrazovky. Pracujeme tedy s následujícími zdroji dat:</p><ul><li><a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> jsou získány na vstupu UC (vstupní parametr <strong>Objednané služby</strong>), přímo v mapě zobrazené informace pak mohou být omezeny následovně:<br><ul><li>Nastavení provedená v <a href="206uc03-115212347.html">nástrojové liště</a> (specifikace dostupných spojnic včetně způsobu vykreslení).</li><li>Filtry nastavené v <a href="206uc02-114460158.html">panelu s přehledem objednaných služeb</a> (dostupné pouze záznamy zobrazené v přehledu – nastavené filtry).</li></ul></li><li><a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> jsou získány na vstupu UC (vstupní parametr <strong>Denní výkony</strong>), přímo v mapě jsou pak zobrazeny pouze následující záznamy:<br><ul><li>Označené záznamy v panelu s přehledem denních výkonů, viz <a href="#" data-page-title="206UC04: Zobrazit panel přehledu denních výkonů"></a> (dostupné jsou pouze záznamy označené v přehledu).</li><li>Pro označený záznam existuje alespoň jedna <a href="../../../datove-modely/datovy-78681044.html">Položka denního výkonu</a> (atribut <strong>Denní výkon</strong> odkazuje na právě zkoumaný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>).</li></ul></li></ul><h3>Vykreslení objednaných služeb</h3><p>Vykreslení <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> je řešeno ve 2 vrstvách – ta první obsahuje odpovídající <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>, které představují jednotlivé body v mapě. Druhou vrstvou jsou spojnice, které tyto body propojují. Způsob zobrazení je pak možné specifikovat také uživatelsky (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>).</p><h4>Vykreslení lokací objednané služby</h4><p>Způsob vykreslení <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je dán jejím typem (viz dále), my pak pro danou <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> hledáme takové <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>, které splňují všechny dále uvedené podmínky zároveň:</p><ul><li>Hodnota atributu <strong>Objednaná služba</strong> odpovídá právě zkoumané <a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a>.</li><li>Hodnota atributu <strong>Provést</strong> je rovna hodnotě <strong>TRUE</strong>.</li><li>Hodnota atributu <strong>Typ lokace</strong> odpovídá jedné u uvedených hodnot (viz <a href="../../../datove-modely/datovy-78681044.html">Typ lokace objednané služby</a>):<br><ul><li>Místo realizace,</li><li>Likvidační místo,</li><li>Výchozí likvidační místo,</li><li>Provozovna,</li><li>Místo dočasného uložení.</li></ul></li></ul><p>Poznámka: Při vykreslení <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a> dochází k jejich agregaci – pokud má být vykresleno více <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a> s totožnými souřadnicemi (atribut Souřadnice), je vykreslena pouze ta první získaná. Ostatní jsou dostupné až v rámci kontextové nabídky shluku lokací (viz <a href="206uc03-115212347.html">Kontextová nabídka shluku lokací objednaných služeb</a>).</p><p>Jak bylo naznačeno, způsob vykreslení <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je dán mj. jejím typem (atribut <strong>Typ lokace</strong>, viz <a href="../../../datove-modely/datovy-78681044.html">Typ lokace objednané služby</a>). Požadované chování je pak uvedeno v tabulce.</p><table><tbody><tr><th>Typ lokace</th><th>Náhled</th><th colspan="1">Vykreslení lokace</th></tr><tr><td>Místo realizace</td><td><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-7 20-6-27.png" data-attachment="true"></p><p>S indikací časového okna…</p><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-7 20-6-14.png" data-attachment="true"></p><p>S indikací data realizace v minulosti…</p><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-7 20-5-59.png" data-attachment="true"></p></td><td colspan="1"><ul><li><strong>Barva</strong>: Konkrétní barva je získána spolu s odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a> na vstupu UC (vstupní parametr Objednané služby).</li><li><strong>Barva textu</strong>: Je použita barva <strong>#FFFFFF</strong>.<br></li><li><strong>Hodnota</strong>: Je zobrazeno pořadové číslo, to je získáno spolu s odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a> na vstupu UC (vstupní parametr Objednané služby).<br><ul><li>Může nastat situace, kdy <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> obsahuje dvě <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> typu Místo realizace (viz <a href="../../../datove-modely/datovy-78681044.html">Typ lokace objednané služby</a>). Nás pak z pohledu vykreslení pořadového čísla zajímají dále uvedené situace:<br><ul><li><a href="../../../datove-modely/datovy-78681044.html">Typ úkonu</a> dané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> je nastaven na hodnotu <strong>Manipulace</strong> (indikace zobrazena vždy).</li><li><a href="../../../datove-modely/datovy-78681044.html">Typ úkonu</a> dané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> je nastaven na hodnotu <strong>Vývoz</strong>, současně se obě obsažená <a href="../../../datove-modely/datovy-78681044.html">Místa realizace</a> liší v <a href="../../../datove-modely/datovy-78681044.html">Adrese</a>.</li></ul></li><li>Pokud se tedy jedná o některou z uvedených situací, je pořadové číslo rozšířeno o indikaci pořadí místa realizace…<br><ul><li>Výchozí (v pořadí první) místo realizace je označeno jako <strong>a</strong> (např. <strong>1a</strong>).</li><li>Cílové (v pořadí následující) místo realizace je označeno jako <strong>b</strong> (např. <strong>1b</strong>).</li></ul></li><li>Poznámka: U nějakým způsobem rozdělných <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> není nutné uvedený případ řešit. Každé místo realizace je umístěno v rámci jiné <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li></ul></li></ul><p>Zobrazení lokace typu Místo realizace může být doplněno o <strong>indikaci časového okna</strong>, chování je následující:</p><ul><li><strong>Je zobrazeno</strong>: Pokud je splněna alespoň jedna z dále uvedených podmínek, je indikace zobrazena.<br><ul><li>Hodnota atributu <strong>Začátek časového okna</strong> je různá od hodnoty <strong>0:00</strong>.</li><li>Hodnota atributu <strong>Konec časového okna</strong> je různá od hodnoty <strong>23:59</strong>.</li></ul></li><li><strong>Barva ikony</strong>: Barva vychází z aktuálního stavu odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (atribut <strong>Stav</strong>, viz <a href="../../../datove-modely/datovy-78681044.html">Stav objednané služby</a>).<br><ul><li><p><strong>K naplánování</strong>: Je použita barva <strong>#009640</strong>.</p></li><li><strong>Jinak</strong>: Barva vychází z informace o splnění časového okna této <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> (atribut <strong>Splněno časové okno</strong>).<br><ul><li><p><strong>TRUE</strong>: Je použita barva <strong>#009640</strong>.</p></li><li><p><strong>FALSE</strong>: Je použita barva <strong>#E30613</strong>.</p></li></ul></li></ul></li><li><p><strong>Barva pozadí</strong>: Je použita barva <strong>#FFFFFF</strong>.</p></li><li><strong>Hodnota</strong>: Je zobrazeno ikona <strong>ra-clock</strong>.</li><li><strong>Umístění</strong>: Pravý horní index.<br></li></ul><p>Zobrazení lokace typu Místo realizace může být doplněno o <strong>indikaci data realizace v minulosti</strong>, chování je následující:</p><ul><li><strong>Je zobrazeno</strong>: Pokud jsou splněny všechny dále uvedené podmínky zároveň, je indikace zobrazena.<ul><li>Hodnota atributu <strong>Datum realizace do</strong> odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> je menší než dnešní datum.</li><li>Hodnota atributu <strong>Stav</strong> odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> nabývá jedné z uvedených hodnot: <strong>K naplánování</strong>, <strong>Naplánovaná</strong> (viz <a href="../../../datove-modely/datovy-78681044.html">Stav objednané služby</a>).</li></ul></li><li><strong>Barva ikony</strong>: Je použita barva <strong>#E30613</strong>.</li><li><p><strong>Barva pozadí</strong>: Je použita barva <strong>#FFFFFF</strong>.<br></p></li><li><strong>Hodnota</strong>: Je zobrazeno ikona <strong>ra-history</strong>.</li><li><strong>Umístění</strong>: Levý horní index.</li></ul></td></tr><tr><td><p>Likvidační místo</p><p>Výchozí likvidační místo</p></td><td><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-7 20-5-16.png" data-attachment="true"></td><td colspan="1"><ul><li><p><strong>Barva</strong>: Je použita barva <strong>#FED201</strong>.</p></li><li><strong>Barva ikony</strong>: Je použita barva <strong>#FFFFFF</strong>.</li><li><strong>Hodnota</strong>: Je zobrazeno ikona <strong>ra-recycle</strong>.</li></ul><p>Poznámka: <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je pro každé <a href="../../../datove-modely/datovy-78681044.html">Likvidační místo</a> vykreslena maximálně jednou (může být obsaženo ve více <a href="../../../datove-modely/datovy-78681044.html">Objednaných službách</a> zároveň).</p></td></tr><tr><td>Provozovna</td><td><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-7 20-5-5.png" data-attachment="true"></td><td colspan="1"><ul><li><p><strong>Barva</strong>: Je použita barva <strong>#757575</strong>.</p></li><li><strong>Barva ikony</strong>: Je použita barva <strong>#FFFFFF</strong>.<strong><br></strong></li><li><strong>Hodnota</strong>: Je zobrazeno ikona <strong>ra-list</strong>.</li></ul><p>Poznámka: <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je pro každou <a href="../../../datove-modely/datovy-78681044.html">Provozovnu</a> vykreslena maximálně jednou (může být obsažena ve více <a href="../../../datove-modely/datovy-78681044.html">Objednaných službách</a> zároveň).</p></td></tr><tr><td>Místo dočasného uložení</td><td><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-7 20-6-45.png" data-attachment="true"></td><td colspan="1"><ul><li><strong>Barva</strong>: Konkrétní barva je získána spolu s odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a> na vstupu UC (vstupní parametr Objednané služby).</li><li><strong>Barva ikony</strong>: Je použita barva <strong>#FFFFFF</strong>.<strong><br></strong></li><li><strong>Hodnota</strong>: Je zobrazeno ikona <strong>ra-group</strong>.</li></ul></td></tr></tbody></table><h5>Kontextová nabídka lokace objednané služby</h5><p>Pro v mapě dostupné <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je dostupná kontextová nabídka, která se zobrazuje ve 2 režimech (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.1):</p><ul><li><strong>Zobrazit vše</strong>: Kontextová nabídka je zobrazena pro všechny aktuálně viditelné <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>.</li><li><strong>Zobrazit výběr</strong>: Kontextová nabídka je viditelná maximálně pro jednu <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a>. K zobrazení dochází po najetí kurzorem myši na danou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a>.</li></ul><p>V rámci kontextové nabídky je pak zobrazena pouze <a href="../../../datove-modely/datovy-78681044.html">Adresa</a> dané <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> (atribut <strong>Adresa</strong>), její formát je následující: <strong>Úplná adresa</strong> (viz <a href="#" data-page-title="Používané formáty zobrazení údajů">Používané formáty zobrazení údajů</a>).</p><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-8 8-43-39.png" data-attachment="true"></p><p>Poznámka: Je použita systémová kontextová nabídka mapové komponenty, chování pak vychází z FLWW2.</p><h5>Indikace překrývajících se lokací objednané služby</h5><p>V praxi může snadno nastat situace, kdy se na malé ploše vyskytuje více <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>, které se překrývají. Uživatel tedy vidí pouze omezené množství informací, což není žádoucí. Uvedený problém pak řešíme zvýraznění takových <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>, které mají ve svém blízkém okolí jinou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a>. Po kliknutí na takto zvýrazněnou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> se zobrazí kontextová nabídka, ve které jsou dostupné všechny <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> v tomto okolí.</p><h6>Získání mezní vzdálenosti</h6><p>Abychom mohli vyhodnotit problematické shluky <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>, musíme definovat mezní vzdálenost, ve které zmíněné shluky vyhodnocovány. Ta je získána jako součin dále uvedených hodnot:</p><ul><li>Měřítko nastavené v rámci mapy, které je vyjádřeno v jednotkách délky (poskytuje knihovna pro zobrazení mapy).</li><li>Koeficient pro určení mezní vzdálenosti vzhledem k nastavenému měřítku mapy: <strong>clusterSizeCoefficient</strong> (viz <a href="#" data-page-title="Konfigurační hodnoty"></a>).</li></ul><h6>Zvýraznění shluku lokací objednaných služeb</h6><p>Při vykreslení mapy dochází k nalezení shluků a zvýraznění odpovídajících <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>, to probíhá následovně:</p><ol><li>Systém získá mezní vzdálenost (viz <a href="206uc03-115212347.html">Získání mezní vzdálenosti</a>).</li><li>Systém nastaví všechny <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a>, které jsou zobrazeny v mapě, jako neoznačené.</li><li>Pro všechny <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a>, které jsou zobrazeny v mapě:<br><ol><li>Pokud je právě zkoumaná <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> označena:<br><ol><li><strong>Skok na krok 3</strong>.</li></ol></li><li>Systém nalezne všechny <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a>, které se vyskytují v okolí právě zkoumané <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> (vzdálenost mezi nimi je menší nebo rovna mezní vzdálenosti).</li><li>Pokud je nalezena alespoň jedna <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>:<br><ol><li>Systém nastaví právě zkoumanou <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> jako označenou.</li><li>Systém nastaví všechny v blízkém okolí nalezené <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a> jako označené (v rámci cyklu je tedy můžeme přeskočit, již jsou označené).</li></ol></li></ol></li><li>Systém graficky zvýrazní všechny označené <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a> (viz dále).</li></ol><p>Poznámka: Pro získání <a href="../../../datove-modely/datovy-78681044.html">Lokací objednané služby</a> v okolí bodu je použito existující řešení, viz <a href="https://github.com/mapbox/leaflet-knn">https://github.com/mapbox/leaflet-knn</a>.</p><p>Samotné zvýraznění v algoritmu označených <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a> je provedeno jejich podbarvením (kruhová oblast).</p><ul><li><strong>Barva</strong>: Je použita barva <strong>#F39753</strong>.</li><li><strong>Průhlednost</strong>: Nastavena <strong>50%</strong> průhlednost.</li></ul><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-8 10-5-50.png" data-attachment="true"></p><p>Poznámka: Samotný způsob zobrazení <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je zachován, dochází pouze k jejímu podbarvení.</p><h6>Kontextová nabídka shluku lokací objednaných služeb</h6><p>Pro získané shluky je pak k dispozici kontextová nabídka obsahující všechny obsažené <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a>. Tu je možné zobrazit kliknutím levým tlačítkem myši na <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a> daného shluku. Její zavření je pak možné provést následovně:</p><ul><li>Stisknutím tlačítka „křížku“ kontextové nabídky.</li><li>Kliknutím do mapy mimo kontextovou nabídku.</li></ul><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-8 11-14-8.png" data-attachment="true"></p><p>Získání <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>, které jsou v kontextové nabídce obsaženy, probíhá obdobně jako jejich zařazování do shluků. Hledáme tedy takové <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a>, které splňují všechny dále uvedené podmínky zároveň:</p><ul><li><a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je právě zobrazena v mapě.</li><li><a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je v blízkém okolí takové <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a>, pro kterou je zobrazována kontextová nabídka (vyhodnoceno dle <strong>clusterSizeCoefficient</strong>, viz <a href="#" data-page-title="Konfigurační hodnoty"></a>).</li></ul><p>Posledním krokem je samotné zobrazení kontextové nabídky, její rozložení si nyní ho popíšeme…</p><ul><li>Jednotlivé <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a> jsou zobrazeny ve formě matice, ta je plněna „po řádcích“.</li><li>Velikost kontextové nabídky se přizpůsobuje svému obsahu (viz náhled dále).<br><ul><li>Maximální počet sloupců matice je nastaven na 5 (následně dochází k zalomení).</li><li>Maximální počet řádků není omezen (při zobrazení více jak 3 řádků je zobrazen posuvník).</li></ul></li><li>Maximální rozměr kontextové nabídky tedy odpovídá matici o 5 sloupcích a 3 řádcích.</li></ul><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-8 11-6-20.png" data-attachment="true"></p><p>Pořadí <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a> v kontextové nabídce je pak dáno odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a>, a to dle řazení nastaveného v jejich přehledu (viz <a href="#" data-page-title="206UC02: Zobrazit panel přehledu objednaných služeb">206UC02: Zobrazit panel přehledu objednaných služeb</a>). Pokud se v rámci kontextové nabídky vyskytuje více <a href="../../../datove-modely/datovy-78681044.html">Lokací (jedné) objednané služby</a>, je jejich řazení dáno pořadím v rámci <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</p><p>Poznámka: V rámci kontextové nabídky nejsou dostupné žádné další interakce.</p><h5>Indikace označených lokací objednané služby</h5><p>Pokud dojde k označení <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, jsou zvýrazněny všechny její v mapě zobrazené <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>. Samotné zvýraznění je pak provedeno podbarvením dané <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> (kruhová oblast).</p><ul><li><strong>Barva</strong>: Je použita barva <strong>#FFFFFF</strong>.</li><li><strong>Průhlednost</strong>: Nastavena <strong>50%</strong> průhlednost.</li></ul><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-6-8 9-3-36.png" data-attachment="true"></p><p>Poznámka: Samotný způsob zobrazení <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> je zachován, dochází pouze k jejímu podbarvení.</p><h4>Vykreslení spojnic</h4><p>Vykreslení spojnic v rámci dané <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> je dáno jejím <a href="../../../datove-modely/datovy-78681044.html">Typem dopravy</a> (atribut <strong>Typ dopravy</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Typ nádoby</a> – atribut <strong>Typ nádoby</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednaná nádoba</a> – atribut <strong>Objednaná nádoba</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednaný úkon</a> – atribut <strong>Objednaná úkon</strong> entity <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a>).</p><ul><li><strong>Hákový nakladač</strong>, <strong>Ramenový nakladač</strong>: Spojnice jsou vykresleny.</li><li><strong>Jinak</strong>: Spojnice vykresleny nejsou.</li></ul><p>Vykreslení spojnic pak probíhá pro takové <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>, které splňují všechny dále uvedené podmínky zároveň:</p><ul><li>Hodnota atributu <strong>Objednaná služba</strong> odpovídá právě zkoumané <a href="../../../datove-modely/datovy-78681044.html">Objednané službě</a>.</li><li>Hodnota atributu <strong>Provést</strong> je rovna hodnotě <strong>TRUE</strong>.</li></ul><p>Posledním krokem je samotné vykreslení spojnic, to probíhá následovně:</p><ol><li>Pokud má být vrstva se spojnicemi vykreslena (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.2):<br><ol><li>Pro všechny <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>, které mají být vykresleny:<br><ol><li>Pokud má být vrstva se spojnicemi vykreslena pouze pro právě označenou <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.3):<br><ol><li>Pokud právě zkoumaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> <strong>není</strong> označena v přehledu (viz <a href="#" data-page-title="206UC02: Zobrazit panel přehledu objednaných služeb">206UC02: Zobrazit panel přehledu objednaných služeb</a>).<br><ol><li>Přechod na krok <strong>1.a</strong> (právě zkoumaná <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> je přeskočena).</li></ol></li></ol></li><li>Systém vykreslí spojnice pro právě zkoumanou <a href="../../../datove-modely/datovy-78681044.html">Objednanou službu</a> – pro všechny odpovídající <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a> (viz dříve):  <br><ol><li>Systém vykreslí spojnici do následující <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>:<br><ul><li><strong>Barva</strong>: Konkrétní barva je získána spolu s odpovídající <a href="../../../datove-modely/datovy-78681044.html">Objednanou službou</a> na vstupu UC (vstupní parametr <strong>Objednané služby</strong>).</li><li><strong>Spojnice</strong>: Způsob vykreslení spojnice je dán nastavením v nástrojové liště (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.4):<br><ul><li><strong>Trajektorie</strong>: Je vykreslena trajektorie (atribut <strong>Trasa do další lokace</strong> právě zkoumané <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>).</li><li><strong>Přímé spojnice</strong>: Je vykreslena přímá spojnice do v pořadí další <strong>viditelné</strong> <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>.<br><ul><li>Poznámka: Takové <a href="../../../datove-modely/datovy-78681044.html">Lokace objednané služby</a>, které nejsou přímo zobrazeny v mapě, jsou v tomto případě ignorovány.</li></ul></li></ul></li></ul></li></ol></li></ol></li></ol></li><li>Jinak je vykreslení vrstvy se spojnicemi potlačeno (vrstva je nastavena jako skrytá):<br></li></ol><p>Stručný popis: Vzhledem k tomu, že je vykreslení spojnic ovlivněno velkým množstvím faktorů, uvedeme také stručné shrnutí uvedeného chování:</p><ul><li>Spojnice mohou být skryty – v takovém případě není vrstva vykreslena vůbec (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.2).</li><li>Spojnice mohou vykresleny jen pro <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> právě označené v přehledu (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.3).</li><li>Spojnice mohou být vykresleny různými způsoby (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 1.4)…<ul><li><strong>Jako „přesné“ trajektorie</strong>: „Realistické“ spojnice jsou vykresleny mezi <strong>všemi</strong> <a href="../../../datove-modely/datovy-78681044.html">Lokacemi objednané služby</a>, které mají být provedeny (atribut <strong>Provést</strong>).</li><li><strong>Jako přímé spojnice</strong>: Přímé spojnice jsou vykresleny pouze mezi v mapě zobrazenými <a href="../../../datove-modely/datovy-78681044.html">Lokacemi objednané služby</a>.</li></ul></li></ul><h3>Vykreslení denních výkonů</h3><p>Vykreslení <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> je řešeno v rámci jediné vrstvy, jedná se pak o trajektorii daného <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a>. Způsob zobrazení je pak možné specifikovat také uživatelsky (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>).</p><ol><li>Pokud má být vrstva vykreslena (viz <a href="206uc03-115212347.html">Nástrojová lišta</a>, komponenta 2):<br><ol><li>Pro všechny <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a>, které mají být vykresleny:<br><ol><li>Systém vykreslí trajektorii <a href="../../../datove-modely/datovy-78681044.html">Denního výkonu</a> dle <a href="206uc05-115213117.html">ALG01: Vykreslit trajektorii denního výkonu</a> (viz <a href="#" data-page-title="206UC05: Zobrazit panel mapy denních výkonů"></a>), na vstup jsou předány následující informace:<br><ul><li><strong>Denní výkon</strong>: Právě zkoumaný <a href="../../../datove-modely/datovy-78681044.html">Denní výkon</a>.</li><li><strong>Barva</strong>: Konkrétní barva je získána spolu s odpovídajícím <a href="../../../datove-modely/datovy-78681044.html">Denním výkonem</a> na vstupu UC (vstupní parametr <strong>Denní výkony</strong>).</li><li>Zobrazit trasu: <em>Odebráno</em>.</li><li>Naznačit směr: <em>Odebráno</em>.</li><li><strong>Je zvýrazněn</strong>: Pokud se jedná o poslední označený <a href="../../../datove-modely/datovy-78681044.html">Denní výkonem</a> v přehledu (viz <a href="#" data-page-title="206UC04: Zobrazit panel přehledu denních výkonů"></a>) – <strong>TRUE</strong>, jinak – <strong>FALSE</strong>.</li></ul></li></ol></li></ol></li><li>Jinak je vykreslení vrstvy potlačeno (vrstva je nastavena jako skrytá):<br><ol><li>Systém zruší vykreslení vrstvy v mapě.</li></ol></li></ol><h2>Nástrojová lišta</h2><p>Nástrojová lišta slouží především ke specifikaci v mapě zobrazených informací (včetně způsobu jejich zobrazení). Chování pak vychází z jejího <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui01-komponenty/700ui01-83266189.html">obecného popisu</a>, k dispozici jsou následující panely:</p><ul><li>Mapové podklady (viz <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui01-komponenty/700ui01-83266189.html">popis</a>),</li><li>Vrstvy (viz dále).</li></ul><h3>Drátový diagram</h3><p><img src="206uc03-zobrazit-panel-mapy-objednanych-sluzeb-115212347_images/image2023-5-30 11-55-6.png" data-attachment="true"></p><h3>Přehled UI komponent</h3><table><tbody><tr><th>Prvek</th><th>Komponenta</th><th colspan="1">Nadpis</th><th>Typ komponenty</th><th colspan="1">Chování</th><th colspan="1">Výchozí stav</th><th colspan="1">Zdrojová data</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">1</td><td colspan="1">Vrstva objednaných služeb</td><td colspan="1">Objednané služby</td><td colspan="1"><p>Položka nástrojové lišty (viz <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui01-komponenty/700ui01-83266189.html">Vrstvy</a>)</p><ul><li>Typ položky: <strong>Rozšířená</strong></li></ul></td><td colspan="1">Položka panelu nástrojové lišty pro nastavení zobrazení <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> v mapě (včetně možnosti skrýt celou vrstvu).</td><td colspan="1">Vrstva je zobrazena</td><td colspan="1">Entita <a href="../../../datove-modely/datovy-78681044.html">Objednaná služba</a> (vstupní parametr Objednané služby).</td><td colspan="1">Zobrazené záznamy mohou být omezeny nastavením v rámci <a href="#" data-page-title="206UC02: Zobrazit panel přehledu objednaných služeb"></a> (nastavení filtrů v přehledu).</td></tr><tr><td colspan="1">1.1</td><td colspan="1">Viditelnost popisků</td><td colspan="1"><p>Ikona – odpovídá aktuálnímu stavu tlačítka:</p><ul><li>stisknuto: <strong>ra-title_full</strong>,</li><li>nestisknuto: <strong>ra-title</strong>.</li></ul></td><td colspan="1">ToggleButton</td><td colspan="1"><p>Tlačítko slouží pro nastavení viditelnosti popisků dostupných <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>.</p><ul><li>Pokud je tlačítko stisknuto, jsou vidět popisky pro všechny zobrazené <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a>.</li><li>Jinak tlačítko stisknuto není, popisky jsou pro všechny <a href="../../../datove-modely/datovy-78681044.html">Lokace objednaných služeb</a> skryty. Jejich zobrazení probíhá až po najetí kurzorem myši na konkrétní <a href="../../../datove-modely/datovy-78681044.html">Lokaci objednané služby</a>.</li></ul></td><td colspan="1">Tlačítko není stisknuto (popisky nejsou zobrazeny)</td><td colspan="1">–</td><td colspan="1">Vychází z chování aplikace FLWW2.</td></tr><tr><td colspan="1">1.2</td><td colspan="1">Zobrazení spojnic</td><td colspan="1">Spojnice</td><td colspan="1">SwitchButton</td><td colspan="1"><p>Tlačítko slouží pro nastavení viditelnosti spojnic mezi lokacemi v rámci <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>.</p><ul><li>Pokud je tlačítko stisknuto, jsou spojnice mezi <a href="../../../datove-modely/datovy-78681044.html">Lokacemi objednaných služeb</a> zobrazeny.</li><li>Jinak tlačítko stisknuto není, spojnice mezi <a href="../../../datove-modely/datovy-78681044.html">Lokacemi objednaných služeb</a> zobrazeny nejsou.</li></ul></td><td colspan="1">Tlačítko je stisknuto (spojnice jsou zobrazeny)</td><td colspan="1">–</td><td colspan="1">Pokud nejsou spojnice zobrazeny, vidí uživatel pouze polohu <a href="../../../datove-modely/datovy-78681044.html">Lokací objednaných služeb</a>.</td></tr><tr><td colspan="1">1.3</td><td colspan="1">Režim zobrazení spojnic</td><td colspan="1">Jen pro označené</td><td colspan="1">SwitchButton</td><td colspan="1"><p>Tlačítko slouží k nastavení režimu zobrazení spojnic na úrovni <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>.</p><ul><li>Pokud je tlačítko stisknuto, jsou zobrazeny spojnice pouze pro právě označené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a> (vyhodnoceno dle <a href="#" data-page-title="206UC02: Zobrazit panel přehledu objednaných služeb">206UC02: Zobrazit panel přehledu objednaných služeb</a>).</li><li>Pokud tlačítko stisknuto není, jsou zobrazeny spojnice pro všechny zobrazené <a href="../../../datove-modely/datovy-78681044.html">Objednané služby</a>.</li></ul></td><td colspan="1">Tlačítko je stisknuto (spojnice jen pro označené záznamy)</td><td colspan="1">–</td><td colspan="1">Pokud nejsou zobrazeny spojnice v rámci <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a> (komponenta 1.2), nemá toto nastavení vliv na aktuální zobrazení spojnic.</td></tr><tr><td colspan="1">1.4</td><td colspan="1">Režim vykreslení spojnic</td><td colspan="1">Naznačit trasu</td><td colspan="1">SwitchButton</td><td colspan="1"><p>Tlačítko slouží k nastavení způsobu vykreslení spojnic na úrovni <a href="../../../datove-modely/datovy-78681044.html">Objednaných služeb</a>.</p><ul><li>Pokud je tlačítko stisknuto, jsou mezi <a href="../../../datove-modely/datovy-78681044.html">Lokacemi objednaných služeb</a> vykresleny „realistické“ spojnice (dle pozemních komunikací).</li><li>Jinak tlačítko stisknuto není, mezi <a href="../../../datove-modely/datovy-78681044.html">Lokacemi objednaných služeb</a> jsou vykresleny přímé spojnice.</li></ul></td><td colspan="1">Tlačítko není stisknuto (zobrazeny přímé spojnice)</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">1.5</td><td colspan="1">Naznačit směr</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1"><em>Odebráno.</em></td></tr><tr><td colspan="1">2</td><td colspan="1">Vrstva denních výkonů</td><td colspan="1">Denní výkony</td><td colspan="1"><p>Položka nástrojové lišty (viz <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui01-komponenty/700ui01-83266189.html">Vrstvy</a>)</p><ul><li>Typ položky: <strong>Základní</strong></li></ul></td><td colspan="1">Položka panelu nástrojové lišty pro nastavení zobrazení <a href="../../../datove-modely/datovy-78681044.html">Denních výkonů</a> v mapě (včetně možnosti skrýt celou vrstvu).</td><td colspan="1">Vrstva je zobrazena</td><td colspan="1">Entita <a href="../../../datove-modely/datovy-78681044.html">Denní výkony</a> (vstupní parametr Denní výkony).</td><td colspan="1">Zobrazené informace vychází z aktuálně označených záznamů v rámci <a href="#" data-page-title="206UC04: Zobrazit panel přehledu denních výkonů"></a>.</td></tr><tr><td colspan="1">2.1</td><td colspan="1">Zobrazit trasu</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1"><em>Odebráno.</em></td></tr><tr><td colspan="1">2.2</td><td colspan="1">Naznačit směr</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1"><em>Odebráno.</em></td></tr><tr><td colspan="1">3</td><td colspan="1">Zobrazit vše</td><td colspan="1">Ikona: <strong>ra-all</strong></td><td colspan="1">Button</td><td colspan="1"><p>Tlačítko slouží pro jednorázové nastavení mapy, po jeho stisknutí jsou provedeny následující akce:</p><ul><li>Vrstva objednaných služeb (komponenta 1): <strong>Vrstva je zobrazena</strong>.</li><li>Viditelnost popisků (komponenta 1.1): <strong>Tlačítko je stisknuto</strong>.</li><li>Zobrazení spojnic (komponenta 1.2): <strong>Tlačítko je stisknuto</strong>.</li><li>Režim zobrazení spojnic (komponenta 1.3): <strong>Tlačítko není stisknuto</strong>.</li><li>Režim vykreslení spojnic (komponenta 1.4): <em><strong>Zachováno stávající nastavení</strong></em>.</li><li>Vrstva denních výkonů (komponenta 2): <strong>Vrstva je zobrazena</strong>.</li></ul></td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td></tr></tbody></table><h2>Chování</h2><h2>Uživatelská nastavení</h2><p>V rámci obrazovky je použita <a href="../../persistence-stavu-ui/uzivatelska-86149256.html">Uživatelská nastavení klienta</a>. Prvky, u kterých je ukládáno uživatelské nastavení, jsou uvedeny ve formě tabulky. Jejich výchozí hodnota pak odpovídá popisu uživatelského rozhraní.</p><table><tbody><tr><th>Funkční celek</th><th>Ukládaná hodnota</th><th>Poznámka</th></tr><tr><td colspan="1"><a href="206uc03-115212347.html">Nástrojová lišta</a></td><td colspan="1">Viditelnost nástrojové lišty</td><td colspan="1">Popis chování uveden samostatně (viz <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui01-komponenty/700ui01-83266189.html">Viditelnost nástrojové lišty</a>).</td></tr><tr><td colspan="1"><a href="206uc03-115212347.html">Nástrojová lišta</a></td><td colspan="1">Nastavení mapového podkladu (včetně barevnosti)</td><td colspan="1">Popis chování uveden samostatně (viz <a href="../../uzivatelske-rozhrani/700uixx-obecne/700ui01-komponenty/700ui01-83266189.html">Mapové podklady</a>).</td></tr><tr><td colspan="1"><a href="206uc03-115212347.html">Nástrojová lišta</a></td><td colspan="1"><p>Nastavení zobrazených vrstev – ukládáno pro následující komponenty:</p><ul><li>Vrstva objednaných služeb (komponenta 1): <strong>viditelnost vrstvy</strong>.</li><li>Viditelnost popisků (komponenta 1.1): <strong>nastavení tlačítka</strong>.</li><li>Zobrazení spojnic (komponenta 1.2): <strong>nastavení tlačítka</strong>.</li><li>Režim zobrazení spojnic (komponenta 1.3): <strong>nastavení tlačítka</strong>.</li><li>Režim vykreslení spojnic (komponenta 1.4): <strong>nastavení tlačítka</strong>.</li><li>Vrstva denních výkonů (komponenta 2): <strong>viditelnost vrstvy</strong>.</li></ul></td><td colspan="1">–</td></tr></tbody></table><h2>Parametry URL</h2><p>Poznámka: Parametry URL jsou řešeny v nadřazeném UC. </p><h1>Grafický návrh</h1><h1>Revize</h1><h2>23. 2. 2024: Tomáš Nadrchal</h2><table><tbody><tr><th>Odkaz</th><th>Stručný popis změny/doplnění</th></tr><tr><td colspan="1"><a href="206uc03-115212347.html">Vykreslení lokací objednané služby</a></td><td colspan="1">Doplněno chování pro nový typ lokace objednané služby (naznačeno růžově).</td></tr></tbody></table><h2>8. 6. 2023: Tomáš Nadrchal</h2><p>Změny oproti stávajícímu chování graficky odlišeny (naznačeno modře).</p>
</div>
</body>
</html>
