<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>ID-023: Převedení rámcových smluv k jiné provozovně</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Požadavek</h1><p>V rámci společnosti KOS (123) existují provozovny, pro které jsou ve WinyX souběžně vytvářeny rámcové smlouvy – v RP je však požadováno, aby pro dvě provozovny probíhalo vytváření objednávek a plánování DV společně. Jedná se pak o následující provozovny:</p><ul><li>2310: Provozovna KOS,</li><li>2320: ??? (aktuálně není v RP zanesena).</li></ul><p>Je tedy žádoucí, aby ve WinyX stále probíhalo oddělené vytváření rámcových smluv, v RP by však měla být k dispozici pouze jedna provozovna, u které budou k dispozici rámcové smlouvy 2 různých provozoven. Při výběru konkrétní rámcové smlouvy by však měla být k dispozici informace, pod kterou z provozoven konkrétní smlouva patří.</p><h1>Aktuální stav</h1><p>Při vytváření objednávky jsou ve formuláři k dispozici pouze takové platné rámcové smlouvy, které patří pod právě zvolenou provozovnu. Pro výběr rámcové smlouvy je pak možné použít modální okno s jejich přehledem, kde je k dispozici informace, pod kterou provozovnu rámcová smlouva patří (viz obrázek).</p><p><img src="id-023-prevedeni-ramcovych-smluv-k-jine-provozovne-88041465_images/image2020-9-14 13-32-31.png" data-attachment="true"></p><p>Jak bylo zmíněno, rámcové smlouvy jsou filtrovány dle provozovny. To však není jediná vazba, kterou musíme na úrovni formuláře objednávky řešit. Dále je tedy uvedena tabulka znázorňující aktuální stav z tohoto pohledu.</p><table><tbody><tr><th>Entita</th><th>Vazba na provozovnu</th><th>Dostačující stav</th><th>Poznámka</th></tr><tr><td>Zákazník</td><td>Není omezeno provozovnou.</td><td></td><td>Dostupné instance entit Osoba zákazníka a Bankovní spojení se odvíjí od konkrétního zákazníka.</td></tr><tr><td>Rámcová smlouva</td><td><p>Je omezeno provozovnou:</p><ul><li>rámcové smlouvy odpovídající provozovny,</li><li>rámcové smlouvy pro nadřazenou provozovnu odpovídající provozovny.</li></ul></td><td></td><td>Jsou tedy k dispozici rámcové smlouvy nastavené provozovny a všechny rámcové smlouvy přiřazené k odpovídající společnosti (nadřazené provozovny).</td></tr><tr><td>Místa realizace</td><td><p>Je omezeno provozovnou:</p><ul><li>Pokud je vybrána rámcová smlouva:<br><ul><li>místa realizace této rámcové smlouvy.</li></ul></li><li>Pokud není vybrána rámcová smlouva:<br><ul><li>místa realizace zákazníka odpovídající provozovny,</li><li>místa realizace zákazníka pro nadřazenou provozovnu odpovídající provozovny.</li></ul></li></ul></td><td></td><td><p>Jsou tedy k dispozici místa realizace zákazníka nastavené provozovny a všechna místa realizace zákazníka přiřazená k odpovídající společnosti (nadřazené provozovny).</p><p>Aktuálně je hodnota atributu Provozovna plněna odpovídající společností (provozovnou první úrovně).</p></td></tr><tr><td>Likvidační místa</td><td><p>Je omezena provozovnou:</p><ul><li>likvidační místa odpovídající provozovny,</li><li>likvidační místa pro nadřazenou provozovnu odpovídající provozovny.</li></ul></td><td></td><td><p>Jsou tedy k dispozici likvidační místa nastavené provozovny a všechna likvidační místa přiřazená k odpovídající společnosti (nadřazené provozovny).</p><p>Dále je vyhodnocován zvolený druh dopadu – likvidační místo ho musí odebírat.</p><p>Aktuálně je hodnota atributu Provozovna plněna odpovídající společností (provozovnou první úrovně).</p></td></tr></tbody></table><p>Dalším kritériem jsou uživatelská oprávnění. V principu by měl uživatel vidět pouze taková data, na která má oprávnění. Pokud je tedy zařazen pouze pod společnost MPG SK, neměl by vidět data společnosti KOS. Zde jsou pak rozlišovány jednotlivé entity i dle toho, zda jsou evidovány na úrovní společnosti, nebo se jedná o centrální číselníky. </p><h1>Návrh řešení</h1><p>Problém je možné řešit na různých místech, jednotlivé přístupy lze i kombinovat. My se budeme pohybovat na těchto 2 úrovních:</p><ul><li>RoadPlan,</li><li>ERP systém (tedy WinyX).</li></ul><p>Cílem je pak především nalézt vhodný směr, kterým se bude řešení požadovaného problému ubírat. Říct si, která omezení konkrétního přístupu jsou akceptovatelná a která nikoliv. Následně může být připraven detailní návrh řešení pro zvolený směr. Důvodem je především značná pracnost nutná k vytvoření detailního návrhu řešení u takto komplikované problematiky.</p><p>Dále jsou tedy uvedeny hrubé návrhy řešení, nad kterými by měla proběhnout diskuze a které nám umožní lépe porozumět složitosti tohoto požadavku.</p><h2>Změna chování na straně WinyX</h2><p>Jednou z možností je úprava na straně WinyX. Ten by předal na rozhraní informace o rámcové smlouvě v takové podobně, jako kdyby se jednalo o rámcovou smlouvu požadované provozovny. Ve WinyX by tedy byly rámcové smlouvy zakládány odděleně, v rámci RP by již byly evidovány společně.</p><p>Poznámka: Upravena by pak musela být i související data.</p><p> V rámci RP není nutné evidovat obě provozovny.</p><p> Není k dispozici informace, která rámcová smlouva patří ke které provozovně. Mohou pak nastat případy, kdy existují rámcové smlouvy se stejným číslem, které ale patří pod různé provozovny (případně nutno rozlišit dle jiného atributu).</p><h2>Změna chování na straně RoadPlan</h2><p>Další možností je řešení na straně RoadPlan. Zde však existují jistá omezení, s kterými je potřeba počítat napříč jednotlivými návrhy řešení. Ty základní si nyní uvedeme.</p><ul><li>Struktura provozoven (organizačních složek) by měla odpovídat struktuře, která je nastavena v rámci skupin objektů ve FLWW2. Důvodem je např. vyhodnocení uživatelských oprávnění. Pokud by tomu tak nebylo, je nutné uživatelům nastavit oprávnění nejen na skupiny objektů, ale přímo i na konkrétní objekty.</li><li>Aby bylo možné pracovat s informacemi konkrétní provozovny, musí být v rámci aplikace tato provozovna dostupná – z toho pak vyplývají určitá omezení. Jedním z nich je např. zobrazení této provozovny v rámci jednotlivých obrazovek (objednávky, denní výkony…).</li></ul><p>Poznámka: Dále jsou uvedeny zatím jen hrubé návrhy, které mohou být dále rozpracovány.</p><h3>Možnost plánovat napříč provozovnami</h3><p>V rámci aplikace bude doplněna možnost plánovat objednané služby napříč provozovnami. Začneme pak stručným popisem tohoto návrhu řešení. </p><ul><li>Objednávky by byly zadávány samostatně pro každou z provozoven.</li><li>Na obrazovce plánování DV by bylo možné načíst i objednané služby i z jiné provozovny.<br><ol><li>Uživatel zadá požadavek na přidání dalších objednaných služeb.</li><li>Systém zobrazí modální okno pro výběr objednaných služeb (je možné vybrat více záznamů).</li><li>Uživatel označí požadované objednané služby a potvrdí jejich výběr.</li><li>Systém načte zvolené objednané služby na obrazovce plánování.</li></ol></li></ul><p>Poznámka: Je nutné uživateli nastavit oprávnění na odpovídající organizační složky ve FLWW2.</p><p> Umožňuje práci napříč provozovnami.</p><p> Zásah do stávající implementace (vyšší pracnost). Nutnost opakované načítat objednané služby (pro každodenní práci nevhodné).</p><h3>Změna chování formuláře objednávky</h3><p>V rámci formuláře objednávky bude provedena revize dostupných rámcových smluv. Aktuální chování je následující – dostupné jsou následující rámcové smlouvy:</p><ul><li>rámcová smlouva je vytvořena pro ve formuláři nastavenou provozovnu,</li><li>rámcová smlouva je vytvořena přímo pro společnost (provozovnu první úrovně), pod kterou je zařazena ve formuláři nastavená provozovna.</li></ul><p>Nově by byla podmínky koncipovány následovně – dostupné budou následující rámcové smlouvy:</p><ul><li>rámcová smlouva je vytvořena pro každou provozovnu, která spadá pod společnost (provozovnu první úrovně), pod kterou je zařazena ve formuláři nastavená provozovna.</li></ul><p> Není nutné opakované načítat objednané služby na obrazovce plánování (viz <a href="id-88041465.html">Možnost plánovat napříč provozovnami</a>).</p><p> Zásah do stávající implementace (vyšší pracnost). Nevhodné pro uživatele ostatních provozoven – dispečer v Sebedražie by viděl smlouvy pro celou společnost MPG SK.</p><h2>Změna chování na obou stranách</h2><p>Poslední z uvedených možností je kombinace, kdy budou změny provedeny na obou úrovních – jak v rámci RP, tak na straně WinyX. Zamýšlené chování si nyní po částech představíme.</p><table><tbody><tr><th>Místo změny</th><th>Provedené změny</th><th colspan="1">Důvod změny</th><th>Poznámka</th></tr><tr><td>Obecně</td><td>Změna úrovně, na které se vyskytuje druhá ze zmíněných provozoven (2320). Ta by se stala „potomkem“ první zmíněné provozovny (2310).</td><td colspan="1">Druhá ze zmíněných provozoven by se nenabízela v rámci jednotlivých modulů (objednávky, denní výkony…). V rámci těchto nabídek se totiž nabízí pouze provozovny 2 úrovně.</td><td>Změnu by pak bylo nutné provést nejen v rámci RP a FLWW2 (pravděpodobně pak i ve WinyX, viz dále).</td></tr><tr><td>WinX</td><td>Kromě zmíněné změny úrovně provozovny může zahrnovat i další akce s tím spojené.</td><td colspan="1">Struktura by měla odpovídat té ve FLWW2, ale z pohledu synchronizace nemá vliv.</td><td>Možnost této změny vyžaduje hlubší znalost fungování WinyX. Stejně tak i rozsah těchto změn.</td></tr><tr><td>RoadPlan</td><td><p>Revize dostupnosti „navazujících“ instancí entit v rámci jednotlivých obrazovek aplikace:</p><ul><li>rámcové smlouvy,</li><li>likvidační místa,</li><li>místa realizace,</li><li>…</li></ul><p>Uživatel by pak měl k dispozici nejen instance pro svou provozovnu, ale i pro všechny podřízené provozovny.</p></td><td colspan="1">Uživatel by měl dostupné potřebné informace z obou provozoven, podmínkou pak samozřejmě je provedení prvního zmíněného opatření (viz „Obecně“).</td><td>Jedná se o obdobnou změnu, která probíhala např. v rámci požadavku <a href="#" data-page-title="ID-015: Dostupnost likvidačních míst dle společností"></a>. Předmětem by pak bylo větší množství entit.</td></tr></tbody></table><h1>Akceptační testy</h1><p>Odvíjí se od zvolené varianty řešení.</p><h1>Poznámka</h1><p>–</p>
</div>
</body>
</html>
