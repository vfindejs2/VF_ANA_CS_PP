<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>ID-068: Revize synchronizace druhů odpadu ve smlouvě</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Požadavek</h1><p>Při vytváří objednávek nastává situace, kdy u některých rámcových smluv není k dispozici žádný druh odpadu – neexistuje žádná aktivní vazba mezi rámcovou smlouvou a druhem odpadu (entita Druh odpadu ve smlouvě). Problém pak vzniká při synchronizaci záznamů této tabulky následovně:</p><ul><li>Záznam uvedeného typu by měl být na rozhraní jasně definován pomocí primárního klíče ve složení <strong>ID rámcové smlouvy</strong> (včetně <strong>ID provozovny</strong>) a <strong>ID druhu odpadu</strong>.</li><li>Zdá se však, že složkou primárního klíče na rozhraní je navíc <strong>ID preferovaného likvidačního místa</strong> (ne vždy je vyplněno) → to znamená, že se v tabulce na rozhraní mohou vyskytovat duplicitní záznamy (z pohledu RoadPlan).</li><li>Z tohoto důvodu pak může nastat situace, kdy jsou některé druhy odpadu ve smlouvě označeny jako odebrané – na rozhraní je více „stejných“ záznamů, v rámci synchronizace je pak vyhodnocován ten neaktivní.</li></ul><p>Poznámka: Dle zákazníka by stačilo chování upravit tak, aby byl v rámci daného záznamu (kombinace ID rámcové smlouvy a ID druhu odpadu) vyhodnocován pouze první záznam s tím, že upřednostňovány by byly záznamy aktivní.</p><h1>Aktuální stav</h1><p>Aktuálně nastávají případy, kdy není pro danou rámcovou smlouvu dostupný žádný aktivní druh odpadu – uvedená situace však neodpovídá skutečnému stavu. Záznamy jsou pak zneplatněny z důvodu nevhodné práce s daty na integračním rozhraní při jejích nahrávání (směr WinyX → integrační rozhraní).</p><h1>Návrh řešení</h1><p>Vzhledem k tomu, že jsou na úrovni synchronizace vyhodnocovány pouze změny, které proběhly od posledního běhu synchronizace (aktuálně 15 minut), nemusela by být navrhovaná změna chování dostačující. Navrhujeme tedy následující řešení:</p><ul><li>Pokud v rámci synchronizace získáme NEAKTIVNÍ záznam s druhem odpadu ve smlouvě, systém vyhodnotí, zda na integračním rozhraní neexistuje také odpovídající AKTIVNÍ záznam.</li><li>Systém tedy zjistí, zda na integračním rozhraní existuje alespoň jeden aktivní záznam se stejným ID rámcové smlouvy (včetně ID provozovny) a ID druhu odpadu.<br><ul><li>Pokud existuje, NENÍ záznam v RoadPlan označen jako neaktivní.</li><li>V opačném případě JE záznam v RoadPlan označen jako neaktivní.</li></ul></li></ul><p>Nutným krokem při implementaci požadavku je provedení synchronizace všech druhů odpadu ve smlouvě, tím docílíme stavu, kdy si data ve WinyX a RoadPlan odpovídají.</p><p>Poznámka: V rámci synchronizace s Helios nebude preferované likvidační místo dále evidováno – nebude k dispozici ani v rámci integrační databáze, ani na úrovni datového modelu aplikace RoadPlan.</p><h1>Akceptační testy</h1><p>Pro splnění požadavku musí být splněny následující testovací scénáře.</p><h2>TC01: Xxx</h2><ol><li>Systém…</li></ol><h1>Poznámka</h1><p>–</p>
</div>
</body>
</html>
