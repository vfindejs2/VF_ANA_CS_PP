<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>ID-095: CEDA routing – revize chování aplikace</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Úvod</h1><p>Spolu s nasazením služeb od společnosti CEDA dostáváme k dispozici kvalitnější a přesnější informace o dopravní síti. To má celou řadu benefitů…</p><ul><li>Z pohledu aplikace RP je to především přesnější výpočet trasy s ohledem na fyzické parametry odpovídajícího vozidla.</li><li>Kvalitnější data jednoduše znamenají minimalizaci případů, kdy je vozidlo směrováno do míst, kterými nedokáže projet.</li><li>Souvisejícím benefitem je možnost specifikace těchto parametrů na úrovni dílčích dotazů pro získání požadované trasy.</li></ul><p>Žádná změna se však neobejde bez negativních dopadů. Ty stěžejní z pohledu aplikace RP souvisí právě se získáním trasy denního výkonu…</p><ul><li>Nastávají situace, kdy je výsledná trasa podstatně delší, než by být mohla. To je typicky způsobeno nastavenými parametry vozidla. Po změně např. jeho hmotnosti je již vrácena uživatelem předpokládaná trasa (tedy bez relativně dlouhé objížďky).</li><li>Dalším problémem je nedostupnost trasy pro zadanou posloupnost lokací. Např. v <strong>Košicích</strong> (Staré Mesto) se nachází místo, které je sice dosažitelné pro nákladní vozidlo, ale cesta zpět již není možná. Kombinace jednosměrek spolu s fyzickým omezením na výšku vozidla neumožňuje odjezd vozidla z oblasti. V tomto případě není trasa vrácena vůbec.</li></ul><p>Z pohledu uživatele se sice jedná o negativní dopad, jak je naznačeno dříve, ale ve skutečnosti je uvedené chování v pořádku. Vozidlo by nemělo být vysláno do oblasti, kterou vzhledem k jeho fyzickým parametrům nemůže projet. </p><h1>Aktuální stav</h1><p>Aktuální implementace neumožňuje specifikaci parametrů vozidla na úrovni dotazu, je společná pro službu jako celek (dodavatelem je OSRM).</p><ul><li>Při nasazení služby pro získání trasy jsou specifikovány fyzické parametry vozidla.</li><li>Tyto parametry jsou společné pro všechna volání této služby.</li></ul><p>Na straně RP tedy neřešíme možnost specifikace parametrů jednotlivých vozidel, což nás omezuje při přechodu na službu od společnosti CEDA.</p><ul><li>Máme k dispozici aparát, který dokáže lépe pracovat s parametry vozidel. Nemáme však dostatek informací, abychom ho mohli smysluplně využít (parametry jsou společné pro celou flotilu).</li><li>Nastávají tedy problematické situace uvedené dříve. Ty ve většině případů souvisí právě se společným nastavením fyzických parametrů vozidla (front press vs. valník).</li></ul><p>Dále se tedy budeme věnovat opatřením, které nám umožní co možná nejvíce využít možnosti přicházející s novým dodavatelem služby pro výpočet trasy.</p><h1>Návrh řešení</h1><p>Než se dostaneme k samotnému návrhu řešení, je třeba zmínit účel tohoto dokumentu…</p><ul><li>Navrhované úpravy chování představují pouze možný směr, jakým je možné se vydat.</li><li>Cílem je potvrzení této představy zákazníkem dle jeho zkušeností z terénu.</li><li>Až na základě toho bude připraven finální návrh řešení.</li></ul><h2>Profily vozidel</h2><p>Hlavní změnou oproti stávajícímu chování je zavedení profilů vozidel (rozměry, hmotnost). K tomu můžeme přistupovat různými způsoby…</p><ul><li>zavedení skupin vozidel se společnými fyzickými parametry,</li><li>specifikace fyzických parametrů na úrovni jednotlivých vozidel,</li><li>odlišení pouze na úrovni typu dopravy (základní varianta).</li></ul><p>Pro úplnost musíme zmínit také jízdu v soupravách, při které dochází k zásadnímu navýšení celkové délky a hmotnosti vozidla (resp. soupravy).</p><ul><li>Použití přívěsu může ovlivnit podobu získané trasy pro daný DV.</li><li>Na úrovni DV dokážeme odlišit použití přívěsu na úrovni lokací.</li><li>Uvedená problematika bude v prvotním návrhu řešena pouze okrajově.</li></ul><p>Uvedené přístupy se pak samozřejmě liší v několika ohledech, ty si stručně popíšeme.</p><ul><li>Složitost řešení – dopad na výslednou pracnost a dobu dodání (dopad na FLWW2, nebo pouze RP).</li><li>Získání informací – nároky na uživatele při zadávání potřebných informací (možnost získání z ERP).</li><li>Granularita informací – přesněji zadané informace by měly mít pozitivní dopad na kvalitu výsledné trasy.</li></ul><p>Nyní se konečně dostáváme k samotnému výpočtu trasy s ohledem na profily vozidel. Chování si představujeme následovně…</p><ul><li>Volání služby pro získání trasy bude doplněno o fyzické parametry vozidla.</li><li>Při výpočtu trasy DV tedy budou nové předány právě informace tohoto typu.</li><li>Pokud budou informace dostupné přímo u vozidla, budou použity pro výpočet trasy.</li><li>V opačném případě využijeme výchozí parametry vozidla pro daný typ dopravy.</li><li>Pokud nebudou dostupné ani ty, použijí se výchozí parametry (aktuální stav).</li></ul><p>Poznámka: Uvedená změna by měla minimalizovat dříve uvedené problémy s výpočtem trasy. Nejedná se však o stoprocentní řešení…</p><ul><li>Vozidla pro svoz odpadu mohou dostat výjimku, která samozřejmě není na úrovni služby pro získání trasy evidována.</li><li>V datech se mohou vyskytovat chyby, jejich oprava pak může zabrat určitý čas (fyzické měření komunikace v terénu).</li><li>Požadovaná oblast jednoduše nemusí být přímo dostupná.</li></ul><p>FOB: Zapomenout pak nesmíme ani na výpočet trasy přímo ve vozidle. Pro úplnost zmíníme poznámky související s vozidlovými tablety.</p><ul><li>Trasa v aplikaci RP se může lišit od té ve FOB – společná je pouze množina lokací (včetně pořadí), oba systémy získávají trasu ve vlastní režii.</li><li>Na úrovni vozidlového tabletu je možné přímo nastavit parametry vozidla pro výpočet trasy (nutné ověřit také kvalitu dat o dopravní síti).</li><li>Zákazník aktuálně požaduje skrytí možnosti nastavit fyzické parametry vozidla ve FOB uživatelem (cílem ale <strong>není</strong> funkčnost nevyužívat).</li></ul><h2>Revize algoritmu pro výpočet trasy</h2><p>Jak bylo naznačeno, mohou nastat situace, kdy trasa DV vrácena nebude. Důvody jsme si popsali dříve. Je tedy vhodné uvedenou situaci nějakým způsobem řešit…</p><ul><li>Trasa jako taková nebude vrácena vůbec, pro zadanou posloupnost bodů není k dispozici.</li><li>Pro jednotlivé lokace DV (jejich dvojice) však ve většině případů dostupná bude.</li></ul><p>Algoritmus pro získání trasy tedy upravíme tak, aby si s uvedenou situací dokázal poradit.</p><ol><li>Dojde k běžnému volání služby pro získání trasy – na jejím vstupu jsou předány všechny lokace DV současně.</li><li>Pokud je trasa vrácena, dochází k ukončení algoritmu – pro DV byla získána požadovaná trasa.</li><li>V opačném případě trasa vrácena nebyla – pokračujeme tedy alternativním způsobem výpočtu trasy:<ol><li>Služba pro získání trasy je volána pro dílčí lokace, jejich dvojice (A-B, B-C, C-D…).</li><li>Algoritmus je ukončen ve chvíli, kdy jsou zpracovány všechny dvojice lokací v DV. </li></ol></li></ol><p>Máme tedy k dispozici alespoň část požadované trasy, vyřešit pak musíme ještě zpracování informací o DV…</p><ul><li>předpokládaná doba jízdy (včetně té kumulativní),</li><li>předpokládaná ujetá vzdálenost (včetně té kumulativní),</li><li>trajektorie získané trasy.</li></ul><p>Potřebná opatření budou řešena až v rámci příprav finálního návrhu řešení, uvedeme jen pár souvisejících poznámek.</p><ul><li>Chybějící úseky budou v rámci trasy ignorovány, nebudou zaneseny do zmíněných výpočtů.</li><li>To bude vhodně naznačeno na uživatelském rozhraní, uživatel musí být upozorněn (viz dále).</li></ul><p>Poznámka: Za zvážení stojí také kombinace více služeb pro získání trasy současně…</p><ul><li>V první řadě bude pro získání trasy využita služba společnosti CEDA.</li><li>Pokud nedojde k vrácení trasy, bude získána pomocí OSRM.</li></ul><h2>Zobrazení informací uživateli</h2><p>Stručně si popíšeme možný způsob, jak předat informaci o nedostupnost trasy uživateli. To je důležité především z těchto důvodů…</p><ul><li>Dispečer musí na první pohled vidět, že mohou nastat problémy při realizaci DV, některé oblasti nemusí být pro odpovídající vozidlo dostupné.</li><li>Důležité pak je také zvýraznění těchto problematických úseků. Dispečer pak bude schopný na danou situaci adekvátně reagovat.</li><li>Alternativní způsob výpočtu trasy může trvat delší dobu, je tedy důležité, aby uživatel znal důvod jeho zpomalení.</li></ul><p>Možná opatření si pak ukážeme na formuláři editace DV. Zde navrhujeme provedené dále uvedených úprav.</p><ol><li>Indikace toho, že trasa nebyla získána běžným způsobem (byl použit alternativní výpočet trasy).</li><li>Označení lokací, u kterých nedošlo k získání trasy (včetně zvýraznění odpovídajících ukazatelů trasy).</li><li>Zvýraznění problematických úseků v mapě (vykreslení odlišným způsobem, než je běžné).</li></ol><p><img src="id-095-ceda-routing-revize-chovani-aplikace-120359128_images/image2024-11-7 8-32-8.png" data-attachment="true"></p><h1>Další postup</h1><p>Uvedený koncept řešení se nyní pokusíme rozdělit na dílčí fáze…</p><ul><li>Hlavním úkolem je ošetření stavů, které jsou z pohledu uživatelů problematické (není vrácena trasa).</li><li>Až následně se budeme věnovat úpravám algoritmu, které umožní efektivní využití CEDA služeb.</li></ul><p>Postupně bychom se tedy věnovali dílčím úpravám aplikace…</p><ol><li><strong>Revize algoritmu pro výpočet trasy</strong> – minimalizace případů, kdy není získána trasa.</li><li><strong>Parciální výpočet trasy </strong>– pokročilé vyhodnocení trasy s ohledem na nedostupné oblasti.</li><li><strong>Zavedení profilů typů dopravy</strong> – základní parametrizace dotazu na výpočet trasy.</li><li><strong>Zavedení profilů vozidel</strong> – pokročilá parametrizace dotazu na výpočet trasy.</li></ol><p>Poznámka: Návrhy jednotlivých fází se mohou vyvíjet s časem, proto bude detailně popsána pouze ta první. U ostatních se zaměříme především na princip chování. Postupem času získáme další poznatky z praxe, které mohou mít vliv výsledný návrh řešení. Zapomenout nesmíme ani na rozvoj služeb na straně CEDA (indikace problémové oblasti na trase, využití informací o povolení vjezdu pro zásobování apod.).</p><h2>Revize algoritmu pro výpočet trasy</h2><p>V první fázi se budeme věnovat úpravě algoritmu pro výpočet trasy, která minimalizuje případy, kdy pro denní výkon není vrácena trasa.</p><ul><li>Při výpočtu trasy budeme pracovat s primární a sekundární službou pro výpočet trasy.</li><li>V případě použití sekundární služby dojde k upozornění uživatele na tuto skutečnost.</li></ul><p>Začneme tedy změnou chování algoritmu pro výpočet trasy…</p><ol><li>Systém odešle požadavek na získání trasy – použije primární službu (CEDA).<br><ol><li>Pokud je vrácen trasa, dochází k provedení návazných akcí (zobrazení trasy, výpočet dílčích ukazatelů). <strong><em>Algoritmus zde končí.</em></strong></li><li>V opačném případě trasa získána není. <strong><em>Algoritmus pokračuje krokem 2</em></strong>.</li></ol></li><li>Systém odešle požadavek na získání trasy – použije sekundární službu (OSRM).<br><ol><li>Pokud je vrácena trasa, dochází k provedení návazných akcí (zobrazení trasy, výpočet dílčích ukazatelů). <strong><em>Algoritmus zde končí.</em></strong><br><ul><li>Současně dochází k upozornění uživatele – je předána informace, že trasa nebyla získána běžným způsobem.</li><li>Způsob, jakým je uživatel informován, je popsán samostatně (viz dále).</li></ul></li><li>V opačném případě trasa získána není. <strong><em>Algoritmus pokračuje krokem 3</em></strong>.<br></li></ol></li><li>Systém nedokáže získat trasu – dochází k upozornění uživatele, že nemohla být získána trasa (viz dále).<ul><li>Nedochází tedy ani k provedení návazných akcí (zobrazení trasy, výpočet dílčích ukazatelů).</li><li>Aktuálně neevidujeme případy, kdy by služba dodavatele OSRM nevrátila alespoň nějakou trasu.</li></ul></li><li>Systém na úrovni denního výkonu uloží informaci o způsobu výpočtu trasy (výčtový typ).</li></ol><p>Informace o nedostupnosti trasy tedy bude odlišena pro 2 základní případy…</p><ul><li>trasa byla získána pomocí sekundární služby (viz krok <strong>2</strong>),</li><li>trasu nebylo možné získat vůbec (viz krok <strong>3</strong>).</li></ul><p>Dle konkrétní situace se liší také související chybové hlášení. </p><ul><li>Sekundární služba: Trasa byla získána pomocí sekundární služby. Některá z oblastí pravděpodobně není dostupná pro tento typ vozidla.</li><li>Nedostupná trasa: Pro denní výkon nebylo možné získat trasu. Některá z oblastí pravděpodobně není dostupná pro tento typ vozidla.</li></ul><p>Nyní si ukážeme, jakým způsobem budou tyto informace předány uživatelům. Začneme u <strong>obrazovky plánování denních výkonů</strong> (M4), indikace bude doplněna na těchto místech…</p><ul><li>panelu s diagramy,</li><li>pokročilý itinerář,</li><li>souhrnný itinerář.</li></ul><p>V panelu s diagramy je indikace hned za identifikací vozidla (viz obrázek).</p><p><img src="id-095-ceda-routing-revize-chovani-aplikace-120359128_images/image2024-11-24 17-29-9.png" data-attachment="true"></p><p>Pro oba itineráře je umístění indikace společné, je k dispozici hned za identifikací vozidla (viz obrázek).</p><p><img src="id-095-ceda-routing-revize-chovani-aplikace-120359128_images/image2024-11-24 17-36-59.png" data-attachment="true"></p><p>Druhým místem, kde budou informace tohoto typu k dispozici, je <strong>formulář editace denního výkonu</strong> (M5). Zde je informace umístěna v patičce formuláře (viz obrázek; informace o trase pak nebudou k dispozici, to na obrázku naznačeno není).</p><p><img src="id-095-ceda-routing-revize-chovani-aplikace-120359128_images/image2024-11-24 17-40-18.png" data-attachment="true"></p><h2>Parciální výpočet trasy</h2><p>Systém se snaží o využití primární služby pro co možná největší část denního výkonu. Pracuje tedy následovně…</p><ol><li>Systém se pokusí získat trasu pro denní výkon jako celek – využívá pouze primární službu pro získání trasy.</li><li>Pokud se mu to nepovede, je trasa denního výkonu zpracována po jednotlivých lokacích (jejich dvojicích).<br><ol><li>Systém se pokusí získat trasu mezi uvedenou dvojicí lokací – využije primární službu pro získání trasy.</li><li>Pokud není trasa získána, pokusí se systém získat trasu jiným způsobem – využije sekundární službu.</li><li>Pokud není trasa získána ani tak, není požadovaná trasa k dispozici.</li></ol></li></ol><p>Systém pak uživatele informuje o kvalitě výsledné trasy. Pokud nastane jedna z dále uvedených situací, je zobrazena indikace problému se získáním trasy:</p><ul><li>část trasy byla získána pomocí sekundární služby,</li><li>část trasy se nepodařilo získat.</li></ul><p>Uživatelské rozhraní pak bude doplněno také o další bližší informace o výsledné trase. Dispečer tedy uvidí, jaká část trasy je problematická (viz ilustrativní obrázek).</p><ol><li>Indikace nedostupnosti trasy pro denní výkon.</li><li>Indikace problematických lokací v tabulce.</li><li>Indikace problematických lokací v mapě.</li></ol><p><img src="id-095-ceda-routing-revize-chovani-aplikace-120359128_images/image2024-11-7 8-32-8.png" data-attachment="true"></p><h2>Zavedení profilů typů dopravy</h2><p>Služba pro získání trasy od společnosti CEDA umožňuje parametrizaci vozidla na úrovni jednotlivých dotazů – každý požadavek na získání trasy může obsahovat jiné parametry vozidla.</p><ul><li>Toho bude využito při získání trasy pro jednotlivé denní výkony, parametry vozidla budou nastaveny dle jejich typu dopravy.</li><li>To by mělo zvýšit kvalitu výsledné trasy bez nutnosti zásahu do dalších aplikací a synchronizace mezi nimi (FLWW2, Helios).</li><li>Za zvážení pak stojí implementace této funkčnosti ještě před fází s <strong>parciálním výpočtem trasy</strong>.</li></ul><p>Při použití sekundární služby pro výpočet trasy (OSRM) pak samozřejmě budou použity výchozí parametry vozidla (není možné je měnit na úrovni dílčích dotazů).</p><h2>Zavedení profilů vozidel</h2><p>Tato část rozšiřuje fázi se <strong>zavedením profilů typů dopravy</strong>, kdy jsou nově k dispozici informace o fyzických parametrech na úrovni jednotlivých vozidel.</p><ul><li>Výsledná trasa je tedy získána na míru danému vozidlu, tomu by měla odpovídat také její kvalita.</li><li>Zde už se však nevyhneme úpravám na straně dalších systémů (FLWW2, Helios).</li></ul>
</div>
</body>
</html>
