<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>ID-043: Možnost nastavit druh dopravy vozidla nezávisle na IdentificationNumber z WinyX</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Požadavek</h1><p>P.Stiksa, e-mail 20.1.2020:</p><p><em>"Dobrý deň, </em><em>poprosil by som Vás o návrh riešenie pre zmenu údaju purpose, ktorý sa na rozhranie dostáva WinyX. Práve na základe tohto údaju z Winyx sú vozidlá rozdelené do jednotlivých skupín. Pri niektorých vozidlách by sme tento údaj potrebovali zmeniť bez jeho zmeny vo WinyX-e.</em>"</p><h1>Aktuální stav</h1><p>Aktuálně je typ dopravy získán na základě interního identifikačního čísla konkrétního vozidla, které je dodáno externím systémem (WinyX). Dle prvních dvou číslic zmíněného čísla dojde k zařazení vozidla pod určitý typ dopravy. Toto interní identifikační číslo pak u několika vozidel (řádově jednotky) neodpovídá skutečnému typu dopravy. Je tedy požadováno, aby bylo možné typ dopravy změnit. </p><p>Zákazníkovi již byly v minulosti nabízeny dvě varianty řešení, ze kterých si nevybral: <a href="../sprava-pozadavku-stara/navrhy-86147199.html">Změna typu dopravy</a>.</p><h1>Návrh řešení</h1><p>Jedná se o kompromisní variantu s nižší pracností implementace, ale také nižším uživatelským komfortem ve srovnání se Správou vozidel v uživatelském rozhraní.</p><p>Na úrovni integrační databáze bude možné změnit výchozí typ dopravy vozidla odvozený od prefixu Vehicle.IdentificationNumber. Takovou úpravu může provést administrátor - podpora Radium, případně kompetentní osoba na straně zákazníka.</p><p>V integrační databázi vznikne mapovací tabulka VehiclePurpose mezi vozidlem (včetně přívěsu) a tzv. "purpose", podle kterého je odvozován typ dopravy:</p><ul><li>VehicleId (int)</li><li>Purpose (nvarchar(10))</li><li>Status (bit)</li><li>Created (datetime)</li><li>LastModified (datetime)</li></ul><p>Možné hodnoty Purpose:</p><ul><li>Pro vozidla viz povolené hodnoty Interní číslo (Purpose) z <a href="../funkcni-specifikace/pripady-uziti/600ucxx-import-dat/600uc02-83265163.html">Převodní můstek interní číslo MPG - typ vozidla</a></li><li>Pro přívěsy viz povolené hodnoty Interní číslo (Purpose) <a href="../funkcni-specifikace/pripady-uziti/600ucxx-import-dat/600uc02-83265163.html">Převodní můstek interní číslo MPG - typ přívěsu</a></li></ul><p><em>Poznámka: Zadávání Purpose umožňuje u přívěsů zachovat možnost využití přívěsu pro více druhů dopravy.</em></p><p>V rámci standardního běhu synchronizace bude se změněnými (dle LastModified) záznamy mapovací tabulky pracováno takto:</p><ul><li>pokud je nalezen platný (status = 1) záznam, pak je příslušnému vozidlu (VehicleId) nastaven daný validní typ dopravy dle VehiclePurpose.Purpose</li><li>pokud k vozidlu takový záznam neexistuje, nebo není platný (status =0) či validní, pak je vozidlu nastaven typ dopravy dle Vehicle.IdentificationNumber (současný mechanismus)</li></ul><p>Synchronizace zpracovává záznamy z tabulky VehicleTransportType také při každé změně záznamu v tabulce Vehicle.</p><h1>Akceptační testy</h1><p>Pro splnění požadavku musí být splněny následující testovací scénáře.</p><h2>TC01: Nastavení specifického typu dopravy</h2><ol><li>Administrátor vloží na integrační rozhraní nový záznam do tabulky VehiclePurpose:<br><ul><li>Zadá WinyxId příslušného vozidla do VehicleId.</li><li>Zadá požadovaný kód Purpose, tak, aby se výsledný typ dopravy lišil od typu dopravy určeného dle standardního mechanismu podle Vehicle.IdentificationNumber.</li><li>Nastaví Status záznamu na hodnotu 1, aktuální datum a čas do systémových atributů Created, LastModified.</li></ul></li><li>Synchronizační komponenta změní typ dopravy vozidla v RoadPlan dle zadané hodnoty Purpose.</li><li>Uživatel v aplikaci ověří, že k požadované změně na specifický typ dopravy došlo.</li><li>Administrátor na integračním rozhraní v tabulce Vehicle:<br><ul><li>Nastaví aktuální datum a čas do systémového atributu LastModified.</li></ul></li><li>Synchronizační komponenta aktualizuje data vozidla, ale typ dopravy zachová dle dat v tabulce VehiclePurpose.</li><li>Uživatel v aplikaci ověří, že vozidlo má nadále specifický typ dopravy.</li></ol><h2>TC02: Odebrání specifického typu dopravy</h2><ol><li>Administrátor na integračním rozhraní v tabulce VehiclePurpose:<br><ul><li>Nastaví Status záznamu na hodnotu 0 a aktuální datum a čas do systémového atributu LastModified.</li></ul></li><li>Synchronizační komponenta změní typ dopravy vozidla v RoadPlan dle standardního mechanismu podle Vehicle.IdentificationNumber.</li><li>Uživatel v aplikaci ověří, že k požadované změně došlo.</li></ol><p>Alternativní scénář:</p><ol><li>Administrátor na integračním rozhraní v tabulce VehiclePurpose:<br><ul><li>Smaže záznam.</li></ul></li><li>Administrátor na integračním rozhraní v tabulce Vehicle:<br><ul><li>Nastaví aktuální datum a čas do systémového atributu LastModified.</li></ul></li><li>Synchronizační komponenta změní typ dopravy vozidla v RoadPlan dle standardního mechanismu podle Vehicle.IdentificationNumber.</li><li>Uživatel v aplikaci ověří, že k požadované změně došlo.</li></ol><h1>Poznámka</h1><p>–</p>
</div>
</body>
</html>
