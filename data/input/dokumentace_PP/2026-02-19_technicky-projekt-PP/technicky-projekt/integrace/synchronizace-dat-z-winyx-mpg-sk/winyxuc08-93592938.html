<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>WinyxUC08: Synchronizovat smlouvy</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je import smluv z DB rozhraní WinyX. Odpovídající entitou v Pasportu je <a href="../../datove-modely/datovy-88033012.html">Objednávka</a>.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Čas</td><td colspan="1">Systém spouští tento UC nepřímo spuštěním jiných UC.</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Přehled aktérů"></a>.</p><h1>Spuštění případů užití</h1><p>Případ užití je spouštěn v rámci <a href="#" data-page-title="WinyxUC01: Zahájit synchronizaci">WinyxUC01: Zahájit synchronizaci</a>.</p><h2>Vstupní podmínky</h2><p>Nejsou.</p><h2>Vstupní data</h2><p>Data entity CustomerContract načtená z DB rozhraní Winyx.</p><h1>Základní tok událostí</h1><ol><li>Systém provede kontolu vstupních dat dle <a href="https://confluence.radium.cz/display/FLWWPAS/WinyxUC08%3A+Synchronizovat+smlouvy#WinyxUC08:Synchronizovatsmlouvy-VAL01:Validacevstupn%C3%ADchdat">VAL01: Validace vstupních dat</a> (<a href="https://confluence.radium.cz/display/FLWWPAS/WinyxUC08%3A+Synchronizovat+smlouvy#WinyxUC08:Synchronizovatsmlouvy-EF01:Nevalidn%C3%ADvstupn%C3%ADdata">EF01: Nevalidní vstupní data</a>).</li><li>Systém takto připravené záznamy předá na rozhraní pro synchronizaci dat aplikace Pasport - zavolá <a href="#" data-page-title="200UC09: Synchronizovat objednávku">200UC09: Synchronizovat objednávku</a>. Na vstupu jsou předány tyto informace:<br><ul><li>Data připravená dle <a href="https://confluence.radium.cz/display/FLWWPAS/WinyxUC08%3A+Synchronizovat+smlouvy#WinyxUC08:Synchronizovatsmlouvy-ALG01:P%C5%99%C3%ADpravavstupn%C3%ADchdat">ALG01: Příprava vstupních dat</a>.<br><ul><li>Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Objednávky</a></li><li>Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Provozovny</a>.</li><li>Číslo objednávky</li><li>Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Zákazníka</a> k Odběrateli</li><li>Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Zákazníka</a> ke Konečnému příjemci</li><li>Platnost od</li><li>Platnost do</li><li>Je aktivní</li></ul></li><li>Zdroj změny: Synchronizace (viz <a href="../../datove-modely/datovy-88033012.html">Zdroj změny</a>)<em>.</em></li></ul></li><li>Systém zapíše do logu informaci o průběhu přenosu. V logu jsou uložena data:<br><ul><li>Datum a čas volání.</li><li>Plná data odchozího požadavku.</li><li>Návratový kód.</li><li>Případná chybová zpráva.</li></ul></li></ol><h1>Alternativní toky události</h1><p>Nejsou.</p><h1>Výjimkové toky událostí</h1><h3>EF01: Nevalidní vstupní data</h3><ol><li>Systém zaloguje informaci o nevalidních vstupních datech:<br><ul><li>Datum a čas.</li><li>Typ entity.</li><li>Identifikace záznamu.</li><li>Typ nalezené chyby.</li></ul></li><li>Systém daný záznam přeskočí a pokračuje ve zpracování.</li></ol><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Proběhlo předání záznamů na rozhraní pro synchronizaci dat. </p><h2>Výstupní data</h2><p>Průběh přenosu byl zalogován.</p><h1>Algoritmy</h1><h2>ALG01: Příprava vstupních dat</h2><p>Objekt přenášený na synchronizační API aplikace Pasport je sestavený z dat na DB rozhraní (viz <a href="../synchronizace-93257926.html">Definice rozhraní</a>)  dle níže uvedeného mapování.</p><p>Odpovídající entitou Pasport je <a href="../../datove-modely/datovy-88033012.html">Objednávka</a>. Povinnost, datový typ a rozsah jsou uvedeny v datovém slovníku.</p><table><tbody><tr><th>Atribut DB rozhraní</th><th colspan="1">Primární klíč</th><th>Atributy Pasport (Objednávka)</th><th>Poznámka</th></tr><tr><td>CustomerContract.Id</td><td colspan="1"></td><td>Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Objednávky</a></td><td> </td></tr><tr><td colspan="1">CustomerContract.OrganizationalUnitId</td><td colspan="1"></td><td colspan="1">Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Provozovny</a>.</td><td colspan="1"> </td></tr><tr><td colspan="1">CustomerContract.Number</td><td colspan="1"> </td><td colspan="1">Číslo objednávky</td><td colspan="1"> </td></tr><tr><td colspan="1">CustomerContract.CustomerId</td><td colspan="1"> </td><td colspan="1">Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Zákazníka</a> k Odběrateli</td><td colspan="1"> </td></tr><tr><td colspan="1">CustomerContract.PurchaserId</td><td colspan="1"> </td><td colspan="1">Externí identifikátor <a href="../../datove-modely/datovy-88033012.html">Zákazníka</a> ke Konečnému příjemci</td><td colspan="1"> </td></tr><tr><td colspan="1">CustomerContract.ValidFrom</td><td colspan="1"> </td><td colspan="1">Platnost od</td><td colspan="1"> </td></tr><tr><td colspan="1">CustomerContract.ValidFrom</td><td colspan="1"> </td><td colspan="1">Platnost do</td><td colspan="1"> </td></tr><tr><td colspan="1">CustomerContract.Status</td><td colspan="1"> </td><td colspan="1">Je aktivní</td><td colspan="1"><p>Odebrání záznamu může být ovlivněno dalšími atributy, důvodem je chování na straně WinyX, který označí ukončenou smlouvu jako odebranou…</p><ol><li>Pokud je v rámci atributu <strong>Status</strong> získána hodnota <strong>0</strong> (FALSE), systém předá následující hodnotu pro atribut <strong>Je aktivní</strong>:<br><ol><li>Pokud je hodnota atributu <strong>State</strong> nastavena na <strong>Ukončená</strong>, je pro atribut <strong>Je aktivní</strong> předána hodnota <strong>1</strong> (TRUE).</li><li>Jinak je pro atribut <strong>Je aktivní</strong> předána přímo hodnota atributu <strong>Status</strong>.</li></ol></li><li>Jinan je pro atribut <strong>Je aktivní</strong> předána přímo hodnota atributu <strong>Status</strong>.</li></ol><p><em>Hodnota atributu <strong>State</strong> není přenášena do Pasport. Aktuálně pak bude využita pro vyhodnocení odebrání záznamu. <strong>Jedná se pak o úpravu specifické synchronizační komponenty pro WinyX.</strong></em></p></td></tr></tbody></table><h1><br>Validace</h1><h2>VAL01: Validace vstupních dat</h2><ul><li>Všechny povinné položky jsou vyplněny.</li><li>Vyplněné položky jsou správného datového typu, v povoleném rozsahu.</li></ul><h1>Revize</h1><h2>1. 2. 2024: Tomáš Nadrchal</h2><table><tbody><tr><th>Odkaz</th><th>Stručný popis změny</th></tr><tr><td colspan="1"><a href="https://confluence.radium.cz/display/FLWWPAS/WinyxUC08%3A+Synchronizovat+smlouvy#WinyxUC08:Synchronizovatsmlouvy-ALG01:P%C5%99%C3%ADpravavstupn%C3%ADchdat">ALG01: Příprava vstupních dat</a></td><td colspan="1">Revize chování při odebírání záznamů (naznačeno modře).</td></tr></tbody></table>
</div>
</body>
</html>
