<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>403UC08: Získat informaci o existenci duplicitního přiřazení poplatníka k nádobě</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je získání informace, zda na vstupu předané přiřazení poplatníka k nádobě již v rámci aplikace nefiguruje (zda k jedné nádobě není v jeden čas přiřazeno více poplatníků). Vyhodnocení pak probíhá na několika úrovních:</p><ul><li>vyhodnocení odkazovaných instancí (nádoba),</li><li>vyhodnocení období, po které je poplatník k nádobě přiřazen,</li><li>vyhodnocována jsou pouze aktivní přiřazení poplatníka k nádobě.</li></ul><p>Poznámka:</p><ul><li>Je možné specifikovat přiřazení poplatníka k nádobě, které není v rámci vyhodnocování bráno v potaz (např. volání tohoto UC při editaci přiřazení).</li><li>Je možné specifikovat, zda bude v rámci vyhodnocování bráno v potaz aktuálně platné přiřazení poplatníka k nádobě (možnost „projít“ validací v případě, kdy bude takovému přiřezaní ukončena platnost).</li><li>Nesmí tedy existovat 2 přiřazení poplatníka k nádobě, která se odkazující na stejné instance (nádoba) a která by se prolínala obdobím svého přiřazení.</li></ul><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Uživatel</td><td colspan="1">–</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Přehled aktérů"></a>.</p><h1>Spuštění případů užití</h1><p>Uživatel zadá požadavek na získání informace o existenci duplicitního přiřazení poplatníka k nádobě, a to jedním z uvedených způsobů:</p><ul><li>Uživatel zadá požadavek na získání informace o existenci duplicitního přiřazení při vytváření přiřazení poplatníka k nádobě (viz <a href="#" data-page-title="304UC07: Založit přiřazení poplatníka k nádobě"></a>).</li><li>Uživatel zadá požadavek na získání informace o existenci duplicitního přiřazení při upravení přiřazení poplatníka k nádobě (viz <a href="#" data-page-title="304UC08: Upravit přiřazení poplatníka k nádobě"></a>).</li><li>Uživatel zadá požadavek na získání informace o existenci duplicitního přiřazení ve formuláři přiřazení poplatníka k nádobě (viz <a href="#" data-page-title="403UC07: Zobrazit formulář přiřazení poplatníka k nádobě"></a>).</li></ul><p>Poznámka: Uvedené případy užití jsou volány až v rámci akce na uživatelském rozhraní, uživatel je tedy nevolá nepřímo. </p><h2>Vstupní podmínky</h2><p>–</p><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Zkoumané přiřazení1</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a></td><td colspan="1">Ano</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>, u kterého dochází k vyhodnocení duplicity.</td><td colspan="1">Na vstupu jsou získány hodnoty <strong>nesystémových</strong> atributů této entity.</td></tr><tr><td colspan="1">Vyloučené přiřazení2</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a></td><td colspan="1">Ne</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>, které je vyňato z vyhodnocení duplicity.</td><td colspan="1">Na vstupu je získána instance této entity, případně její identifikace.</td></tr><tr><td colspan="1">Vyhodnotit aktuální přiřazení</td><td colspan="1">Boolean</td><td colspan="1">Ano</td><td colspan="1"><p>Informace, zda má být v rámci případu užití vyhodnocována existence aktuálně platného přiřazení z pohledu duplicity.</p><ul><li>Pokud má být aktuální přiřazení vyhodnocováno (TRUE), může být aktuálně platné <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> vyňato z vyhodnocení duplicity. V některých případech je pak vráceno na výstupu UC.</li><li>Jinak (FALSE) není vyhodnocení aktuálně platného <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> žádným způsobem omezováno.</li></ul></td><td colspan="1">Cílem je mít možnost projít validací v případě, kdy bude docházet k ukončení platnosti aktuálně platného přiřazení.</td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Pokud má být vyhodnocováno aktuální <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> (vstupní parametr Vyhodnotit aktuální přiřazení je nastaven na TRUE):<br><ol><li>Systém se pokusí nalézt aktuálně platné <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> – hledá takové <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>, které splňuje všechny dále uvedené podmínky zároveň:<br><ul><li>Nejedná se o vyloučené <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>2 získané na vstupu UC (pokud není hodnota k dispozici, není podmínka vyhodnocována).</li><li>Hodnota atributu Je aktivní je rovna TRUE.</li><li>Hodnota atributu Nádoba je rovna hodnotě stejného atributu u zkoumaného <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>1 získaného na vstupu UC.</li><li>Hodnota atributu Platnost do není k dispozici (neomezené období).</li><li>Hodnota atributu Platnost od je menší (starší) než hodnota stejného atributu u zkoumaného <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>1 získaného na vstupu UC.</li></ul></li><li>Pokud je nalezeno aktuálně platné <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> – hodnota výstupního parametru Aktuální přiřazení je nastavena na nalezené <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>.</li><li>Jinak aktuálně platné <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> nalezeno není – hodnota výstupního parametru Aktuální přiřazení je nastavena na NULL.</li></ol></li><li>Jinak aktuální <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> vyhodnocováno není (vstupní parametr Vyhodnotit aktuální přiřazení je nastaven na FALSE) – hodnota výstupního parametru Aktuální přiřazení je nastavena na NULL.</li><li>Pokud existuje alespoň jedna instance entity <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>, která splňuje všechny dále uvedené podmínky, je na výstupu předána hodnota TRUE.<br><ul><li>Nejedná se o aktuálně platné <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> získané v rámci kroku 1 (pokud není hodnota k dispozici, není podmínka vyhodnocována; odpovídá hodnotě výstupního parametru Aktuální přiřazení).</li><li>Nejedná se o vyloučené <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>2 získané na vstupu UC (pokud není hodnota k dispozici, není podmínka vyhodnocována).</li><li>Hodnota atributu Je aktivní je rovna TRUE.</li><li>Hodnota atributu Nádoba je rovna hodnotě stejného atributu u zkoumaného <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>1 získaného na vstupu UC.</li><li>Období přiřazení se prolíná se zkoumaným <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>1 se prolíná – viz <a href="403uc08-94537877.html">ALG01: Porovnání období přiřazení</a> (výsledkem je hodnota TRUE).</li></ul></li><li>Jinak je na výstupu předána hodnota FALSE.</li></ol><p>Ve stručnosti pak může být uvedený tok událostí popsán následovně:</p><ol><li>Pokud má být vyhodnoceno aktuální přiřazení poplatníka k nádobě, systém se pokusí najít takové aktuální přiřazení poplatníka k nádobě s neomezenou platností, které předchází zkoumanému přiřazení (pro uložení změn zkoumaného přiřazení musí dojít k ukončení platnosti aktuálního přiřazení).</li><li>Následně systém provede validaci zkoumaného přiřazení poplatníka k nádobě (aktuální přiřazení poplatníka k nádobě může být z vyhodnocení vyňato).</li><li>V závěru systém předá na výstupu UC výsledek validace a případně i referenci na aktuální přiřazení poplatníka k nádobě (o případné ukončení platnosti se stará nadřazený UC).</li></ol><h1>Alternativní toky událostí</h1><p>–</p><h1>Výjimkové toky událostí</h1><p>–</p><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Byla předána informace o existenci duplicitního <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> pro na vstupu získanou instanci.</p><h2>Výstupní data</h2><table><tbody><tr><th>Výstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Je duplicitní</td><td colspan="1">Boolean</td><td colspan="1">Ano</td><td colspan="1">Informace, zde existuje duplicitní <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>.</td><td colspan="1">Hodnota TRUE je vrácena v případě, kdy je nalezeno duplicitní <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>.</td></tr><tr><td colspan="1">Aktuální přiřazení</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a></td><td colspan="1">Ne</td><td colspan="1">Aktuálně platné <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>, které bylo vyňato z vyhodnocení duplicity.</td><td colspan="1">Jedná se o aktuálně platné přiřazení s neomezenou platností, u kterého musí být ukončena platnost v případě, kdy chceme uložit zkoumané přiřazení získané na vstupu UC.</td></tr></tbody></table><h1>Algoritmy</h1><h2>ALG01: Porovnání období přiřazení</h2><p>V rámci algoritmu dochází k vyhodnocení, zda se dvojice zkoumaných <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> z pohledu jejich období přiřazení prolíná. Výsledkem pak může být jedna z uvedených hodnot:</p><ul><li>TRUE: zkoumaná <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> se prolínají (dochází k překryvu jejich období přiřazení a z tohoto pohledu se jedná o duplicitu, pokud jsou splněny další podmínky).</li><li>FALSE: zkoumaná <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> se neprolínají (nedochází k překryvu jejich období přiřazení a z tohoto pohledu se nejedná o duplicitu).</li></ul><p>Samotné porovnání lze pak rozdělit na 2 skupiny, a to dle nastaveného období přiřazení výchozího1 <a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a>:</p><ul><li>omezené období přiřazení – je nestavena hodnota atributu Platnost od i Platnost do,</li><li>neomezené období přiřazení – je nastavena pouze hodnota atributu Platnost od.</li></ul><p>Dále jsou pak uvedeny jednotlivé podmínky pro vyhodnocení překryvu, a to pro obě zmíněné skupiny. Dojde-li ke splnění alespoň jedné podmínky v rámci odpovídající skupiny, je na výstupu algoritmu předána hodnota TRUE (<a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> se prolínají). V opačném případě je předána hodnota FALSE (<a href="../../../datove-modely/datovy-88033012.html">Přiřazení poplatníka k nádobě</a> se neprolínají).</p><table><tbody><tr><th>Výchozí přiřazení1</th><th>Porovnávané přiřazení2 – podmínka</th><th>Stručný popis</th></tr><tr><td rowspan="2"><ul><li>Platnost od: D1</li><li>Platnost do: D2</li></ul></td><td><ul><li>Platnost od: D3 je menší než D2</li><li>Platnost do: není k dispozici</li></ul></td><td>Období přiřazení porovnávaného přiřazení poplatníka k nádobě začíná před koncem toho výchozího a je neomezené. Platnost do výchozího přiřazení poplatníka k nádobě není nutné porovnávat.</td></tr><tr><td><ul><li>Platnost od: D3 je menší než D2</li><li>Platnost do: D4 je větší než D1</li></ul></td><td>Období přiřazení porovnávaného přiřazení poplatníka k nádobě začíná kdekoliv před koncem výchozího přiřazení poplatníka k nádobě a zároveň končí po začátku období přiřazení výchozího přiřazení poplatníka k nádobě.</td></tr><tr><td rowspan="2"><ul><li>Platnost od: D1</li><li>Platnost do: není k dispozici</li></ul></td><td><ul><li>Platnost od: D3</li><li>Platnost do: není k dispozici</li></ul></td><td>U obou přiřazení poplatníka k nádobě je nastavena neomezené období přiřazení. Platnost od není nutné porovnávat.</td></tr><tr><td><ul><li>Platnost od: D3</li><li>Platnost do: D4 je větší než D1</li></ul></td><td>Období přiřazení porovnávaného přiřazení poplatníka k nádobě končí po začátku výchozího přiřazení poplatníka k nádobě. Platnost od porovnávaného přiřazení poplatníka k nádobě není nutné porovnávat.</td></tr></tbody></table><h1>Validace</h1><p>–</p><h1>Uživatelské rozhraní</h1><p>–</p><h1>Grafický návrh</h1><p>–</p><h1>Revize</h1><h2>4. 7. 2023: Tomáš Nadrchal</h2><p>Revize způsobu vyhodnocení časových intervalů (viz <a href="403uc08-94537877.html">ALG01: Porovnání období přiřazení</a>, naznačeno modře). Nově pracujeme s polouzavřenými intervaly – začátek platnosti je součástí intervalu, jeho konec již ne.</p><p><img src="403uc08-94537877_images/image2023-7-4 8-33-1.png" data-attachment="true"></p>
</div>
</body>
</html>
