<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>406UC02: Exportovat do XLSX</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je export na vstupu získaných informací do souboru ve formátu XLSX (Excel). </p><p>Poznámka: Na vstupu jsou tedy přímo získány záznamy, které chceme exportovat.</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Uživatel</td><td colspan="1">–</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Přehled aktérů"></a>.</p><h1>Spuštění případů užití</h1><p>Uživatel zadá požadavek na export do XLSX, a to jedním z uvedených způsobů:</p><ul><li>Uživatel zadá požadavek na export do XLSX v přehledu nádob pro externí zákazníky (viz <a href="#" data-page-title="400UC14: Zobrazit přehled nádob pro externí zákazníky"></a>).</li></ul><h2>Vstupní podmínky</h2><p>–</p><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Název souboru</td><td colspan="1">Řetězec</td><td colspan="1">Ano</td><td colspan="1">Text, který bude použit jako název výsledného souboru.</td><td colspan="1">–</td></tr><tr><td colspan="1">Název listu</td><td colspan="1">Řetězec</td><td colspan="1">Ano</td><td colspan="1">Text, který bude využit jako název listu, který je obsažen ve výsledném souboru.</td><td colspan="1">–</td></tr><tr><td colspan="1">Řádky</td><td colspan="1">Pole (kolekce)</td><td colspan="1">Ano</td><td colspan="1"><p>Kolekce jednotlivých řádků, které mají být exportovány do XLSX. Každý řádek je pak složen z dílčích položek, kdy každá položka představuje jeden sloupec výsledného XLSX souboru (všechny řádky by měly obsahovat stejný počet položek).</p></td><td colspan="1">Konkrétní způsob implementace je dán externím dodavatelem.</td></tr><tr><td colspan="1">Je hlavička</td><td colspan="1">Boolean</td><td colspan="1">Ano</td><td colspan="1">Informace, zda na vstupu získané záznamy obsahují hlavičku.</td><td colspan="1">Hlavička je graficky odlišena od zbývajících záznamů.</td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Systém zahájí generování XLSX souboru (viz <a href="https://confluence.radium.cz/display/FLWWPAS/406UC02%3A+Exportovat+do+XLSX#id-406UC02:ExportovatdoXLSX-U%C5%BEivatelsk%C3%A9rozhran%C3%AD">Uživatelské rozhraní</a>):<br><ol><li>Systém vytvoří prázdný XLSX soubor, jeho název je následující: vstupní parametr Název souboru.</li><li>Systém vytvoří prázdný list tohoto souboru, jeho název je následující: vstupní parametr Název listu.</li><li>Systém nastaví aktuální buňku tohoto listu pro zápis dat:<br><ul><li>Řádek: 1.</li><li>Sloupec: A.<br></li></ul></li><li>Pro všechny na vstupu získané řádky (vstupní parametr Řádky):<br><ol><li>Pro všechny položky právě zkoumaného řádku:<br><ol><li>Systém vloží obsah právě zkoumané položky do aktuální buňky.</li><li>Systém pokračuje na další sloupec – inkrementuje sloupec u aktuální buňky.</li></ol></li><li>Systém pokračuje na další řádek:<ul><li>inkrementuje řádek u aktuální buňky,</li><li>nastaví sloupec u aktuální buňky na A.</li></ul></li></ol></li><li>Pokud jsou splněny všechny dále uvedené podmínky, systém zvýrazní první řádek souboru (řez písma: tučné).<br><ul><li>Hodnota vstupního parametru Je hlavička je rovna TRUE.</li></ul></li></ol></li><li>Systém dokončí generování XLSX souboru – předá ho na výstupu UC (výstupní parametr Soubor).</li></ol><h1>Alternativní toky událostí</h1><p>–</p><h1>Výjimkové toky událostí</h1><h2>EF01: Generování souboru skončilo chybou</h2><h3>Vstupní podmínky</h3><ul><li>Generování výsledného souboru skončilo chybou.</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení (MSG_ERR_EXPORT_ENDED_WITH_ERROR, viz <a href="../../../systemova-88033342.html">Systémová hlášení</a>).</li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Nebyl vygenerován XLSX soubor.</li></ul><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Byl vygenerován XLSX soubor, ten byl předán na výstupu UC.</p><h2>Výstupní data</h2><table><tbody><tr><th>Výstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Soubor</td><td colspan="1">Soubor (XLSX)</td><td colspan="1">Ano</td><td colspan="1">Výsledný soubor s požadovanými záznamy.</td><td colspan="1">–</td></tr><tr><td colspan="1">Chybové hlášení</td><td colspan="1">–</td><td colspan="1">Ne</td><td colspan="1">V podstatě se jedná o kód chyby, kvůli které nemohl být dokončen UC.</td><td colspan="1"><p>Informace je předána pouze v případě, kdy nebyly splněny výstupní podmínky tohoto UC.</p></td></tr></tbody></table><h1>Algoritmy</h1><p>–</p><h1>Validace</h1><p>–</p><h1>Uživatelské rozhraní</h1><p>Výsledný soubor je generována ve formátu XLSX, tomu odpovídá i popis chování.</p><ul><li>Název výsledného souboru je získán na vstupu UC (vstupní parametr Název souboru).</li><li>K dispozici je pouze jeden list, jeho název je získán na vstupu UC (vstupní parametr Název listu).</li><li>Obsažené záznamy jsou získány na vstupu UC (vstupní parametr Řádky), jejich pořadí a struktura je pak zachována i ve výsledném souboru (viz <a href="https://confluence.radium.cz/display/FLWWPAS/406UC02%3A+Exportovat+do+XLSX#id-406UC02:ExportovatdoXLSX-Z%C3%A1kladn%C3%ADtokud%C3%A1lost%C3%AD">Základní tok událostí</a>).</li><li>Pokud je obsažena i hlavička (hodnota vstupního parametru Je hlavička je rovna TRUE), je první řádek listu graficky zvýrazněn (řez písma: tučné). </li><li>V rámci výsledného souboru není využita možnost uzamčení obsažených informací.</li></ul><h1>Grafický návrh</h1><p><img src="406uc02-exportovat-do-xlsx-105840782_images/image2022-4-6 10-8-32.png" data-attachment="true"></p><h1>Revize</h1><p>–</p>
</div>
</body>
</html>
