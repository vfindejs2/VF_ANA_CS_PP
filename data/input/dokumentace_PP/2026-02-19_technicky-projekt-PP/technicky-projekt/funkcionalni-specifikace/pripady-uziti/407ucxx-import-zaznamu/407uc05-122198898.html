<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>407UC05: Zobrazit formulář pro překopírování interního čísla do evidenčního čísla- uživatelské rozhraní</title>
</head>
<body>
<div class="wiki-content">
<p></p><p> </p><p> </p><h1>Stručný popis, cíl</h1><p>Informace od zákazníka: Většina překlápění a výměn EV a IC bude EV=IC (takže z IC(7) bude překopírováno do EV), ostatní případy budou marginální - případ ala Velký Dur úkol 605.</p><p>Účelem požadavku je odstranit známé nedostatky / doplnit chybějící funkce v současných nástrojích pro řešení importů nádob v MPG SK. Cílem úprav není připravit nástroj, který dokáže ovládat běžný uživatel, i nadále se bude jednat o rozhraní pro administrátory.</p><p>Navrhnout API pro překopírovaní interního čísla do evidenčního čísla nádob z poskytnutého seznamu včetně příslušných validací. Nyní se tyto operace dělají přímo v DB, je s nimi spojeno riziko chyby a operace nejsou standardním způsobem logovány.</p><p> </p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Uživatel</td><td colspan="1"> </td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Přehled aktérů"></a>.</p><h1>Spuštění případů užití</h1><p>Uživatel zadá požadavek  pro překopírovaní  interního čísla do evidenčního čísla a to jedním z uvedených způsobů:</p><ul><li>Uživatel zadá požadavek  pro překopírovaní interního čísla do evidenčního čísla v  přehledu nádob (viz <a href="../400ucxx-sprava-nadob/400uc06-88036373.html">400UC06: Zobrazit přehled nádob</a>).</li><li>Import nádob ze souboru - <strong>název práva</strong>: Překopírování interního čísla do evidenčního čísla<br><br>         <br><br>         <br><br></li></ul><h2>Vstupní podmínky</h2><p>Ke spuštění případu užití jsou nutná následující oprávnění na typ entit (viz <a href="../../../uzivatelska-88033399.html">Uživatelská oprávnění a role</a>):</p><ul><li>Nádoby - modifikace.- je právo na  založení, úpravu a mazání nádoby, navrhuji  přidat možnost pro překopírovaní interního čísla do evidenčního čísla.</li></ul><p>           </p><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Nadpis formuláře</td><td colspan="1">Řetězec</td><td colspan="1">Ano</td><td colspan="1">Nadpis, který je zobrazen v hlavičce formuláře.</td><td colspan="1">–</td></tr></tbody></table><h1>Základní tok událostí</h1><ol><li>Uživatel  otevře modul Nádoby.</li><li>Zobrazí se seznam nádob.</li><li>Uživatel označí aspoň jednu nádobu.</li><li>Uživatel klikne na tlačítko "Překopírovat interní číslo do evidenčního čísla"  (viz <a href="407uc04-122197269.html">Drátový diagram 1).</a></li><li>Systém zobrazí formulář pro překopírovaní interního čísla do evidenčního čísla  (viz <a href="407uc04-122197269.html">Drátový diagram 2</a>).</li><li>Uživatel potvrdí zobrazené  hodnoty – stiskne tlačítko "Potvrdit" pro uložení provedených změn.</li><li>Systém provede validaci nastavených hodnot (viz <a href="407uc04-122197269.html">VAL01:  Kontrola vstupních dat </a>).</li><li>Systém zobrazí výsledky výměny.</li><li>Uživatel potvrdí zobrazené výsledky výměny  stisknutím tlačítka "OK."  (viz <a href="407uc04-122197269.html">Drátový diagram 3</a><a href="407uc04-122197269.html">)</a>.</li><li>Systém na výstupu předá data nastavená v rámci formuláře- zobrazí stejný evidenční číslo jako interní číslo. </li></ol><h2>API pro prokopírování interního čísla do evidenčního čísla</h2><p>Jelikož není k dispozici API pro operace se změnou evidenčního čísla, tak je nutné taky toto API realizovat (do realizace API se operace s evidenčním číslem řeší jen na přímým zásahem DB)</p><p>Pro realizaci nakopírování interního čísla do evidenčního a externího čísla bude vytvořen endpoint:</p><table><tbody><tr><th colspan="1">Popis</div></div></th><th><p>Metoda</p></div></div></th><th colspan="1">Query parametry</div></div></th><th colspan="1"><p>Body</p></div></div></th><th><p>Response</p></div></div></th></tr><tr><td colspan="1"> </td><td>POST</td><td colspan="1"> </td><td colspan="1"><ul><li>list nádob</li></ul></td><td><ul><li>výstupní soubor ve formátu xlsx</li></ul></td></tr></tbody></table><p>Request body:</p><p>{<br>"containerIds": [119245, 119246, 119244]<br>}</p><p><br>Provedení prokopírování</p><ol><li>Pro každou nádobu získanou na vstupu:<br><ol><li>Bude nalezen odpovídající aktivní záznam dle atributu Id.<br><ol><li>Pokud nebude odpovídající aktivní záznam v rámci provozovny nalezen, bude tento záznam zapsán do výstupního excelového souboru do listu "Neúspěšné prokopírováni" s hodnotou chyby, že daný záznam nebyl nalezen a pro daný záznam nebude provedeno prokopírování.</li></ol></li><li>Pro nalezený záznam bude provedena validace, pokud bude validace neúspěšná, bude tento záznam zapsán do výstupního excelového souboru do listu "Neúspěšné prokopírováni" s odpovídající chybou a pro daný záznam nebude provedeno prokopírování. Validace bude provedena následujícím způsobem:<br><ol><li>Bude provedena kontrola, zda daný záznam má nastavenou hodnotu Interního čísla (budoucí Evidenční číslo-povinný atribut)</li><li>Bude provedena kontrola duplicity dle Interního čísla (zda v rámci dané Provozovny neexistuje záznam se stejným Interním číslem)</li><li>Bude provedena kontrola duplicity dle validačního čísle (zda v rámci dané Provozovny neexistuje záznam se stejným evidenčním číslem)</li><li>Bude provedena kontrola, zda v rámci dané Provozovny neexistuje aktivní záznam, jehož hodnota Evidenčního čísla se shoduje s hodnotou Interního čísla aktuálně zkoumaného záznamu.</li></ol></li><li>Pokud byla validace úspěšná bude pro aktuálně zkoumaný záznam provedeno následující:<br><ol><li>Hodnota atributu Evidenční číslo (a všechny související sloupce v databázi, <strong>evidence_number_search a  external_id</strong>) bude nastavena na hodnotu původního Interního čísla.</li><li>Hodnota atributu Evidenční číslo  bude nastavena na hodnotu původního Interního čísla.</li><li>Hodnoty systémových atributů budou nastaveny standartně dle volajícího uživatele a aktuálního času.</li><li>Zdroj změny bude nastaven na Administrátorský zásah.</li><li>Záznam bude zapsán do výstupního excelového souboru do listu "Úspěšné prokopírováni" s aktuálními hodnotami Evidenčního  čísla (po překopírování)</li></ol></li></ol></li><li>Výstupní excelový soubor bude zaslán jako Response.</li></ol><p>Poznámka: Všechny akce budou logovány do aplikačních logů.</p><h1>Alternativní toky událostí</h1><h2>AF01: Stáhnuti výsledků překopírování </h2><h3>Vstupní podmínky</h3><p>Uživatel  stiskne  tlačilo "Stáhnout výsledky překopírování".</p><h3>Tok událostí</h3><ol><li>Alternatívní tok událostí začíná krokem 6.základního toku událostí.</li><li>Uživatel  stiskne tlačilo "Stáhnout výsledky překopírování".</li><li>Systém stáhne soubor s výsledky prokopírovaní. </li></ol><h3>Výstupní podmínky</h3><p>Stáhnouti soubor, bude obsahovat  úspěšně a neúspěšné zpracované nádoby  (viz  )<br> ). </p><p>Výstupní soubor bude obsahovat dva listy: "Úspěšné překopírováno" a "Neúspěšné překopírování".</p><p>Struktura listu Úspěšné prokopírovaní bude následující:</p><p><br></p><table><tbody><tr><th>Entita</th><th colspan="1">Povinná entita</th><th>Atribut</th><th colspan="1">Povinný atribut</th><th colspan="1">Datový typ</th><th colspan="1">Rozsah</th><th colspan="1">Povolené výčtové hodnoty</th><th colspan="1">Poznámka</th></tr><tr><td rowspan="8">Nádoba</td><td rowspan="8">Ano</td><td colspan="1">Evidenčné_číslo</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">20</td><td colspan="1">¯</td><td colspan="1"><p>Hodnota bude rovna novému Evidenčnímu číslu po prokopírování (aktuální Interní číslo)</p></td></tr><tr><td colspan="1">Interné_číslo</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">20</td><td colspan="1">¯</td><td colspan="1"><p>Hodnota interního čísla zůstane stejná </p></td></tr><tr><td colspan="1">Status</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">20</td><td colspan="1">¯</td><td colspan="1">Pro tento list bude hodnota vždy rovna Úspěšně zpracováno</td></tr></tbody></table><p> </p><p>Struktura listu Neúspěšné prokopírovaní bude následující:</p><p> </p><table><tbody><tr><th>Entita</th><th colspan="1">Povinná entita</th><th>Atribut</th><th colspan="1">Povinný atribut</th><th colspan="1">Datový typ</th><th colspan="1">Rozsah</th><th colspan="1">Povolené výčtové hodnoty</th><th colspan="1">Poznámka</th></tr><tr><td rowspan="9">Nádoba</td><td rowspan="9">Ano</td><td colspan="1">Evidenčné_číslo</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">20</td><td colspan="1">¯</td><td colspan="1">Hodnota bude rovna původnímu Evidenčnímu číslu (k prokopírování nedošlo)</td></tr><tr><td colspan="1">Interné_číslo</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">20</td><td colspan="1">¯</td><td colspan="1">Hodnota bude rovna původnímu Internímu číslu (k prokopírování nedošlo)</td></tr><tr><td colspan="1">Status</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">20</td><td colspan="1">¯</td><td colspan="1">Pro tento list bude hodnota vždy rovna Chyba</td></tr><tr><td colspan="1">Chyba</td><td colspan="1">Ano</td><td colspan="1">Řetězec</td><td colspan="1">100</td><td colspan="1">¯</td><td colspan="1">Hodnota konkrétní chyby.</td></tr></tbody></table><p> </p><p><br>Výjimkové toky událostí</p><h2>EF01: Zrušení provedení změn po otevření formuláře  "Překopírování interního čísla do evidenčního čísla"</h2><h3>Vstupní podmínky</h3><ul><li>Uživatel zruší provedené změny – stiskne tlačítko pro zrušení provedených změn ( 2 a 4, které jsou v <a href="407uc04-122197269.html">Drátový diagram 2</a>).</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 3 základního toku událostí.</li><li>Případ užití končí....</li></ol><h3>Výstupní podmínky</h3><ul><li>Na výstupu nebyly předány žádné informace.</li></ul><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Překopírovaní interního čísla do evidenčního čísla.</p><h2>Výstupní data</h2><table><tbody><tr><th>Výstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">záznam o modifikaci instance</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Záznam o modifikaci instance</a></td><td colspan="1">Ano</td><td colspan="1">Záznam o skutečnosti, že proběhlo změna instance.</td><td colspan="1">–</td></tr></tbody></table><p> </p><h1>Algoritmy</h1><p>-</p><p>Validace</p><h2>VAL01:  Kontrola vstupních dat </h2><p>Je provedena kontrola vstupních dat vzhledem k jednotlivým atributům entity <a href="../../../datove-modely/datovy-88033012.html">Nádoba</a> (vstupní parametr Zakládaná nádoba), prováděny jsou pak následující akce:</p><ul><li>kontrola datového typu (hodnota je požadovaného datového typu),</li><li>kontrola rozsahu hodnoty (hodnota se pohybuje v povoleném rozsahu),</li><li>kontrola povinnosti zadání hodnoty (povinné údaje jsou vyplněny),</li><li>kontrola existence odkazované hodnoty (zachování referenční integrity),</li><li>kontrola jedinečnosti v rámci tabulky (hodnota atributu, či kombinace atributů, se nesmí v tabulce opakovat.</li></ul><h2>Drátový diagram 1</h2><p><img src="407uc05-122198898_images/image2025-11-21 10-18-43.png" data-attachment="true"></p><h2>Přehled UI komponent 1</h2><table><tbody><tr><th>Prvek</div></div></th><th>Komponenta</div></div></th><th colspan="1">Nadpis</div></div></th><th>Typ komponenty</div></div></th><th>Příklad hodnoty</div></div></th><th colspan="1">Hodnota</div></div></th><th colspan="1">Výchozí hodnota</div></div></th><th colspan="1">Formát</div></div></th><th colspan="1">Bublinková nápověda</div></div></th><th colspan="1">Zpřístupněná</div></div></th><th colspan="1">Viditelná</div></div></th><th>Chování</div></div></th><th colspan="1">Validace</div></div></th><th colspan="1">Poznámka</div></div></th></tr><tr><td>1</td><td>Překopírovat interní číslo do evidenčního čísla</td><td>Překopírovat interní číslo do evidenčního čísla</td><td><p>Button</p><p>V rámci ovládacího prvku je zobrazena ikona: switch</p></td><td> -</td><td>-</td><td>-</td><td>-</td><td>-</td><td>Po označení nádoby v seznamu nádob</td><td>Po označení nádoby v seznamu nádob</td><td>-</td><td>-</td><td>-</td></tr></tbody></table><p> </p><h2>Drátový diagram 2</h2><p><img src="407uc05-122198898_images/image2025-10-16 12-50-42.png" data-attachment="true"></p><p> </p><p> </p><h2>Přehled UI komponent 2</h2><table><tbody><tr><th>Prvek</div></div></th><th>Komponenta</div></div></th><th colspan="1">Nadpis</div></div></th><th>Typ komponenty</div></div></th><th>Příklad hodnoty</div></div></th><th colspan="1">Hodnota</div></div></th><th colspan="1">Výchozí hodnota</div></div></th><th colspan="1">Formát</div></div></th><th colspan="1">Bublinková nápověda</div></div></th><th colspan="1">Zpřístupněná</div></div></th><th colspan="1">Viditelná</div></div></th><th>Chování</div></div></th><th colspan="1">Validace</div></div></th><th colspan="1">Poznámka</div></div></th></tr><tr><td colspan="1">1</td><td colspan="1">Nadpis formuláře</td><td colspan="1">Překopírování interního čísla do evidenčního čísla</td><td colspan="1">Label</td><td colspan="1">-</td><td colspan="1">Získána na vstupu UC, parametr Nadpis formuláře. </td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">2</td><td colspan="1">Zavření okna</td><td colspan="1">–</td><td colspan="1"><p>Button</p><ul><li>V rámci ovládacího prvku je zobrazena ikona: ra-cross.</li></ul></td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">Vždy</td><td colspan="1">Spustí výjimkový tok <a href="407uc04-122197269.html">EF01: Zrušení provedených změn</a></td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">3</td><td colspan="1">Počet nádob</td><td colspan="1">Vybrané nádoby</td><td colspan="1">Label</td><td colspan="1">8</td><td colspan="1">Získaná označením nádob</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">Vždy</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">4</td><td colspan="1">Zrušení provedených změn</td><td colspan="1">Zrušit</td><td colspan="1"><p>Button</p><ul><li>V rámci ovládacího prvku je zobrazena ikona: ra-cross.</li></ul></td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">Vždy</td><td colspan="1">Spustí výjimkový tok <a href="407uc04-122197269.html">EF01: Zrušení provedených změn</a></td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">5</td><td colspan="1">Potvrzení nastavených hodnot</td><td colspan="1">Potvrdit</td><td colspan="1"><p>Button</p><ul><li>V rámci ovládacího prvku je zobrazena ikona: ra-tick.</li></ul></td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">Vždy</td><td colspan="1">Odpovídá kroku 6 základního toku událostí.</td><td colspan="1">–</td><td colspan="1"><p>–</p><p> </p></td></tr></tbody></table><p> </p><p> </p><h2>Drátový diagram 3</h2><p><img src="407uc05-122198898_images/image2025-11-21 10-12-51.png" data-attachment="true"></p><p> </p><h2>Přehled UI komponent 3</h2><table><tbody><tr><th>Prvek</div></div></th><th>Komponenta</div></div></th><th colspan="1">Nadpis</div></div></th><th>Typ komponenty</div></div></th><th>Příklad hodnoty</div></div></th><th colspan="1">Hodnota</div></div></th><th colspan="1">Výchozí hodnota</div></div></th><th colspan="1">Formát</div></div></th><th colspan="1">Bublinková nápověda</div></div></th><th colspan="1">Zpřístupněná</div></div></th><th colspan="1">Viditelná</div></div></th><th>Chování</div></div></th><th colspan="1">Validace</div></div></th><th colspan="1">Poznámka</div></div></th></tr><tr><td colspan="1">1</td><td colspan="1">Nadpis formuláře</td><td colspan="1">Výsledky překopírováni</td><td colspan="1">Label</td><td colspan="1">Výsledky záměny</td><td colspan="1">Získána na vstupu UC, parametr Nadpis formuláře. </td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">2</td><td colspan="1">Zavření okna</td><td colspan="1">–</td><td colspan="1"><p>Button</p><ul><li>V rámci ovládacího prvku je zobrazena ikona: ra-cross.</li></ul></td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">Vždy</td><td colspan="1">Spustí výjimkový tok <a href="407uc05-122198898.html">EF02: Zrušení provedených změn po převedení prokopírováni </a></td><td colspan="1">–</td><td colspan="1">–</td></tr><tr><td colspan="1">3</td><td colspan="1">Stáhnout výsledky překopírování</td><td colspan="1">Stáhnout výsledky překopírování</td><td colspan="1"><p>Button</p><ul><li>V rámci ovládacího prvku je zobrazena ikona: ra-tick.</li></ul></td><td colspan="1"> -</td><td colspan="1">-</td><td colspan="1">-</td><td colspan="1">-</td><td colspan="1">-</td><td colspan="1">Po stisknutí tlačítka Potvrdit</td><td colspan="1">Po stisknutí tlačítka Potvrdit</td><td colspan="1">Spustí výjimkový tok <a href="407uc05-122198898.html">AF01: Stáhnuti výsledků překopírování </a></td><td colspan="1">-</td><td colspan="1">-</td></tr><tr><td colspan="1">4</td><td colspan="1">Potvrzení nastavených hodnot</td><td colspan="1">OK</td><td colspan="1"><p>Button</p><ul><li>V rámci ovládacího prvku je zobrazena ikona: ra-tick.</li></ul></td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">–</td><td colspan="1">Vždy</td><td colspan="1">Vždy</td><td colspan="1">Odpovídá kroku 9 základního toku událostí.</td><td colspan="1">–</td><td colspan="1"><p>–</p><p> </p></td></tr></tbody></table><p> </p><p> </p><h2>Uživatelská nastavení</h2><p>--</p><h1>Grafický návrh</h1><p>-</p><h1>Revize</h1><h2>21.11.2025 Terezia Psotková</h2><table><tbody><tr><th>Jira</th><th>Odkaz na dokumentaci</th><th colspan="1">Popis</th></tr><tr><td>RADIUMFLWWPAS-676</td><td><ul><li><a href="407uc05-122198898.html">Drátový diagram 1</a></li><li><a href="407uc05-122198898.html">Přehled UI komponent 1</a></li><li><a href="407uc05-122198898.html">Drátový diagram 3</a></li><li><a href="407uc05-122198898.html">Přehled UI komponent 3</a></li><li><a href="407uc05-122198898.html">API pro prokopírování interního čísla do evidenčního</a></li></ul><p> </p></td><td colspan="1"><p>úprava Drátový diagram 1 - změna umístnění tlačítka pro prokopírováni</p><p>Přehled UI komponent 1 - změna typu komponenty na switch</p><p>Drátový diagram 3 - změna diagramu -odstraněni tlačítka pro zrušení<br>Přehled UI komponent 3 - odstraněni tlačítka pro zrušení</p><p>API pro prokopírování interního čísla do evidenčního - Provedení prokopírování bod c iv. Zdroj změny bude nastaven na Administrátorský zásah, ne na uživatelský</p></td></tr></tbody></table><h2>14.11.2025 Terezia Psotková</h2><table><tbody><tr><th>Jira</th><th>Odkaz na dokumentaci</th><th colspan="1">Popis</th></tr><tr><td>RADIUMFLWWPAS-676</td><td><ul><li><a href="407uc05-122198898.html">API pro prokopírování interního čísla do evidenčního</a></li><li><a href="407uc05-122198898.html">AF01: Stáhnuti výsledků překopírování </a><br><br></li></ul></td><td colspan="1"><p>Zaneseno podle dokumentace <a href="#" data-page-title="API pro prohození Evidenčního a Interního čísla"></a></p><p>Api pro prokopírování interního čísla do evidenčního čísla.</p><p>Výsledky prokopírovaní.</p></td></tr></tbody></table><h2>16. 10. 2025: Terézia Psotková</h2><p>RADIUMFLWWPAS-676</p><p> </p>
</div>
</body>
</html>
