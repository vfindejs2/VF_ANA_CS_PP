<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>407UC07: Odebrat nádoby dle importního souboru</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Stručný popis, cíl</h1><p>Cílem případu užití je odebrání nádob (včetně vazeb) dle záznamů dostupných v importním souboru. Jedná se pak o popis odpovídající API metody <strong>POST: initialImport/remove</strong>.</p><p>Poznámka: Typicky se může jednat odebrání chybně importovaných nádob, využit je tedy stejný typ souboru (viz <a href="#" data-page-title="Iniciální importy">Iniciální importy</a>).</p><h1>Seznam aktérů</h1><table><tbody><tr><th>Aktér</th><th colspan="1">Poznámka</th></tr><tr><td colspan="1">Systémový administrátor</td><td colspan="1">V době vzniku UC nebylo požadováno spuštění na UI.</td></tr></tbody></table><p>Poznámka: Úplný přehled aktérů je zobrazen samostatně, viz <a href="#" data-page-title="Přehled aktérů"></a>.</p><h1>Spuštění případů užití</h1><p>Systémový administrátor zadá požadavek na odebrání nádob dle importního souboru (voláním odpovídající API metody).</p><h2>Vstupní podmínky</h2><p>Ke spuštění případu užití jsou nutná následující oprávnění na typ entit (viz <a href="../../../uzivatelska-88033399.html">Uživatelská oprávnění a role</a>):</p><ul><li>Oprávnění nutná ke spuštění <a href="#" data-page-title="301UC03: Odebrat nádobu">301UC03: Odebrat nádobu</a>.</li></ul><h2>Vstupní data</h2><table><tbody><tr><th>Vstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Provozovna</td><td colspan="1"><a href="../../../datove-modely/datovy-88033012.html">Provozovna</a></td><td colspan="1">Ano</td><td colspan="1">Provozovna, v rámci které budou importovány nádoby.</td><td colspan="1">–</td></tr><tr><td colspan="1">Importní soubor</td><td colspan="1">Soubor (XLSX)</td><td colspan="1">Ano</td><td colspan="1">Importní soubor s nádobami k odebrání.</td><td colspan="1">–</td></tr></tbody></table><p>Poznámka: Vstupní data jsou uvedena pro zvýšení přehlednosti. Bližší popis toho, jak uvedené informace získat, je uveden v rámci <a href="407uc07-122202263.html">ALG01: Načíst nádobu k odebrání</a>.</p><h1>Základní tok událostí</h1><ol><li>Systém zahájí zpracování na vstupu získaného souboru (vstupní parametr <strong>Importní soubor</strong>).<br><ol><li>Systém přeskočí první řádek souboru (jedná o řádek s hlavičkou).</li><li>Systém načte aktuální řádek:<br><ol><li>Systém získá evidenční číslo odpovídající <a href="../../../datove-modely/datovy-88033012.html">Nádoby</a> (viz <a href="407uc07-122202263.html">ALG01: Načíst nádobu k odebrání</a>).</li><li>Systém získá odpovídající <a href="../../../datove-modely/datovy-88033012.html">Nádobu</a> – hledá takový záznam, který splňuje všechny dále uvedené podmínky:<br><ul><li>Hodnota atributu <strong>Evidenční číslo</strong> odpovídá získanému evidenčnímu číslu (viz krok <strong>1.b.i</strong>).</li><li>Hodnota atributu <strong>Provozovna</strong> odpovídá na vstupu získané <a href="../../../datove-modely/datovy-88033012.html">Provozovně</a> (vstupní parametr <strong>Provozovna</strong>).</li><li>Hodnota atributu <strong>Je aktivní</strong> je je nastavena na <strong>TRUE</strong>.</li><li><em>Poznámka: K dispozici by měl být max. 1 záznam.</em></li></ul></li><li>Pokud je <a href="../../../datove-modely/datovy-88033012.html">Nádoba</a> k dispozici (viz krok <strong>1.b.ii</strong>), systém provede její odebrání – spustí <a href="#" data-page-title="301UC03: Odebrat nádobu">301UC03: Odebrat nádobu</a>, na vstup jsou předány následující informace:<br><ul><li><strong>Odebíraná nádoba</strong>: získaná <a href="../../../datove-modely/datovy-88033012.html">Nádoba</a> (viz krok <strong>1.b.ii</strong>).</li><li><strong>Zdroj změny</strong>: předána hodnota <strong>Administrátorský zásah</strong> (viz <a href="../../../datove-modely/datovy-88033012.html">Zdroj změny</a>).</li></ul></li></ol></li><li>Systém pokračuje na další řádek (přechod na krok <strong>1.b</strong>).</li></ol></li><li>Systém potvrdí odebrání odpovídajících <a href="../../../datove-modely/datovy-88033012.html">Nádob</a> (případně jejich části, viz <a href="407uc07-122202263.html">AF01: Nenalezena odpovídající nádoba</a>).</li></ol><h1>Alternativní toky událostí</h1><h2>AF01: Nenalezena odpovídající nádoba</h2><p>Alternativní tok události řeší situace, kdy importní soubor obsahuje alespoň jednu <a href="../../../datove-modely/datovy-88033012.html">Nádobu</a>, která není systému k dispozici (dle sledovaných kritérií).</p><ul><li>Je možné buď pokračovat v odebírání nádob, kdy dojde k odebrání pouze takových záznamů, které byly nalezeny.</li><li>Nebo můžeme odebírání přerušit. V takovém případě není odebrána žádná z <a href="../../../datove-modely/datovy-88033012.html">Nádob</a> dostupných v importním souboru.</li></ul><h3>Vstupní podmínky</h3><p>Pro dané evidenční číslo není na úrovni dané <a href="../../../datove-modely/datovy-88033012.html">Provozovny</a> k dispozici žádná aktivní <a href="../../../datove-modely/datovy-88033012.html">Nádoba</a> (viz krok <strong>1.b.ii</strong> základního toku událostí).</p><h3>Tok události</h3><ol><li>Alternativní tok událostí začíná krokem <strong>1.b.ii</strong> základního toku událostí.</li><li>Systém předá nadřazenému UC systémové hlášení <strong>MSG_CONF_REMOVED_CONTAINER_DOESNT_EXISTS</strong> (viz <a href="#" data-page-title="Systémová hlášení">Systémová hlášení</a>).<br><ol><li>Pokud je získána odpověď <strong>Ano</strong>, systém pokračuje ve zpracování importního souboru (návrat ke kroku <strong>1.b.ii</strong> základního toku událostí).</li><li>Jinak je získán odpověď <strong>Ne</strong>…<br><ol><li>Systém zruší import již zpracovaných <a href="../../../datove-modely/datovy-88033012.html">Nádob</a> (pro již zpracované řádky importního souboru).</li><li>Systém předčasně ukončí běh tohoto UC (návrat k nadřazenému případu užití).</li></ol></li></ol></li></ol><p>Poznámka: Systémové hlášení je nadřazenému UC předáno maximálně jednou. Odpověď na něj je společná pro celý importní soubor. </p><p><em>Interní poznámka: Uvedený návrh řešení se může lišit od samotné implementace (optimalizace technického řešení).</em></p><h3>Výstupní podmínky</h3><p>Další zpracování záznamů odpovídá získané reakci na odpovídající systémové hlášení…</p><ul><li>buď pokračujeme v odebírání nádob dle získaného souboru (nenalezené záznamy přeskakujeme),</li><li>nebo je import přerušen (není odebrána nádoba pro žádný ze záznamů importního souboru).</li></ul><h1>Výjimkové toky událostí</h1><h2>EF01: Odkazovaná hodnota není k dispozici</h2><h3>Vstupní podmínky</h3><ul><li>Na vstupu získaná reference se odkazuje na neexistující instanci odpovídající entity (např. provozovna).</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení (MSG_ERR_REFERENCE_NOT_FOUND, viz <a href="../../../systemova-88033342.html">Systémová hlášení</a>).</li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Soubor nebyl importován, nádoby tedy nebyly odebrány.</li></ul><h2>EF02: Import souboru skončil chybou</h2><h3>Vstupní podmínky</h3><ul><li>Import výsledného souboru skončil chybou (obsažené řádky neodpovídají dané struktuře).</li></ul><h3>Tok událostí</h3><ol><li>Výjimkový tok událostí začíná krokem 1 základního toku událostí.</li><li>Systém předá na výstupu UC chybové hlášení (MSG_ERR_IMPORT_ENDED_WITH_ERROR, viz <a href="../../../systemova-88033342.html">Systémová hlášení</a>).</li><li>Případ užití končí.</li></ol><h3>Výstupní podmínky</h3><ul><li>Soubor nebyl importován, nádoby tedy nebyly odebrány.</li></ul><h1>Ukončení případu užití</h1><h2>Výstupní podmínky</h2><p>Bylo provedeno odebrání takových <a href="../../../datove-modely/datovy-88033012.html">Nádob</a>, které byly získány v rámci importního souboru.</p><h2>Výstupní data</h2><table><tbody><tr><th>Výstupní parametr</div></th><th>Datový typ</div></th><th colspan="1">Povinnost</div></th><th>Popis</div></th><th colspan="1">Poznámka</div></th></tr><tr><td colspan="1">Chybové hlášení</td><td colspan="1">–</td><td colspan="1">Ne</td><td colspan="1">V podstatě se jedná o kód chyby, kvůli které nemohl být dokončen UC.</td><td colspan="1"><p>Informace je předána pouze v případě, kdy nebyly splněny výstupní podmínky tohoto UC.</p></td></tr></tbody></table><h1>Algoritmy</h1><h2>ALG01: Načíst nádobu k odebrání</h2><p>Cílem algoritmu je načíst a následně odebrat <a href="../../../datove-modely/datovy-88033012.html">Nádoby</a> získané v importním souboru. Ten je předáván voláním specializovaného API.</p><table><tbody><tr><th>Specifikace volání API</div></div></th><th>Hodnota</div></div></th><th>Poznámka</div></div></th></tr><tr><td>Cesta</td><td><p>/api/initialImport/remove?organizationUnitId={id}</p></td><td>–</td></tr><tr><td>Metoda</td><td>POST</td><td>–</td></tr></tbody></table><p>Na vstupu pak pracujeme s dále uvedeným informacemi:</p><ul><li><strong>organizationUnitId</strong> – identifikátor provozovny předán jako parametr metody (povinný údaj),</li><li><strong>file</strong> – soubor s nádobami ve formátu XLSX předán v rámci form-data (povinný údaj).</li></ul><p>Na úrovni parametru <strong>file</strong> je tedy předán soubor s nádobami…</p><ul><li>Jedná se o XLSX soubor, jeho struktura odpovídá souboru pro iniciální importy nádob (viz <a href="#" data-page-title="Iniciální importy">Iniciální importy</a>). </li><li>V rámci souboru nás zajímá sloupec <strong>Evidenčné číslo</strong> – z něj načítáme hodnotu při získání odpovídající <a href="../../../datove-modely/datovy-88033012.html">Nádoby</a>.  Pro úspěšné mazání nádob, musí být uvedená iba hodnota evidenčního čísla.</li><li>Příklad souboru -</li></ul><p>Autentifikace pak probíhá pomocí bearer tokenu, tedy obdobně jako u importu nádob (viz <a href="#" data-page-title="Iniciální importy">Iniciální importy</a>). </p><h1>Validace</h1><h2>VAL01: Kontrola vstupních dat</h2><p>Je provedena kontrola vstupních dat, která zahrnuje následující akce:</p><ul><li>kontrola existence odkazovaných instancí (viz <a href="407uc07-122202263.html">EF01: Odkazovaná hodnota není k dispozici</a>).</li></ul><p>Poznámka: Importní soubor není součásti této validace, ta probíhá během jeho čtení (viz <a href="407uc07-122202263.html">EF02: Import souboru skončil chybou</a>).</p><h1>Uživatelské rozhraní</h1><p>–</p><h1>Grafický návrh</h1><p>–</p><h1>Revize</h1><h3>06.01.2026: Terézia Psotková</h3><table><tbody><tr><th>Odkaz</div></div></th><th>Stručný popis změny/doplnění</div></div></th><th colspan="1">Jira</div></th></tr><tr><td colspan="1"><p><a href="407uc07-122202263.html">ALG01: Načíst nádobu k odebrání</a></p><p><br></p></td><td colspan="1"><p>Doplnení informací šabloně pro mazání nádob- naznačeno modře</p></td><td colspan="1">RADIUMFLWWPAS-733</td></tr></tbody></table><p>–</p>
</div>
</body>
</html>
