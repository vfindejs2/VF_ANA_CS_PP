<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>Synchronizácia základných entít z FLWW</title>
</head>
<body>
<div class="wiki-content">
<p></p><p>Systém potrebuje mať niektoré dáta z FLWW priamo vo vlastnej databáze. Jedná sa o tieto entity:</p><ul><li>employee</li><li>user</li><li>organizationUnit<ul><li>  pre správne fungovanie všetkých Use Case v systéme Pasport je nutné aby organizačné jednotky mali vyplnený atribút "external_id" (na strane FLWW)</li></ul></li></ul><p> </p><p>Dáta je nutné zabezpečiť v rámci postinštalačnej konfigurácii (<a href="#" data-page-title="Postup postinštalačnej konfigurácie"></a>)</p><p>Tieto dáta sa synchronizujú dvomi spôsobmi:</p><h1>Manuálne</h1><p>Zavolanie requestu na API ktoré zabezpečí synchronizáciu dát</p><table><tbody><tr><th>Metóda</th><th colspan="1">Autentifikácia</th><th>Endpoint</th><th>Query params</th><th>Response</th></tr><tr><td>GET</td><td colspan="1"><p>basic auth</p><p></p></td><td>{{url-BE}}/api/flwwsync</td><td><p><em>name</em> - nepoviný parameter.</p><p>Hodnoty: </p><ul><li>organizationUnit</li><li>employee</li><li>user</li></ul><p>  Ak synchronizujeme entitu "user", je nutné prvé synchronizovať enitity "employee"</p><p> </p><p>Ak sa hodnota nepošle, spraví sa synchronizácia všetkých entít</p></td><td>názov synchronizovanej entity</td></tr></tbody></table><p><strong>   Ak sa volá API s parametrom "name", je nutne spravit nasledovne tri volania API v tomto poradi</strong></p><ol><li>{{url-BE}}/api/flwwsync?name=organizationUnit </li><li>{{url-BE}}/api/flwwsync?name=employee</li><li><p> {{url-BE}}/api/flwwsync?name=user</p></li></ol><p> </p><p>Manuálnu synchronizáciu je možné pustiť kedykoľvek počas behu systému. Napr. pre prípady ak je podozrenie že zlyhala automatizovaná synchronizácia cez FLWW Rabbit</p><h1>Automatizovane</h1><p>Automatizovaná synchronizácia FLWW entít prebieha dvomi spôsobmi:</p><h2>Pomocou FLWW Rabbit</h2><p>Backend komponent je napojený na FLWW Rabbit z ktorého sa synchronizujú vyššie uvedené entity v reálnom čase</p><p>Synchronizácia do systému prebehne len vtedy, ak nastane "create"/"update"/"delete" na nejakej z vyššie uvedených entít.</p><p>Dôležitá info ohľadom integrácie na FLWW je, že sa synchronizujú všetky entity pre tenantov, ktorí sú v systéme</p><p> </p><h2>Job spúšťaný v pravidelných intervaloch</h2><p>Backend v pravidelnom intervale spúšťa job na synchronizáciu vyššie uvedených FLWW entít.</p><ul><li>Názov jobu:  <strong>FLWW_ENTITY_SYNCHRONIZATION</strong></li><li>Čas spustenie jobu:  <strong>03:10 (UTC) </strong>každý deň</li></ul><h3>Logovanie</h3><p>Tento job loguje dva stavy podľa toho či prejde alebo neprejde synchronizácia. </p><p>Vyhľadanie logov v Kibane na základe filtrov:</p><ul><li>filter komponentu:<ul><li>Field: <strong>COMPONENT_NAME</strong></li><li>Operator: <strong>is</strong></li><li>values: <strong>backend</strong></li></ul></li><li>filter správy<ul><li>Field: <strong>msg</strong></li><li>Operator: <strong>is one of</strong></li><li>values: <strong>FLWW_ENTITY_SYNCHRONIZATION</strong></li></ul></li></ul><p>Filter môže vrátiť info a error logy pre daný job.</p><ul><li>info log správa: <strong>Job '<strong>FLWW_ENTITY_SYNCHRONIZATION</strong>' completed successfully</strong></li><li>error log správa: <strong>Job '<strong>FLWW_ENTITY_SYNCHRONIZATION</strong>' failed</strong></li></ul>
</div>
</body>
</html>
