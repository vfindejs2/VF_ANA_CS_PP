<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>Multi-tenant režim</title>
</head>
<body>
<div class="wiki-content">
<p></p><h1>Popis</h1><p>Systém Pasport môže byť prevádzkovaný v jednom z uvedených režimoch:</p><ul><li>nasadenie pre konkrétneho zákazníka → tenanta</li><li>multitenant nasadenie</li></ul><h1>Multitenant režim</h1><p>Termín "tenant" v kontexte systému FLWW znamená "company"</p><p> </p><h2>Používateľské hľadisko</h2><p>Z používateľského hľadiska ide o režim kedy do systému Pasport sa môžu prihlasovať používatelia z viacerých company (company je termín pre spoločnosť v systéme FLWW).</p><p>Vtedy je v rámci login obrazovky prístupný input na zadanie názvy spoločnosti - viď info o prihlasovaní <a href="#" data-page-title="Autentifikácia">Autentifikácia</a>.</p><p>Každý používateľ pracuje len s dátami pre svoju spoločnosť.</p><p> </p><h2>Technické hľadisko</h2><p>Všetky dáta v databáze sú vždy ukladané pre konkrétneho tenanta (atribút "<strong>tenant_id</strong>"), aby bolo zabezpečené že každý používateľ uvidí len svoje dáta. Táto logika je implementovaná na úrovniach komponentov Backend.</p><p>UI (Frontend) pri volaní jednotlivých REST API s touto informáciou priamo nepracuje, ale táto informácie je uchovaná v rámci aplikačného tokenu (JWT), ktorý je vždy posielaný v rámci požiadaviek. Aplikačný backend z tokenu získa túto informáciu, a na základe nej filtruje dáta z databázových tabuliek.</p><p>S týmto tak isto počítajú aj komponenty sync-service a synchronizačné služby vzhľadom na externý zdroj.</p><p> </p><h3>Tenant </h3><p>Systém Pasport pre správne fungovanie potrebuje mať v systéme (v databáze) informácie o jednotlivých tenantoch. Evidujeme pre tenanta nasledovné informácie:</p><ul><li>názov</li><li>id tenanta - ide o id company z FLWW systému</li><li>kód tenanta - atribút "code"</li></ul><p>Tieto informácie sú uložené v databáze, tabuľka <strong>tenant. </strong>Vytvorenie tenanta je možne cez API - viď kapitola nižšie.</p><p><em>Všetky tieto informácie musia byť dodané zo strany RADIUM</em></p><h3>Tenant používateľ</h3><p>Následne pre každého tenanta systém potrebude mať vytvoreného tenant používateľa - jedná sa o tzv. systémového používateľa daného tenanta, ktorého komponent Backend používa najmä v procese synchronizácie dát z FLWW alebo pri niektorých operáciách v rámci autentifikácie.</p><p> </p><p>Pre tenant usera evidujeme nasledovné informácie:</p><ul><li>tenant id - id tenanta pod ktorého používateľ patrí</li><li>username - používateľské meno používateľa</li><li>heslo - heslo používateľa</li><li>user id - id používateľa</li></ul><p>Tieto informácie sú uložené v databáze, tabuľka <strong>tenant_system_user. </strong>Vytvorenie tenanta usera je možne cez API - viď kapitola nižšie.</p><p><em><em></em>Všetky tieto informácie musia byť dodané zo strany RADIUM</em></p><h3>Tenant nastavenia</h3><p>Každý tenant má v rámci systému špecifické nastavenia ktoré sa vytváraju/editujú cez API popísané nižšie.</p><p><em><em></em>Tieto nastavenia treba konzultovať s RADIUM</em></p><h1>Vytvorenie tenanta, tenant usera a konfigurácia nastavení pre tenanta</h1><p>Pasport vie pracovať v multitenant/multicompany režime, čo znamená že z pohľadu FLWW vie mať uložené dáta pre rôzne company.</p><p><strong>Bez ohľadu nato či je systém nasadzovaný pre jedného zákazníka alebo v multi-tenant režime, vždy je nutné vykonať nižšie uvedené kroky!</strong></p><p> </p><p>Tento krok pozostáva z troch krokov ktoré musia ísť presne za sebou (tieto API sa primárne používaju pri postinstall konifgurácii <a href="#" data-page-title="Postup postinštalačnej konfigurácie"></a>):</p><h3><strong>1.) Vytvorenie tenanta</strong></h3><table><tbody><tr><th>Metóda</th><th colspan="1">Autentifikácia</th><th>Endpoint</th><th>Query params</th><th colspan="1">Body</th><th>Response</th><th colspan="1">Poznámka</th></tr><tr><td>POST</td><td colspan="1"><p>basic auth</p></td><td>{{url-BE}}/api/tenant</td><td><p> </p><p> </p></td><td colspan="1"><div class="content-wrapper">js</div></td><td>true</td><td colspan="1">API je mozne pouzit aj pri update informacii o tenantovi</td></tr></tbody></table><h3><strong>2.) Vytvorenie systémového používateľa pre tenanta (tento user sa pre daného tenante bude pripájať na FLWW API)</strong></h3><table><tbody><tr><th>Metóda</th><th colspan="1">Autentifikácia</th><th>Endpoint</th><th>Query params</th><th colspan="1">Body</th><th>Response</th><th colspan="1">Poznámka</th></tr><tr><td>POST</td><td colspan="1"><p>basic auth</p></td><td>{{url-BE}}/api/tenantSystemUser</td><td><p> </p><p> </p></td><td colspan="1"><div class="content-wrapper">js</div></td><td>true</td><td colspan="1">API je mozne pouzit aj pri update informacii o userovi</td></tr></tbody></table><h3><strong>3.) Vytvorenie aplikačných nastavení pre tenanta</strong></h3><p>Detailný postup je objasnený v sekcii <a href="#" data-page-title="Aplikačné nastavenia pre tenanta"></a></p>
</div>
</body>
</html>
